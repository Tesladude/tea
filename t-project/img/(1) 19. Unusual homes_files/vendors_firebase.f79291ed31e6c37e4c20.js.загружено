/*! For license information please see vendors~firebase.f79291ed31e6c37e4c20.js.LICENSE.txt */
(window.webpackJsonpVimbox=window.webpackJsonpVimbox||[]).push([["vendors~firebase"],{1897:function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(1898),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(64))},1898:function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,r,o,a,s,u=1,h={},c=!1,l=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick((function(){d(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},i=function(t){o.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(r=l.documentElement,i=function(t){var e=l.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):i=function(t){setTimeout(d,0,t)}:(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&d(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),i=function(e){t.postMessage(a+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return h[u]=r,i(u),u++},p.clearImmediate=f}function f(t){delete h[t]}function d(t){if(c)setTimeout(d,0,t);else{var e=h[t];if(e){c=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{f(t),c=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(64),n(371))},1899:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(1),o=n(1904),a=((i={})["no-app"]="No Firebase App '{$name}' has been created - call Firebase App.initializeApp()",i["bad-app-name"]="Illegal App name: '{$name}",i["duplicate-app"]="Firebase App named '{$name}' already exists",i["app-deleted"]="Firebase App named '{$name}' already deleted",i["duplicate-service"]="Firebase service named '{$name}' already registered",i["invalid-app-argument"]="firebase.{$name}() takes either no argument or a Firebase App instance.",i),s=new o.ErrorFactory("app","Firebase",a);function u(t,e){throw s.create(t,e)}var h=[],c=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){h.push(t),setTimeout((function(){return t(null)}),0)},removeAuthTokenListener:function(t){h=h.filter((function(e){return e!==t}))}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){t.firebase_.INTERNAL.removeApp(t.name_);for(var e=[],n=0,i=Object.keys(t.services_);n<i.length;n++)for(var r=i[n],o=0,a=Object.keys(t.services_[r]);o<a.length;o++){var s=a[o];e.push(t.services_[r][s])}return Promise.all(e.map((function(t){return t.INTERNAL.delete()})))})).then((function(){t.isDeleted_=!0,t.services_={}}))},t.prototype._getService=function(t,e){if(void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n="[DEFAULT]"!==e?e:void 0,i=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=i}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;o.deepExtend(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(h.forEach((function(t){e.INTERNAL.addAuthTokenListener(t)})),h=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&u("app-deleted",{name:this.name_})},t}();function l(t,e){return Object.prototype.hasOwnProperty.call(t,e)}c.prototype.name&&c.prototype.options||c.prototype.delete||console.log("dc");var p=!1;try{p="[object process]"===Object.prototype.toString.call(t.process)}catch(t){}if(p&&console.warn('\nWarning: This is a browser-targeted Firebase bundle but it appears it is being\nrun in a Node environment.  If running in a Node environment, make sure you\nare using the bundle specified by the "main" field in package.json.\n\nIf you are using Webpack, you can specify "main" as the first item in\n"resolve.mainFields":\nhttps://webpack.js.org/configuration/resolve/#resolvemainfields\n\nIf using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\nto false and "main" to true:\nhttps://github.com/rollup/rollup-plugin-node-resolve\n'),self&&"firebase"in self){console.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var f=self.firebase.SDK_VERSION;f&&f.indexOf("LITE")>=0&&console.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var d=function t(){var e=function(t){var e={},n={},i={},r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var o=i;void 0===o.name&&(o.name="[DEFAULT]");var a=o.name;"string"==typeof a&&a||u("bad-app-name",{name:String(a)});l(e,a)&&u("duplicate-app",{name:a});var s=new t(n,o,r);return e[a]=s,h(s,"create"),s},app:a,apps:null,Promise:Promise,SDK_VERSION:"5.11.0",INTERNAL:{registerService:function(e,h,c,l,p){void 0===p&&(p=!1);n[e]&&u("duplicate-service",{name:e});n[e]=h,l&&(i[e]=l,s().forEach((function(t){l("create",t)})));function f(t){return void 0===t&&(t=a()),"function"!=typeof t[e]&&u("invalid-app-argument",{name:e}),t[e]()}void 0!==c&&o.deepExtend(f,c);return r[e]=f,t.prototype[e]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=this._getService.bind(this,e);return i.apply(this,p?t:[])},f},removeApp:function(t){h(e[t],"delete"),delete e[t]},factories:n,useAsService:c}};function a(t){return l(e,t=t||"[DEFAULT]")||u("no-app",{name:t}),e[t]}function s(){return Object.keys(e).map((function(t){return e[t]}))}function h(t,e){for(var r=0,o=Object.keys(n);r<o.length;r++){var a=c(t,o[r]);if(null===a)return;i[a]&&i[a](e,t)}}function c(t,e){if("serverAuth"===e)return null;var n=e;t.options;return n}return o.patchProperty(r,"default",r),Object.defineProperty(r,"apps",{get:s}),o.patchProperty(a,"App",t),r}(c);return e.INTERNAL=r.__assign({},e.INTERNAL,{createFirebaseNamespace:t,extendNamespace:function(t){o.deepExtend(e,t)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),e}();e.default=d,e.firebase=d}).call(this,n(64))},1904:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[],r=0;r<t.length;r+=3){var o=t[r],a=r+1<t.length,s=a?t[r+1]:0,u=r+2<t.length,h=u?t[r+2]:0,c=o>>2,l=(3&o)<<4|s>>4,p=(15&s)<<2|h>>6,f=63&h;u||(f=64,a||(p=64)),i.push(n[c],n[l],n[p],n[f])}return i.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,i=0;n<t.length;){var r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){var o=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&o)}else if(r>239&&r<365){var a=((7&r)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(a>>10)),e[i++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[],r=0;r<t.length;){var o=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0,s=++r<t.length?n[t.charAt(r)]:64,u=++r<t.length?n[t.charAt(r)]:64;if(++r,null==o||null==a||null==s||null==u)throw Error();var h=o<<2|a>>4;if(i.push(h),64!=s){var c=a<<4&240|s>>2;if(i.push(c),64!=u){var l=s<<6&192|u;i.push(l)}}}return i},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},h=function(t){try{return u.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=c(t[n],e[n]));return t}var l=function(){function t(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,i){n?e.reject(n):e.resolve(i),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,i))}},t}(),p=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},f=function(t){function e(n,i){var r=t.call(this,i)||this;return r.code=n,r.name="FirebaseError",Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,d.prototype.create),r}return i.__extends(e,t),e}(Error),d=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t,e){void 0===e&&(e={});for(var n=this.service+"/"+t,i=this.errors[t],r=i?function(t,e){return t.replace(v,(function(t,n){var i=e[n];return null!=i?i.toString():"<"+n+"?>"}))}(i,e):"Error",o=this.serviceName+": "+r+" ("+n+").",a=new f(n,o),s=0,u=Object.keys(e);s<u.length;s++){var h=u[s];"_"!==h.slice(-1)&&(h in a&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),a[h]=e[h])}return a},t}();var v=/\{\$([^}]+)}/g;function y(t){return JSON.parse(t)}var g=function(t){var e={},n={},i={},r="";try{var o=t.split(".");e=y(h(o[0])||""),n=y(h(o[1])||""),r=o[2],i=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:i,signature:r}},m=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},_=function(t,e){return m(e,(function(e,n){t[e]=n})),t},b=function(t,e,n){for(var i in t)if(e.call(n,t[i],i,t))return i},w=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var i=0;i<16;i++)n[i]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(i=0;i<16;i++)n[i]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(i=16;i<80;i++){var r=n[i-3]^n[i-8]^n[i-14]^n[i-16];n[i]=4294967295&(r<<1|r>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],h=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(i=0;i<80;i++){i<40?i<20?(o=c^u&(h^c),a=1518500249):(o=u^h^c,a=1859775393):i<60?(o=u&h|c&(u|h),a=2400959708):(o=u^h^c,a=3395469782);r=(s<<5|s>>>27)+o+l+a+n[i]&4294967295;l=c,c=h,h=4294967295&(u<<30|u>>>2),u=s,s=r}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=0,r=this.buf_,o=this.inbuf_;i<e;){if(0==o)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(r[o]=t.charCodeAt(i),++i,++o==this.blockSize){this.compress_(r),o=0;break}}else for(;i<e;)if(r[o]=t[i],++i,++o==this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var i=0;for(n=0;n<5;n++)for(var r=24;r>=0;r-=8)t[i]=this.chain_[n]>>r&255,++i;return t},t}();var E=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var i,r=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,i=e;n<i.length;n++){var r=i[n];if(r in t&&"function"==typeof t[r])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(i.next=C),void 0===i.error&&(i.error=C),void 0===i.complete&&(i.complete=C);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(t){}})),this.observers.push(i),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function C(){}function T(t,e,n){var i="";switch(e){case 1:i=n?"first":"First";break;case 2:i=n?"second":"Second";break;case 3:i=n?"third":"Third";break;case 4:i=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var r=t+" failed: ";return r+=i+" argument "}e.CONSTANTS=r,e.Deferred=l,e.ErrorFactory=d,e.FirebaseError=f,e.Sha1=w,e.assert=o,e.assertionError=a,e.async=function(t,e){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}},e.base64=u,e.base64Decode=h,e.base64Encode=function(t){var e=s(t);return u.encodeByteArray(e,!0)},e.clone=function(t){return _({},t)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new E(t,e);return n.subscribe.bind(n)},e.decode=g,e.deepCopy=function(t){return c(void 0,t)},e.deepExtend=c,e.errorPrefix=T,e.every=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0},e.extend=_,e.findKey=b,e.findValue=function(t,e,n){var i=b(t,e,n);return i&&t[i]},e.forEach=m,e.getAnyKey=function(t){for(var e in t)return e},e.getCount=function(t){var e=0;for(var n in t)e++;return e},e.getUA=p,e.getValues=function(t){var e=[],n=0;for(var i in t)e[n++]=t[i];return e},e.isAdmin=function(t){var e=g(t).claims;return"object"==typeof e&&!0===e.admin},e.isEmpty=function(t){for(var e in t)return!1;return!0},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())},e.isNodeSdk=function(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN},e.isNonNullObject=function(t){return"object"==typeof t&&null!==t},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isValidFormat=function(t){var e=g(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e,n,i=g(t).claims,r=Math.floor((new Date).getTime()/1e3);return"object"==typeof i&&(i.hasOwnProperty("nbf")?e=i.nbf:i.hasOwnProperty("iat")&&(e=i.iat),n=i.hasOwnProperty("exp")?i.exp:e+86400),r&&e&&n&&r>=e&&r<=n},e.issuedAtTime=function(t){var e=g(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=y,e.map=function(t,e,n){var i={};for(var r in t)i[r]=e.call(n,t[r],r,t);return i},e.patchProperty=function(t,e,n){t[e]=n},e.querystring=function(t){var e=[];return m(t,(function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})),e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e},e.safeGet=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var r=t.charCodeAt(i);if(r>=55296&&r<=56319){var a=r-55296;i++,o(i<t.length,"Surrogate pair missing trail surrogate."),r=65536+(a<<10)+(t.charCodeAt(i)-56320)}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,i){var r;if(i<e?r="at least "+e:i>n&&(r=0===n?"none":"no more than "+n),r)throw new Error(t+" failed: Was called with "+i+(1===i?" argument.":" arguments.")+" Expects "+r+".")},e.validateCallback=function(t,e,n,i){if((!i||n)&&"function"!=typeof n)throw new Error(T(t,e,i)+"must be a valid function.")},e.validateContextObject=function(t,e,n,i){if((!i||n)&&("object"!=typeof n||null===n))throw new Error(T(t,e,i)+"must be a valid context object.")},e.validateNamespace=function(t,e,n,i){if((!i||n)&&"string"!=typeof n)throw new Error(T(t,e,i)+"must be a valid firebase namespace.")}},1916:function(t,e,n){"use strict";n.r(e);n(374),n(1917),n(1918),n(1920),n(1922),n(1924),n(1926),n(1928),n(1934)},1917:function(t,e,n){"use strict";(function(t,e){function n(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))}var i=setTimeout;function r(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function a(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void u(e.promise,t)}s(e.promise,i)}else(1===t._state?s:u)(e.promise,t._value)}))):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void h(t);if("function"==typeof n)return void l((i=n,r=e,function(){i.apply(r,arguments)}),t)}t._state=1,t._value=e,h(t)}catch(e){u(t,e)}var i,r}function u(t,e){t._state=2,t._value=e,h(t)}function h(t){2===t._state&&0===t._deferreds.length&&o._immediateFn((function(){t._handled||o._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function c(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t((function(t){n||(n=!0,s(e,t))}),(function(t){n||(n=!0,u(e,t))}))}catch(t){if(n)return;n=!0,u(e,t)}}o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return a(this,new c(t,e,n)),n},o.prototype.finally=n,o.all=function(t){return new o((function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var r=i.length;function o(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(e){o(t,e)}),n)}i[t]=a,0==--r&&e(i)}catch(t){n(t)}}for(var a=0;a<i.length;a++)o(a,i[a])}))},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o((function(e){e(t)}))},o.reject=function(t){return new o((function(e,n){n(t)}))},o.race=function(t){return new o((function(e,n){for(var i=0,r=t.length;i<r;i++)t[i].then(e,n)}))},o._immediateFn="function"==typeof t&&function(e){t(e)}||function(t){i(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var p=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();"Promise"in p?p.Promise.prototype.finally||(p.Promise.prototype.finally=n):p.Promise=o}).call(this,n(1897).setImmediate,n(64))},1918:function(t,e,n){var i=n(1919);t.exports=i},1919:function(t,e,n){n(595);var i=n(589);t.exports=i("Array","find")},1920:function(t,e,n){var i=n(1921);t.exports=i},1921:function(t,e,n){n(596);var i=n(589);t.exports=i("Array","findIndex")},1922:function(t,e,n){var i=n(1923);t.exports=i},1923:function(t,e,n){n(592);var i=n(62);t.exports=i.Object.assign},1924:function(t,e,n){var i=n(1925);t.exports=i},1925:function(t,e,n){n(594);var i=n(589);t.exports=i("String","startsWith")},1926:function(t,e,n){var i=n(1927);t.exports=i},1927:function(t,e,n){n(593);var i=n(589);t.exports=i("String","repeat")},1928:function(t,e,n){var i=n(372);n(1929),n(1930),n(1931),n(1932),n(1933),t.exports=i},1929:function(t,e,n){n(72)("asyncDispose")},1930:function(t,e,n){n(72)("dispose")},1931:function(t,e,n){n(72)("observable")},1932:function(t,e,n){n(72)("patternMatch")},1933:function(t,e,n){n(72)("replaceAll")},1934:function(t,e,n){var i=n(1935);t.exports=i},1935:function(t,e,n){n(591),n(233),n(305);var i=n(373);t.exports=i.f("iterator")},1936:function(t,e,n){"use strict";(function(t){var e=n(1899),i=n.n(e);(function(){var t,e=e||{},n=this;function r(t){return"string"==typeof t}function o(t){return"boolean"==typeof t}var a=/^[\w+/_-]+[=]{0,2}$/,s=null;function u(){}function h(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function c(t){return null===t}function l(t){return"array"==h(t)}function p(t){var e=h(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){return"function"==h(t)}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),y=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:m).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var w=Date.now||function(){return+new Date};function E(t,e){function n(){}n.prototype=e.prototype,t.pb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.gd=function(t,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return e.prototype[n].apply(t,r)}}function C(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function T(t){if(Error.captureStackTrace)Error.captureStackTrace(this,T);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function I(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");T.call(this,n+t[i])}function S(t,e){throw new I("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function N(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function A(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function k(){this.b=this.a=null}E(T,Error),T.prototype.name="CustomError",E(I,T),I.prototype.name="AssertionError",N.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var P=new N((function(){return new O}),(function(t){t.reset()}));function R(){var t=dt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function O(){this.next=this.b=this.a=null}k.prototype.add=function(t,e){var n=P.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},O.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},O.prototype.reset=function(){this.next=this.b=this.a=null};var D=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(r(t))return r(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},x=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,o=r(t)?t.split(""):t,a=0;a<i;a++)a in o&&e.call(n,o[a],a,t)};var L=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),o=r(t)?t.split(""):t,a=0;a<n;a++)a in o&&(i[a]=e.call(void 0,o[a],a,t));return i},F=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=r(t)?t.split(""):t,o=0;o<n;o++)if(o in i&&e.call(void 0,i[o],o,t))return!0;return!1};function M(t,e){return 0<=D(t,e)}function U(t,e){var n;return(n=0<=(e=D(t,e)))&&Array.prototype.splice.call(t,e,1),n}function j(t,e){!function(t,e){for(var n=r(t)?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)}(t,(function(n,i){e.call(void 0,n,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&0}))}function W(t){return Array.prototype.concat.apply([],arguments)}function V(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}var q,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},B=/&/g,Q=/</g,K=/>/g,G=/"/g,Y=/'/g,z=/\x00/g,X=/[\x00&<>"']/;function J(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:t>e?1:0}t:{var Z=n.navigator;if(Z){var tt=Z.userAgent;if(tt){q=tt;break t}}q=""}function et(t){return J(q,t)}function nt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function it(t){for(var e in t)return!1;return!0}function rt(t){var e,n={};for(e in t)n[e]=t[e];return n}var ot,at,st="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ut(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<st.length;o++)n=st[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ht(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")}function ct(t){return X.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(B,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Q,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(K,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(G,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Y,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(z,"&#0;"))),t}function lt(t){n.setTimeout((function(){throw t}),0)}function pt(t,e){at||function(){if(n.Promise&&n.Promise.resolve){var t=n.Promise.resolve(void 0);at=function(){t.then(vt)}}else at=function(){var t=vt;!f(n.setImmediate)||n.Window&&n.Window.prototype&&!et("Edge")&&n.Window.prototype.setImmediate==n.setImmediate?(ot||(ot=function(){var t=n.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!et("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=_((function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!et("Trident")&&!et("MSIE")){var e=new t,i={},r=i;return e.port1.onmessage=function(){if(void 0!==i.next){var t=(i=i.next).xb;i.xb=null,t()}},function(t){r.next={xb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){n.setTimeout(t,0)}}()),ot(t)):n.setImmediate(t)}}(),ft||(at(),ft=!0),dt.add(t,e)}var ft=!1,dt=new k;function vt(){for(var t;t=R();){try{t.a.call(t.b)}catch(t){lt(t)}A(P,t)}ft=!1}function yt(t,e){if(this.a=gt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=u)try{var n=this;t.call(e,(function(t){kt(n,mt,t)}),(function(t){if(!(t instanceof Ft))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}kt(n,_t,t)}))}catch(t){kt(this,_t,t)}}var gt=0,mt=2,_t=3;function bt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}bt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var wt=new N((function(){return new bt}),(function(t){t.reset()}));function Et(t,e,n){var i=wt.get();return i.g=t,i.b=e,i.f=n,i}function Ct(t){if(t instanceof yt)return t;var e=new yt(u);return kt(e,mt,t),e}function Tt(t){return new yt((function(e,n){n(t)}))}function It(t,e,n){Pt(t,e,n,null)||pt(b(e,t))}function St(t){return new yt((function(e){var n=t.length,i=[];if(n)for(var r=function(t,r,o){n--,i[t]=r?{Eb:!0,value:o}:{Eb:!1,reason:o},0==n&&e(i)},o=0;o<t.length;o++)It(t[o],b(r,o,!0),b(r,o,!1));else e(i)}))}function Nt(t,e){t.b||t.a!=mt&&t.a!=_t||Rt(t),t.f?t.f.next=e:t.b=e,t.f=e}function At(t,e,n,i){var r=Et(null,null,null);return r.a=new yt((function(t,o){r.g=e?function(n){try{var r=e.call(i,n);t(r)}catch(t){o(t)}}:t,r.b=n?function(e){try{var r=n.call(i,e);void 0===r&&e instanceof Ft?o(e):t(r)}catch(t){o(t)}}:o})),r.a.c=t,Nt(t,r),r.a}function kt(t,e,n){t.a==gt&&(t===n&&(e=_t,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Pt(n,t.Pc,t.Qc,t)||(t.i=n,t.a=e,t.c=null,Rt(t),e!=_t||n instanceof Ft||function(t,e){t.g=!0,pt((function(){t.g&&Lt.call(null,e)}))}(t,n)))}function Pt(t,e,n,i){if(t instanceof yt)return Nt(t,Et(e||u,n||null,i)),!0;if(C(t))return t.then(e,n,i),!0;if(d(t))try{var r=t.then;if(f(r))return function(t,e,n,i,r){function o(t){a||(a=!0,i.call(r,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(r,t))}),o)}catch(t){o(t)}}(t,r,e,n,i),!0}catch(t){return n.call(i,t),!0}return!1}function Rt(t){t.h||(t.h=!0,pt(t.Yb,t))}function Ot(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Dt(t,e,n,i){if(n==_t&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,xt(e,n,i);else try{e.c?e.g.call(e.f):xt(e,n,i)}catch(t){Lt.call(null,t)}A(wt,e)}function xt(t,e,n){e==mt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}yt.prototype.then=function(t,e,n){return At(this,f(t)?t:null,f(e)?e:null,n)},yt.prototype.$goog_Thenable=!0,(t=yt.prototype).ia=function(t,e){return(t=Et(t,t,e)).c=!0,Nt(this,t),this},t.s=function(t,e){return At(this,null,t,e)},t.cancel=function(t){this.a==gt&&pt((function(){!function t(e,n){if(e.a==gt)if(e.c){var i=e.c;if(i.b){for(var r=0,o=null,a=null,s=i.b;s&&(s.c||(r++,s.a==e&&(o=s),!(o&&1<r)));s=s.next)o||(a=s);o&&(i.a==gt&&1==r?t(i,n):(a?((r=a).next==i.f&&(i.f=r),r.next=r.next.next):Ot(i),Dt(i,o,_t,n)))}e.c=null}else kt(e,_t,n)}(this,new Ft(t))}),this)},t.Pc=function(t){this.a=gt,kt(this,mt,t)},t.Qc=function(t){this.a=gt,kt(this,_t,t)},t.Yb=function(){for(var t;t=Ot(this);)Dt(this,t,this.a,this.i);this.h=!1};var Lt=lt;function Ft(t){T.call(this,t)}function Mt(){0!=Ut&&(jt[this[v]||(this[v]=++y)]=this),this.qa=this.qa,this.ja=this.ja}E(Ft,T),Ft.prototype.name="cancel";var Ut=0,jt={};function Wt(t){if(!t.qa&&(t.qa=!0,t.va(),0!=Ut)){var e=t[v]||(t[v]=++y);if(0!=Ut&&t.ja&&0<t.ja.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete jt[e]}}function Vt(t){return Vt[" "](t),t}Mt.prototype.qa=!1,Mt.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},Vt[" "]=u;var qt,Ht,Bt=et("Opera"),Qt=et("Trident")||et("MSIE"),Kt=et("Edge"),Gt=Kt||Qt,Yt=et("Gecko")&&!(J(q.toLowerCase(),"webkit")&&!et("Edge"))&&!(et("Trident")||et("MSIE"))&&!et("Edge"),zt=J(q.toLowerCase(),"webkit")&&!et("Edge");function Xt(){var t=n.document;return t?t.documentMode:void 0}t:{var Jt="",$t=(Ht=q,Yt?/rv:([^\);]+)(\)|;)/.exec(Ht):Kt?/Edge\/([\d\.]+)/.exec(Ht):Qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ht):zt?/WebKit\/(\S+)/.exec(Ht):Bt?/(?:Version)[ \/]?(\S+)/.exec(Ht):void 0);if($t&&(Jt=$t?$t[1]:""),Qt){var Zt=Xt();if(null!=Zt&&Zt>parseFloat(Jt)){qt=String(Zt);break t}}qt=Jt}var te,ee={};function ne(t){return function(t,e){var n=ee;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=H(String(qt)).split("."),i=H(String(t)).split("."),r=Math.max(n.length,i.length),o=0;0==e&&o<r;o++){var a=n[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=$(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==a[2].length,0==s[2].length)||$(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}var ie=n.document;te=ie&&Qt?Xt()||("CSS1Compat"==ie.compatMode?parseInt(qt,10):5):void 0;var re=Object.freeze||function(t){return t},oe=!Qt||9<=Number(te),ae=Qt&&!ne("9"),se=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{n.addEventListener("test",u,e),n.removeEventListener("test",u,e)}catch(t){}return t}();function ue(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function he(t,e){if(ue.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Yt){t:{try{Vt(e.nodeName);var o=!0;break t}catch(t){}o=!1}o||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=r(t.pointerType)?t.pointerType:ce[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}ue.prototype.preventDefault=function(){this.Kb=!1},E(he,ue);var ce=re({2:"touch",3:"pen",4:"mouse"});he.prototype.preventDefault=function(){he.pb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ae)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},he.prototype.f=function(){return this.a};var le="closure_listenable_"+(1e6*Math.random()|0),pe=0;function fe(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.Ma=r,this.key=++pe,this.oa=this.Ia=!1}function de(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.Ma=null}function ve(t){this.src=t,this.a={},this.b=0}function ye(t,e){var n=e.type;n in t.a&&U(t.a[n],e)&&(de(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function ge(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.Ma==i)return r}return-1}ve.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ge(t,e,i,r);return-1<a?(e=t[a],n||(e.Ia=!1)):((e=new fe(e,this.src,o,!!i,r)).Ia=n,t.push(e)),e};var me="closure_lm_"+(1e6*Math.random()|0),_e={};function be(t,e,n,i,r){if(i&&i.once)Ee(t,e,n,i,r);else if(l(e))for(var o=0;o<e.length;o++)be(t,e[o],n,i,r);else n=Re(n),t&&t[le]?De(t,e,n,d(i)?!!i.capture:!!i,r):we(t,e,n,!1,i,r)}function we(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a=d(r)?!!r.capture:!!r,s=ke(t);if(s||(t[me]=s=new ve(t)),!(n=s.add(e,n,i,a,o)).proxy){if(i=function(){var t=Ae,e=oe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)se||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ie(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}0}}function Ee(t,e,n,i,r){if(l(e))for(var o=0;o<e.length;o++)Ee(t,e[o],n,i,r);else n=Re(n),t&&t[le]?xe(t,e,n,d(i)?!!i.capture:!!i,r):we(t,e,n,!0,i,r)}function Ce(t,e,n,i,r){if(l(e))for(var o=0;o<e.length;o++)Ce(t,e[o],n,i,r);else i=d(i)?!!i.capture:!!i,n=Re(n),t&&t[le]?(t=t.o,(e=String(e).toString())in t.a&&(-1<(n=ge(o=t.a[e],n,i,r))&&(de(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=ke(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ge(e,n,i,r)),(n=-1<t?e[t]:null)&&Te(n))}function Te(t){if("number"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[le])ye(e.o,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ie(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=ke(e))?(ye(n,t),0==n.b&&(n.src=null,e[me]=null)):de(t)}}}function Ie(t){return t in _e?_e[t]:_e[t]="on"+t}function Se(t,e,n,i){var r=!0;if((t=ke(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=Ne(o,i),r=r&&!1!==o)}return r}function Ne(t,e){var n=t.listener,i=t.Ma||t.src;return t.Ia&&Te(t),n.call(i,e)}function Ae(t,e){if(t.oa)return!0;if(!oe){if(!e)t:{e=["window","event"];for(var i=n,r=0;r<e.length;r++)if(null==(i=i[e[r]])){e=null;break t}e=i}if(e=new he(r=e,this),i=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){o=!0}(o||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],o=e.b;o;o=o.parentNode)r.push(o);for(t=t.type,o=r.length-1;0<=o;o--){e.b=r[o];var a=Se(r[o],t,!0,e);i=i&&a}for(o=0;o<r.length;o++)e.b=r[o],a=Se(r[o],t,!1,e),i=i&&a}return i}return Ne(t,new he(e,this))}function ke(t){return(t=t[me])instanceof ve?t:null}var Pe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Re(t){return f(t)?t:(t[Pe]||(t[Pe]=function(e){return t.handleEvent(e)}),t[Pe])}function Oe(){Mt.call(this),this.o=new ve(this),this.Rb=this,this.Wa=null}function De(t,e,n,i,r){t.o.add(String(e),n,!1,i,r)}function xe(t,e,n,i,r){t.o.add(String(e),n,!0,i,r)}function Le(t,e,n,i){if(!(e=t.o.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.oa&&a.capture==n){var s=a.listener,u=a.Ma||a.src;a.Ia&&ye(t.o,a),r=!1!==s.call(u,i)&&r}}return r&&0!=i.Kb}function Fe(t,e,i){if(f(t))i&&(t=_(t,i));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:n.setTimeout(t,e||0)}function Me(t){var e=null;return new yt((function(n,i){-1==(e=Fe((function(){n(void 0)}),t))&&i(Error("Failed to schedule timer."))})).s((function(t){throw n.clearTimeout(e),t}))}function Ue(t){if(t.S&&"function"==typeof t.S)return t.S();if(r(t))return t.split("");if(p(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function je(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(p(t)||r(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof We)for(n=t.U(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Ve(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];qe(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)qe(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}E(Oe,Mt),Oe.prototype[le]=!0,Oe.prototype.addEventListener=function(t,e,n,i){be(this,t,e,n,i)},Oe.prototype.removeEventListener=function(t,e,n,i){Ce(this,t,e,n,i)},Oe.prototype.dispatchEvent=function(t){var e,n=this.Wa;if(n)for(e=[];n;n=n.Wa)e.push(n);n=this.Rb;var i=t.type||t;if(r(t))t=new ue(t,n);else if(t instanceof ue)t.target=t.target||n;else{var o=t;ut(t=new ue(i,n),o)}if(o=!0,e)for(var a=e.length-1;0<=a;a--){var s=t.b=e[a];o=Le(s,i,!0,t)&&o}if(o=Le(s=t.b=n,i,!0,t)&&o,o=Le(s,i,!1,t)&&o,e)for(a=0;a<e.length;a++)o=Le(s=t.b=e[a],i,!1,t)&&o;return o},Oe.prototype.va=function(){if(Oe.pb.va.call(this),this.o){var t,e=this.o;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)de(n[i]);delete e.a[t],e.b--}}this.Wa=null},(t=We.prototype).S=function(){Ve(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.U=function(){return Ve(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return qe(this.b,t)?this.b[t]:e},t.set=function(t,e){qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.U(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Be(t,e){if(this.b=this.o=this.c="",this.i=null,this.h=this.g="",this.f=!1,t instanceof Be){this.f=void 0!==e?e:t.f,Qe(this,t.c),this.o=t.o,this.b=t.b,Ke(this,t.i),this.g=t.g,e=t.a;var n=new sn;n.c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),Ge(this,n),this.h=t.h}else t&&(n=String(t).match(He))?(this.f=!!e,Qe(this,n[1]||"",!0),this.o=$e(n[2]||""),this.b=$e(n[3]||"",!0),Ke(this,n[4]),this.g=$e(n[5]||"",!0),Ge(this,n[6]||"",!0),this.h=$e(n[7]||"")):(this.f=!!e,this.a=new sn(null,this.f))}function Qe(t,e,n){t.c=n?$e(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Ke(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Ge(t,e,n){e instanceof sn?(t.a=e,function(t,e){e&&!t.f&&(un(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),pn(this,n,t))}),t)),t.f=e}(t.a,t.f)):(n||(e=Ze(e,on)),t.a=new sn(e,t.f))}function Ye(t,e,n){t.a.set(e,n)}function ze(t,e){return t.a.get(e)}function Xe(t){return t instanceof Be?new Be(t):new Be(t,void 0)}function Je(t,e){var n=new Be(null,void 0);return Qe(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ze(t,e,n){return r(t)?(t=encodeURI(t).replace(e,tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Be.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Ze(e,en,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(Ze(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ze(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Ze(n,an)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,an=/#/g;function sn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function un(t){t.a||(t.a=new We,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function hn(t){var e=je(t);if(void 0===e)throw Error("Keys are undefined");var n=new sn(null,void 0);t=Ue(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];l(o)?pn(n,r,o):n.add(r,o)}return n}function cn(t,e){un(t),e=fn(t,e),qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ve(t)))}function ln(t,e){return un(t),e=fn(t,e),qe(t.a.b,e)}function pn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),V(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=sn.prototype).add=function(t,e){un(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){un(this),this.a.forEach((function(n,i){x(n,(function(n){t.call(e,n,i,this)}),this)}),this)},t.U=function(){un(this);for(var t=this.a.S(),e=this.a.U(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.S=function(t){un(this);var e=[];if(r(t))ln(this,t)&&(e=W(e,this.a.get(fn(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},t.set=function(t,e){return un(this),this.c=null,ln(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.S(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.S(i);for(var o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(String(i[o]))),t.push(a)}}return this.c=t.join("&")};var dn=!Qt||9<=Number(te);function vn(t,e){this.a=t===mn&&e||"",this.b=gn}function yn(t){return t instanceof vn&&t.constructor===vn&&t.b===gn?t.a:(S("expected object of type Const, got '"+t+"'"),"type_error:Const")}vn.prototype.na=!0,vn.prototype.ma=function(){return this.a},vn.prototype.toString=function(){return"Const{"+this.a+"}"};var gn={},mn={};function _n(){this.a="",this.b=Tn}function bn(t){return t instanceof _n&&t.constructor===_n&&t.b===Tn?t.a:(S("expected object of type TrustedResourceUrl, got '"+t+"' of type "+h(t)),"type_error:TrustedResourceUrl")}function wn(t,e){var n=yn(t);if(!Cn.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=new _n;return e.a=t,e}(t=n.replace(En,(function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error('Found marker, "'+i+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[i])instanceof vn?yn(t):encodeURIComponent(String(t))})))}_n.prototype.na=!0,_n.prototype.ma=function(){return this.a.toString()},_n.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var En=/%{(\w+)}/g,Cn=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Tn={};function In(){this.a="",this.b=kn}function Sn(t){return t instanceof In&&t.constructor===In&&t.b===kn?t.a:(S("expected object of type SafeUrl, got '"+t+"' of type "+h(t)),"type_error:SafeUrl")}In.prototype.na=!0,In.prototype.ma=function(){return this.a.toString()},In.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Nn=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function An(t){return t instanceof In?t:(t="object"==typeof t&&t.na?t.ma():String(t),Nn.test(t)||(t="about:invalid#zClosurez"),Pn(t))}var kn={};function Pn(t){var e=new In;return e.a=t,e}function Rn(){this.a="",this.b=On}Pn("about:blank"),Rn.prototype.na=!0,Rn.prototype.ma=function(){return this.a.toString()},Rn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var On={};function Dn(t){var e=new Rn;return e.a=t,e}function xn(t){var e=document;return r(t)?e.getElementById(t):t}function Ln(t,e){nt(e,(function(e,n){e&&"object"==typeof e&&e.na&&(e=e.ma()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Fn.hasOwnProperty(n)?t.setAttribute(Fn[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}Dn("<!DOCTYPE html>"),Dn(""),Dn("<br>");var Fn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Mn(t,e,n){function i(n){n&&e.appendChild(r(n)?t.createTextNode(n):n)}for(var o=2;o<n.length;o++){var a=n[o];!p(a)||d(a)&&0<a.nodeType?i(a):x(Un(a)?V(a):a,i)}}function Un(t){if(t&&"number"==typeof t.length){if(d(t))return"function"==typeof t.item||"string"==typeof t.item;if(f(t))return"function"==typeof t.item}return!1}function jn(t){var e=[];return function t(e,n,i){if(null==n)i.push("null");else{if("object"==typeof n){if(l(n)){var r=n;n=r.length,i.push("[");for(var o="",a=0;a<n;a++)i.push(o),t(e,r[a],i),o=",";return void i.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(r in i.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,r)&&("function"!=typeof(a=n[r])&&(i.push(o),Hn(r,i),i.push(":"),t(e,a,i),o=","));return void i.push("}")}n=n.valueOf()}switch(typeof n){case"string":Hn(n,i);break;case"number":i.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":i.push(String(n));break;case"function":i.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Wn,t,e),e.join("")}function Wn(){}var Vn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},qn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Hn(t,e){e.push('"',t.replace(qn,(function(t){var e=Vn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Vn[t]=e),e})),'"')}function Bn(){var t=hi();return Qt&&!!te&&11==te||/Edge\/\d+/.test(t)}function Qn(){return n.window&&n.window.location.href||self&&self.location&&self.location.href||""}function Kn(t,e){e=e||n.window;var i="about:blank";t&&(i=Sn(An(t)).toString()),e.location.href=i}function Gn(t){return!!((t=(t||hi()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function Yn(t){t=t||n.window;try{t.close()}catch(t){}}function zn(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=hi().toLowerCase(),i&&(e.target=i,J(n,"crios/")&&(e.target="_blank")),ai(hi())==ri&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof In?n:An(void 0!==n.href?n.href:String(n)),n=t.target||n.target,r=[],t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0))}var a=r.join(",");if((et("iPhone")&&!et("iPod")&&!et("iPad")||et("iPad")||et("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(a=i.document.createElement("A"),e instanceof In||e instanceof In||(e="object"==typeof e&&e.na?e.ma():String(e),Nn.test(e)||(e="about:invalid#zClosurez"),e=Pn(e)),a.href=Sn(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=i.open("",n,a),t=Sn(e).toString(),a&&(Gt&&J(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Dn('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+ct(t)+'">'),a.document.write(function(t){return t instanceof Rn&&t.constructor===Rn&&t.b===On?t.a:(S("expected object of type SafeHtml, got '"+t+"' of type "+h(t)),"type_error:SafeHtml")}(t)),a.document.close())):(a=i.open(Sn(e).toString(),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var Xn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Jn=/^[^@]+@[^@]+$/;function $n(){var t=null;return new yt((function(e){"complete"==n.document.readyState?e():(t=function(){e()},Ee(window,"load",t))})).s((function(e){throw Ce(window,"load",t),e}))}function Zn(t){return t=t||hi(),!("file:"!==di()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function ti(){var t=n.window;try{return!(!t||t==t.top)}catch(t){return!1}}function ei(){return void 0!==n.WorkerGlobalScope&&"function"==typeof n.importScripts}function ni(){return i.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":i.a.INTERNAL.hasOwnProperty("node")?"Node":ei()?"Worker":"Browser"}function ii(){var t=ni();return"ReactNative"===t||"Node"===t}var ri="Firefox",oi="Chrome";function ai(t){var e=t.toLowerCase();return J(e,"opera/")||J(e,"opr/")||J(e,"opios/")?"Opera":J(e,"iemobile")?"IEMobile":J(e,"msie")||J(e,"trident/")?"IE":J(e,"edge/")?"Edge":J(e,"firefox/")?ri:J(e,"silk/")?"Silk":J(e,"blackberry")?"Blackberry":J(e,"webos")?"Webos":!J(e,"safari/")||J(e,"chrome/")||J(e,"crios/")||J(e,"android")?!J(e,"chrome/")&&!J(e,"crios/")||J(e,"edge/")?J(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":oi:"Safari"}var si={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function ui(t,e){e=e||[];var n,i=[],r={};for(n in si)r[si[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=ni())?i=ai(r=hi()):"Worker"===i&&(i=ai(r=hi())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function hi(){return n.navigator&&n.navigator.userAgent||""}function ci(t,e){t=t.split("."),e=e||n;for(var i=0;i<t.length&&"object"==typeof e&&null!=e;i++)e=e[t[i]];return i!=t.length&&(e=void 0),e}function li(){try{var t=n.localStorage,e=_i();if(t)return t.setItem(e,"1"),t.removeItem(e),!Bn()||!!n.indexedDB}catch(t){return ei()&&!!n.indexedDB}return!1}function pi(){return(fi()||"chrome-extension:"===di()||Zn())&&!ii()&&li()&&!ei()}function fi(){return"http:"===di()||"https:"===di()}function di(){return n.location&&n.location.protocol||null}function vi(t){return!Gn(t=t||hi())&&ai(t)!=ri}function yi(t){return void 0===t?null:jn(t)}function gi(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function mi(t){if(null!==t)return JSON.parse(t)}function _i(t){return t||Math.floor(1e9*Math.random()).toString()}function bi(t){return"Safari"!=ai(t=t||hi())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function wi(){var t=n.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var i=0;i<t.CP.length;i++)t.CP[i]=null}function Ei(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=hi(),e=ni(),this.b=Gn(t)||"ReactNative"===e}function Ci(){var t=n.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Ti(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Ii(){return!(!ci("fireauth.oauthhelper",n)&&!ci("fireauth.iframe",n))}Ei.prototype.get=function(){var t=n.navigator;return!t||"boolean"!=typeof t.onLine||!fi()&&"chrome-extension:"!==di()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Si,Ni={};function Ai(t){Ni[t]||(Ni[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var ki={};Object.defineProperty(ki,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(ki,"abcd",{configurable:!0,enumerable:!0,value:2}),Si=2==ki.abcd}catch(Ht){Si=!1}function Pi(t,e,n){Si?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Ri(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Pi(t,n,e[n])}function Oi(t){var e={};return Ri(e,t),e}function Di(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Pi(e,n,Di(t[n]));return e}function xi(t){var e={},n=t[Fi],i=t[Mi];if(!(t=t[Ui])||t!=Li&&!n)throw Error("Invalid provider user info!");e[Wi]=i||null,e[ji]=n||null,Pi(this,qi,t),Pi(this,Vi,Di(e))}var Li="EMAIL_SIGNIN",Fi="email",Mi="newEmail",Ui="requestType",ji="email",Wi="fromEmail",Vi="data",qi="operation";function Hi(t,e){this.code=Qi+t,this.message=e||Ki[t]||""}function Bi(t){var e=t&&t.code;return e?new Hi(e.substring(Qi.length),t.message):null}E(Hi,Error),Hi.prototype.w=function(){return{code:this.code,message:this.message}},Hi.prototype.toJSON=function(){return this.w()};var Qi="auth/",Ki={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Gi(t){var e=t[$i];if(void 0===e)throw new Hi("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Hi("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Yi];if(n&&"object"==typeof n){e=n[er];var i=n[Zi];if(n=n[tr],"string"==typeof e&&e.length){if(this.a=e,void 0!==i&&"boolean"!=typeof i)throw new Hi("argument-error",Zi+" property must be a boolean when specified.");if(this.g=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Hi("argument-error",tr+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Hi("argument-error",er+" property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new Hi("missing-android-pkg-name")}}else if(void 0!==n)throw new Hi("argument-error",Yi+" property must be a non null object when specified.");if(this.f=null,(e=t[Ji])&&"object"==typeof e){if("string"==typeof(e=e[nr])&&e.length)this.f=e;else if(void 0!==e)throw new Hi("argument-error",nr+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Hi("argument-error",Ji+" property must be a non null object when specified.");if(void 0!==(e=t[Xi])&&"boolean"!=typeof e)throw new Hi("argument-error",Xi+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[zi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Hi("argument-error",zi+" property must be a non empty string when specified.");this.i=t||null}var Yi="android",zi="dynamicLinkDomain",Xi="handleCodeInApp",Ji="iOS",$i="url",Zi="installApp",tr="minimumVersion",er="packageName",nr="bundleId";function ir(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var rr=null,or=null;function ar(t){var e="";return function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=or[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!rr){rr={},or={};for(var t=0;65>t;t++)rr[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),or[rr[t]]=t,62<=t&&(or["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var i=0;;){var r=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e+=String.fromCharCode(t)})),e}function sr(t){this.c=t.sub,w(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function ur(t){return(t=hr(t))&&t.sub&&t.iss&&t.aud&&t.exp?new sr(t):null}function hr(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(ar(t))}catch(t){}return null}sr.prototype.f=function(){return this.b};var cr,lr={bd:{bb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",jb:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{bb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",jb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{bb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",jb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function pr(t){for(var e in lr)if(lr[e].id===t)return{firebaseEndpoint:(t=lr[e]).bb,secureTokenEndpoint:t.jb};return null}cr=pr("__EID__")?"__EID__":void 0;var fr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),dr=["client_id","response_type","scope","redirect_uri","state"],vr={Xc:{Na:"locale",Ba:500,Aa:600,Oa:"facebook.com",ib:dr},Zc:{Na:null,Ba:500,Aa:620,Oa:"github.com",ib:dr},$c:{Na:"hl",Ba:515,Aa:680,Oa:"google.com",ib:dr},fd:{Na:"lang",Ba:485,Aa:705,Oa:"twitter.com",ib:fr}};function yr(t){for(var e in vr)if(vr[e].Oa==t)return vr[e];return null}function gr(t){var e={};e["facebook.com"]=Er,e["google.com"]=Tr,e["github.com"]=Cr,e["twitter.com"]=Ir;var n=t&&t[_r];try{if(n)return e[n]?new e[n](t):new wr(t);if(void 0!==t[mr])return new br(t)}catch(t){}return null}var mr="idToken",_r="providerId";function br(t){var e=t[_r];if(!e&&t[mr]){var n=ur(t[mr]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Pi(this,"providerId",e),Pi(this,"isNewUser",n)}function wr(t){br.call(this,t),Pi(this,"profile",Di((t=mi(t.rawUserInfo||"{}"))||{}))}function Er(t){if(wr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Cr(t){if(wr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Pi(this,"username",this.profile&&this.profile.login||null)}function Tr(t){if(wr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ir(t){if(wr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Pi(this,"username",t.screenName||null)}function Sr(t){this.a=Xe(t)}function Nr(t){var e=Xe(t),n=ze(e,"link"),i=ze(Xe(n),"link");return e=ze(e,"deep_link_id"),ze(Xe(e),"link")||e||i||n||t}function Ar(){}function kr(t,e){return t.then((function(t){if(t[ga]){var n=ur(t[ga]);if(!n||e!=n.c)throw new Hi("user-mismatch");return t}throw new Hi("user-mismatch")})).s((function(t){throw t&&t.code&&t.code==Qi+"user-not-found"?new Hi("user-mismatch"):t}))}function Pr(t,e){if(!e)throw new Hi("internal-error","failed to construct a credential");this.a=e,Pi(this,"providerId",t),Pi(this,"signInMethod",t)}function Rr(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Or(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Pr(t.providerId,t.pendingToken)}catch(t){}return null}function Dr(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Pi(this,"idToken",e.idToken),e.accessToken&&Pi(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Pi(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Hi("internal-error","failed to construct a credential");Pi(this,"accessToken",e.oauthToken),Pi(this,"secret",e.oauthTokenSecret)}Pi(this,"providerId",t),Pi(this,"signInMethod",n)}function xr(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:hn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Lr(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new Dr(t.providerId,e,t.signInMethod)}catch(t){}}return null}function Fr(t,e){this.Fc=e||[],Ri(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(yr(t)||{}).Na||null,this.ab=null}function Mr(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Hi("argument-error",'SAML provider IDs must be prefixed with "saml."');Fr.call(this,t,[])}function Ur(t){Fr.call(this,t,dr),this.a=[]}function jr(){Ur.call(this,"facebook.com")}function Wr(t){if(!t)throw new Hi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new jr).credential({accessToken:e})}function Vr(){Ur.call(this,"github.com")}function qr(t){if(!t)throw new Hi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),(new Vr).credential({accessToken:e})}function Hr(){Ur.call(this,"google.com"),this.ua("profile")}function Br(t,e){var n=t;return d(t)&&(n=t.idToken,e=t.accessToken),(new Hr).credential({idToken:n,accessToken:e})}function Qr(){Fr.call(this,"twitter.com",fr)}function Kr(t,e){var n=t;if(d(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Hi("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Dr("twitter.com",n,"twitter.com")}function Gr(t,e,n){this.a=t,this.c=e,Pi(this,"providerId","password"),Pi(this,"signInMethod",n===zr.EMAIL_LINK_SIGN_IN_METHOD?zr.EMAIL_LINK_SIGN_IN_METHOD:zr.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Yr(t){return t&&t.email&&t.password?new Gr(t.email,t.password,t.signInMethod):null}function zr(){Ri(this,{providerId:"password",isOAuthProvider:!1})}function Xr(t,e){if(!(e=Jr(e)))throw new Hi("argument-error","Invalid email link!");return new Gr(t,e,zr.EMAIL_LINK_SIGN_IN_METHOD)}function Jr(t){var e=ze((t=new Sr(t=Nr(t))).a,"oobCode")||null;return"signIn"===(ze(t.a,"mode")||null)&&e?e:null}function $r(t){if(!(t.Ua&&t.Ta||t.Fa&&t.$))throw new Hi("internal-error");this.a=t,Pi(this,"providerId","phone"),Pi(this,"signInMethod","phone")}function Zr(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return x(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new $r(e)}return null}function to(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ua,code:t.a.Ta}}function eo(t){try{this.a=t||i.a.auth()}catch(t){throw new Hi("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ri(this,{providerId:"phone",isOAuthProvider:!1})}function no(t,e){if(!t)throw new Hi("missing-verification-id");if(!e)throw new Hi("missing-verification-code");return new $r({Ua:t,Ta:e})}function io(t){if(t.temporaryProof&&t.phoneNumber)return new $r({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Br(o,n);case"facebook.com":return Wr(n);case"github.com":return qr(n);case"twitter.com":return Kr(n,i);default:return n||i||o||a?a?0==e.indexOf("saml.")?new Pr(e,a):new Dr(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Ur(e).credential({idToken:o,accessToken:n,rawNonce:r}):null}}catch(t){return null}}function ro(t){if(!t.isOAuthProvider)throw new Hi("invalid-oauth-provider")}function oo(t,e,n,i,r,o){if(this.c=t,this.b=e||null,this.g=n||null,this.f=i||null,this.h=o||null,this.a=r||null,!this.g&&!this.a)throw new Hi("invalid-auth-event");if(this.g&&this.a)throw new Hi("invalid-auth-event");if(this.g&&!this.f)throw new Hi("invalid-auth-event")}function ao(t){return(t=t||{}).type?new oo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Bi(t.error),t.postBody):null}function so(){this.b=null,this.a=[]}E(wr,br),E(Er,wr),E(Cr,wr),E(Tr,wr),E(Ir,wr),Pr.prototype.la=function(t){return La(t,Rr(this))},Pr.prototype.b=function(t,e){var n=Rr(this);return n.idToken=e,Fa(t,n)},Pr.prototype.f=function(t,e){return kr(Ma(t,Rr(this)),e)},Pr.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Dr.prototype.la=function(t){return La(t,xr(this))},Dr.prototype.b=function(t,e){var n=xr(this);return n.idToken=e,Fa(t,n)},Dr.prototype.f=function(t,e){return kr(Ma(t,xr(this)),e)},Dr.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Fr.prototype.Da=function(t){return this.zb=rt(t),this},E(Mr,Fr),E(Ur,Fr),Ur.prototype.ua=function(t){return M(this.a,t)||this.a.push(t),this},Ur.prototype.Fb=function(){return V(this.a)},Ur.prototype.credential=function(t,e){var n;if(!(n=d(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new Hi("argument-error","credential failed: must provide the ID token and/or the access token.");return new Dr(this.providerId,n,this.providerId)},E(jr,Ur),Pi(jr,"PROVIDER_ID","facebook.com"),Pi(jr,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),E(Vr,Ur),Pi(Vr,"PROVIDER_ID","github.com"),Pi(Vr,"GITHUB_SIGN_IN_METHOD","github.com"),E(Hr,Ur),Pi(Hr,"PROVIDER_ID","google.com"),Pi(Hr,"GOOGLE_SIGN_IN_METHOD","google.com"),E(Qr,Fr),Pi(Qr,"PROVIDER_ID","twitter.com"),Pi(Qr,"TWITTER_SIGN_IN_METHOD","twitter.com"),Gr.prototype.la=function(t){return this.signInMethod==zr.EMAIL_LINK_SIGN_IN_METHOD?ps(t,Qa,{email:this.a,oobCode:this.c}):ps(t,us,{email:this.a,password:this.c})},Gr.prototype.b=function(t,e){return this.signInMethod==zr.EMAIL_LINK_SIGN_IN_METHOD?ps(t,Ka,{idToken:e,email:this.a,oobCode:this.c}):ps(t,ns,{idToken:e,email:this.a,password:this.c})},Gr.prototype.f=function(t,e){return kr(this.la(t),e)},Gr.prototype.w=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Ri(zr,{PROVIDER_ID:"password"}),Ri(zr,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ri(zr,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),$r.prototype.la=function(t){return t.Va(to(this))},$r.prototype.b=function(t,e){var n=to(this);return n.idToken=e,ps(t,cs,n)},$r.prototype.f=function(t,e){var n=to(this);return n.operation="REAUTH",kr(t=ps(t,ls,n),e)},$r.prototype.w=function(){var t={providerId:"phone"};return this.a.Ua&&(t.verificationId=this.a.Ua),this.a.Ta&&(t.verificationCode=this.a.Ta),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},eo.prototype.Va=function(t,e){var n=this.a.b;return Ct(e.verify()).then((function(i){if(!r(i))throw new Hi("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return ps(t,ts,e)}(n,{phoneNumber:t,recaptchaToken:i}).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new Hi("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Ri(eo,{PROVIDER_ID:"phone"}),Ri(eo,{PHONE_SIGN_IN_METHOD:"phone"}),oo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.i&&t.push(this.i),t.join("-")},oo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.h,error:this.a&&this.a.w()}};var uo,ho=null;function co(t){var e="unauthorized-domain",n=void 0,i=Xe(t);t=i.b,"chrome-extension"==(i=i.c)?n=ht("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=ht("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Hi.call(this,e,n)}function lo(t,e,n){Hi.call(this,t,n),(t=e||{}).Ab&&Pi(this,"email",t.Ab),t.$&&Pi(this,"phoneNumber",t.$),t.credential&&Pi(this,"credential",t.credential)}function po(t){if(t.code){var e=t.code||"";0==e.indexOf(Qi)&&(e=e.substring(Qi.length));var n={credential:io(t)};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new Hi(e,t.message||void 0);return new lo(e,n,t.message)}return null}function fo(){}function vo(t){return t.c||(t.c=t.b())}function yo(){}function go(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function mo(){}function _o(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=_(this.fc,this),this.a.onerror=_(this.Gb,this),this.a.onprogress=_(this.gc,this),this.a.ontimeout=_(this.kc,this)}function bo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function wo(t,e,n){this.reset(t,e,n,void 0,void 0)}so.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=ci("universalLinks.subscribe",n))&&t(null,this.b))},so.prototype.unsubscribe=function(t){j(this.a,(function(e){return e==t}))},E(co,Hi),E(lo,Hi),lo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.w();return e&&ut(t,e),t},lo.prototype.toJSON=function(){return this.w()},fo.prototype.c=null,E(yo,fo),yo.prototype.a=function(){var t=go(this);return t?new ActiveXObject(t):new XMLHttpRequest},yo.prototype.b=function(){var t={};return go(this)&&(t[0]=!0,t[1]=!0),t},uo=new yo,E(mo,fo),mo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new _o;throw Error("Unsupported browser")},mo.prototype.b=function(){return{}},(t=_o.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,bo(this,4)},t.Gb=function(){this.status=500,this.response=this.responseText="",bo(this,4)},t.kc=function(){this.Gb()},t.gc=function(){this.status=200,bo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},wo.prototype.a=null;function Eo(t){this.f=t,this.b=this.c=this.a=null}function Co(t,e){this.name=t,this.value=e}wo.prototype.reset=function(t,e,n,i,r){"number"==typeof r||0,i||w(),delete this.a},Co.prototype.toString=function(){return this.name};var To=new Co("SEVERE",1e3),Io=new Co("WARNING",900),So=new Co("CONFIG",700),No=new Co("FINE",500);Eo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(S("Root logger has no level set."),null)}(this).value)for(f(e)&&(e=e()),t=new wo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Ao={},ko=null;function Po(t){var e;if(ko||(ko=new Eo(""),Ao[""]=ko,ko.c=So),!(e=Ao[t])){e=new Eo(t);var n=t.lastIndexOf("."),i=t.substr(n+1);(n=Po(t.substr(0,n))).b||(n.b={}),n.b[i]=e,e.a=n,Ao[t]=e}return e}function Ro(t,e){t&&t.log(No,e,void 0)}function Oo(t){this.f=t}function Do(t){Oe.call(this),this.u=t,this.readyState=xo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Po("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}E(Oo,fo),Oo.prototype.a=function(){return new Do(this.f)},Oo.prototype.b=function(t){return function(){return t}}({}),E(Do,Oe);var xo=0;function Lo(t){t.c.read().then(t.ec.bind(t)).catch(t.La.bind(t))}function Fo(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,Mo(t)}function Mo(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Uo(t){Oe.call(this),this.headers=new We,this.D=t||null,this.c=!1,this.A=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.m=jo,this.v=this.O=!1}(t=Do.prototype).open=function(t,e){if(this.readyState!=xo)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,Mo(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.g,e)).then(this.jc.bind(this),this.La.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Fo(this,!1)),this.readyState=xo},t.jc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,Mo(this)),this.a&&(this.readyState=3,Mo(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.hc.bind(this),this.La.bind(this)):void 0!==n.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,Lo(this)):t.text().then(this.ic.bind(this),this.La.bind(this)))))},t.ec=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Fo(this,!0):Mo(this),3==this.readyState&&Lo(this)}},t.ic=function(t){this.a&&(this.response=this.responseText=t,Fo(this,!0))},t.hc=function(t){this.a&&(this.response=t,Fo(this,!0))},t.La=function(t){var e=this.h;e&&e.log(Io,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&Fo(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(Io,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(Io,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},E(Uo,Oe);var jo="";Uo.prototype.b=Po("goog.net.XhrIo");var Wo=/^https?$/i,Vo=["POST","PUT"];function qo(t,e,i,o,a){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);i=i?i.toUpperCase():"GET",t.l=e,t.h="",t.N=i,t.G=!1,t.c=!0,t.a=t.D?t.D.a():uo.a(),t.A=t.D?vo(t.D):vo(uo),t.a.onreadystatechange=_(t.Jb,t);try{Ro(t.b,Jo(t,"Opening Xhr")),t.I=!0,t.a.open(i,String(e),!0),t.I=!1}catch(e){return Ro(t.b,Jo(t,"Error opening Xhr: "+e.message)),void Bo(t,e)}e=o||"";var s=new We(t.headers);a&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||r(t))x(t,e,void 0);else for(var n=je(t),i=Ue(t),o=i.length,a=0;a<o;a++)e.call(void 0,i[a],n&&n[a],t)}(a,(function(t,e){s.set(e,t)})),a=function(t){t:{for(var e=Ho,n=t.length,i=r(t)?t.split(""):t,o=0;o<n;o++)if(o in i&&e.call(void 0,i[o],o,t)){e=o;break t}e=-1}return 0>e?null:r(t)?t.charAt(e):t[e]}(s.U()),o=n.FormData&&e instanceof n.FormData,!M(Vo,i)||a||o||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{Yo(t),0<t.g&&(t.v=function(t){return Qt&&ne(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),Ro(t.b,Jo(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=_(t.Ga,t)):t.u=Fe(t.Ga,t.g,t)),Ro(t.b,Jo(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){Ro(t.b,Jo(t,"Send error: "+e.message)),Bo(t,e)}}function Ho(t){return"content-type"==t.toLowerCase()}function Bo(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Qo(t),Go(t)}function Qo(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ko(t){if(t.c&&void 0!==e)if(t.A[1]&&4==zo(t)&&2==Xo(t))Ro(t.b,Jo(t,"Local request error detected and ignored"));else if(t.i&&4==zo(t))Fe(t.Jb,0,t);else if(t.dispatchEvent("readystatechange"),4==zo(t)){Ro(t.b,Jo(t,"Request complete")),t.c=!1;try{var i,r=Xo(t);t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break t;default:o=!1}if(!(i=o)){var a;if(a=0===r){var s=String(t.l).match(He)[1]||null;if(!s&&n.self&&n.self.location){var u=n.self.location.protocol;s=u.substr(0,u.length-1)}a=!Wo.test(s?s.toLowerCase():"")}i=a}if(i)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var h=2<zo(t)?t.a.statusText:""}catch(e){Ro(t.b,"Can not get status: "+e.message),h=""}t.h=h+" ["+Xo(t)+"]",Qo(t)}}finally{Go(t)}}}function Go(t,e){if(t.a){Yo(t);var n=t.a,i=t.A[0]?u:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(e){(t=t.b)&&t.log(To,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Yo(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(n.clearTimeout(t.u),t.u=null)}function zo(t){return t.a?t.a.readyState:0}function Xo(t){try{return 2<zo(t)?t.a.status:-1}catch(t){return-1}}function Jo(t,e){return e+" ["+t.N+" "+t.l+" "+Xo(t)+"]"}function $o(t){var e=ha;this.g=[],this.v=e,this.u=t||null,this.f=this.a=!1,this.c=void 0,this.l=this.A=this.i=!1,this.h=0,this.b=null,this.o=0}function Zo(t,e,n){t.a=!0,t.c=n,t.f=!e,ia(t)}function ta(t){if(t.a){if(!t.l)throw new ra(t);t.l=!1}}function ea(t,e,n,i){t.g.push([e,n,i]),t.a&&ia(t)}function na(t){return F(t.g,(function(t){return f(t[1])}))}function ia(t){if(t.h&&t.a&&na(t)){var e=t.h,i=sa[e];i&&(n.clearTimeout(i.a),delete sa[e]),t.h=0}t.b&&(t.b.o--,delete t.b),e=t.c;for(var r=i=!1;t.g.length&&!t.i;){var o=t.g.shift(),a=o[0],s=o[1];if(o=o[2],a=t.f?s:a)try{var u=a.call(o||t.u,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(C(e)||"function"==typeof n.Promise&&e instanceof n.Promise)&&(r=!0,t.i=!0)}catch(n){e=n,t.f=!0,na(t)||(i=!0)}}t.c=e,r&&(u=_(t.m,t,!0),r=_(t.m,t,!1),e instanceof $o?(ea(e,u,r),e.A=!0):e.then(u,r)),i&&(e=new aa(e),sa[e.a]=e,t.h=e.a)}function ra(){T.call(this)}function oa(){T.call(this)}function aa(t){this.a=n.setTimeout(_(this.c,this),0),this.b=t}(t=Uo.prototype).Ga=function(){void 0!==e&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Ro(this.b,Jo(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Ro(this.b,Jo(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Go(this))},t.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Go(this,!0)),Uo.pb.va.call(this)},t.Jb=function(){this.qa||(this.I||this.i||this.f?Ko(this):this.yc())},t.yc=function(){Ko(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case jo:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(To,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return Ro(this.b,"Can not get response: "+t.message),null}},$o.prototype.cancel=function(t){if(this.a)this.c instanceof $o&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.o--,0>=e.o&&e.cancel())}this.v?this.v.call(this.u,this):this.l=!0,this.a||(t=new oa(this),ta(this),Zo(this,!1,t))}},$o.prototype.m=function(t,e){this.i=!1,Zo(this,t,e)},$o.prototype.then=function(t,e,n){var i,r,o=new yt((function(t,e){i=t,r=e}));return ea(this,i,(function(t){t instanceof oa?o.cancel():r(t)})),o.then(t,e,n)},$o.prototype.$goog_Thenable=!0,E(ra,T),ra.prototype.message="Deferred has already fired",ra.prototype.name="AlreadyCalledError",E(oa,T),oa.prototype.message="Deferred was canceled",oa.prototype.name="CanceledError",aa.prototype.c=function(){throw delete sa[this.a],this.b};var sa={};function ua(t){var e={},i=e.document||document,r=bn(t).toString(),o=document.createElement("SCRIPT"),u={Lb:o,Ga:void 0},h=new $o(u),c=null,l=null!=e.timeout?e.timeout:5e3;return 0<l&&(c=window.setTimeout((function(){ca(o,!0);var t=new fa(pa,"Timeout reached for loading script "+r);ta(h),Zo(h,!1,t)}),l),u.Ga=c),o.onload=o.onreadystatechange=function(){o.readyState&&"loaded"!=o.readyState&&"complete"!=o.readyState||(ca(o,e.hd||!1,c),ta(h),Zo(h,!0,null))},o.onerror=function(){ca(o,!0,c);var t=new fa(la,"Error while loading script "+r);ta(h),Zo(h,!1,t)},ut(u=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Ln(o,u),function(t,e){t.src=bn(e),null===s&&(s=(e=(e=n.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&a.test(e)?e:""),(e=s)&&t.setAttribute("nonce",e)}(o,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(i).appendChild(o),h}function ha(){if(this&&this.Lb){var t=this.Lb;t&&"SCRIPT"==t.tagName&&ca(t,!0,this.Ga)}}function ca(t,e,i){null!=i&&n.clearTimeout(i),t.onload=u,t.onerror=u,t.onreadystatechange=u,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var la=0,pa=1;function fa(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),T.call(this,n),this.code=t}function da(t){this.f=t}function va(t,e,r){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.o=t.secureTokenTimeout||ma,this.f=rt(t.secureTokenHeaders||_a),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||ba,this.a=rt(t.firebaseHeaders||wa),r&&(this.a["X-Client-Version"]=r,this.f["X-Client-Version"]=r),r="Node"==ni(),!(r=n.XMLHttpRequest||r&&i.a.INTERNAL.node&&i.a.INTERNAL.node.XMLHttpRequest)&&!ei())throw new Hi("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,ei()?this.c=new Oo(self):ii()?this.c=new da(r):this.c=new mo}E(fa,T),E(da,fo),da.prototype.a=function(){return new this.f},da.prototype.b=function(){return{}};var ya,ga="idToken",ma=new Ei(3e4,6e4),_a={"Content-Type":"application/x-www-form-urlencoded"},ba=new Ei(3e4,6e4),wa={"Content-Type":"application/json"};function Ea(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ca(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function Ta(t,e,i,r,o,a,s){(function(){var t=hi();return!((t=ai(t)!=oi?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!Qt||!te||9<te)})()||ei()?t=_(t.m,t):(ya||(ya=new yt((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{n[Sa]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){ea(t,null,e,void 0)}(ua(wn(Ia,{onload:Sa})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=_(t.l,t)),t(e,i,r,o,a,s)}va.prototype.m=function(t,e,i,r,o,a){if(ei()&&(void 0===n.fetch||void 0===n.Headers||void 0===n.Request))throw new Hi("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new Uo(this.c);if(a){s.g=Math.max(0,a);var u=setTimeout((function(){s.dispatchEvent("timeout")}),a)}De(s,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Ro(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),xe(s,"ready",(function(){u&&clearTimeout(u),Wt(this)})),xe(s,"timeout",(function(){u&&clearTimeout(u),Wt(this),e&&e(null)})),qo(s,t,i,r,o)};var Ia=new vn(mn,"https://apis.google.com/js/client.js?onload=%{onload}"),Sa="__fcb"+Math.floor(1e6*Math.random()).toString();function Na(t){if(!r(t=t.email)||!Jn.test(t))throw new Hi("invalid-email")}function Aa(t){"email"in t&&Na(t)}function ka(t){if(!t[ga])throw new Hi("internal-error")}function Pa(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Hi("internal-error")}else{if(!t.sessionInfo)throw new Hi("missing-verification-id");if(!t.code)throw new Hi("missing-verification-code")}}va.prototype.l=function(t,e,n,i,r){var o=this;ya.then((function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).s((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},va.prototype.Ra=function(){return ps(this,is,{})},va.prototype.qb=function(t,e){return ps(this,es,{idToken:t,email:e})},va.prototype.rb=function(t,e){return ps(this,ns,{idToken:t,password:e})};var Ra={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Oa(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Hi("internal-error")}function Da(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(ln(t=new sn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function xa(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=po(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=po(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=po(t)):t.errorMessage&&(e=fs(t.errorMessage)),e)throw e;if(!t[ga])throw new Hi("internal-error")}function La(t,e){return e.returnIdpCredential=!0,ps(t,rs,e)}function Fa(t,e){return e.returnIdpCredential=!0,ps(t,as,e)}function Ma(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ps(t,os,e)}function Ua(t){if(!t.oobCode)throw new Hi("invalid-action-code")}(t=va.prototype).sb=function(t,e){var n={idToken:t},i=[];return nt(Ra,(function(t,r){var o=e[r];null===o?i.push(t):r in e&&(n[r]=o)})),i.length&&(n.deleteAttribute=i),ps(this,es,n)},t.lb=function(t,e){return ut(t={requestType:"PASSWORD_RESET",email:t},e),ps(this,Xa,t)},t.mb=function(t,e){return ut(t={requestType:"EMAIL_SIGNIN",email:t},e),ps(this,Ya,t)},t.kb=function(t,e){return ut(t={requestType:"VERIFY_EMAIL",idToken:t},e),ps(this,za,t)},t.Va=function(t){return ps(this,hs,t)},t.$a=function(t,e){return ps(this,Za,{oobCode:t,newPassword:e})},t.Ja=function(t){return ps(this,Wa,{oobCode:t})},t.Xa=function(t){return ps(this,ja,{oobCode:t})};var ja={endpoint:"setAccountInfo",C:Ua,da:"email"},Wa={endpoint:"resetPassword",C:Ua,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Hi("internal-error")}},Va={endpoint:"signupNewUser",C:function(t){if(Na(t),!t.password)throw new Hi("weak-password")},J:ka,R:!0},qa={endpoint:"createAuthUri"},Ha={endpoint:"deleteAccount",T:["idToken"]},Ba={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],C:function(t){if(!l(t.deleteProvider))throw new Hi("internal-error")}},Qa={endpoint:"emailLinkSignin",T:["email","oobCode"],C:Na,J:ka,R:!0},Ka={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],C:Na,J:ka,R:!0},Ga={endpoint:"getAccountInfo"},Ya={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Hi("internal-error");Na(t)},da:"email"},za={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],C:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Hi("internal-error")},da:"email"},Xa={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Hi("internal-error");Na(t)},da:"email"},Ja={vb:!0,endpoint:"getProjectConfig",Ib:"GET"},$a={vb:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new Hi("internal-error")}},Za={endpoint:"resetPassword",C:Ua,da:"email"},ts={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},es={endpoint:"setAccountInfo",T:["idToken"],C:Aa,R:!0},ns={endpoint:"setAccountInfo",T:["idToken"],C:function(t){if(Aa(t),!t.password)throw new Hi("weak-password")},J:ka,R:!0},is={endpoint:"signupNewUser",J:ka,R:!0},rs={endpoint:"verifyAssertion",C:Oa,Pa:Da,J:xa,R:!0},os={endpoint:"verifyAssertion",C:Oa,Pa:Da,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Hi("user-not-found");if(t.errorMessage)throw fs(t.errorMessage);if(!t[ga])throw new Hi("internal-error")},R:!0},as={endpoint:"verifyAssertion",C:function(t){if(Oa(t),!t.idToken)throw new Hi("internal-error")},Pa:Da,J:xa,R:!0},ss={endpoint:"verifyCustomToken",C:function(t){if(!t.token)throw new Hi("invalid-custom-token")},J:ka,R:!0},us={endpoint:"verifyPassword",C:function(t){if(Na(t),!t.password)throw new Hi("wrong-password")},J:ka,R:!0},hs={endpoint:"verifyPhoneNumber",C:Pa,J:ka},cs={endpoint:"verifyPhoneNumber",C:function(t){if(!t.idToken)throw new Hi("internal-error");Pa(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",po(t);ka(t)}},ls={Xb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",C:Pa,J:ka};function ps(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return!1}return!0}(n,e.T))return Tt(new Hi("internal-error"));var i,r=e.Ib||"POST";return Ct(n).then(e.C).then((function(){return e.R&&(n.returnSecureToken=!0),function(t,e,n,i,r,o){var a=Xe(t.g+e);Ye(a,"key",t.b),o&&Ye(a,"cb",w().toString());var s="GET"==n;if(s)for(var u in i)i.hasOwnProperty(u)&&Ye(a,u,i[u]);return new yt((function(e,o){Ta(t,a.toString(),(function(t){t?t.error?o(ds(t,r||{})):e(t):o(new Hi("network-request-failed"))}),n,s?void 0:jn(gi(i)),t.a,t.h.get())}))}(t,e.endpoint,r,n,e.Xb,e.vb||!1)})).then((function(t){return i=t,e.Pa?e.Pa(n,i):i})).then(e.J).then((function(){if(!e.da)return i;if(!(e.da in i))throw new Hi("internal-error");return i[e.da]}))}function fs(t){return ds({error:{errors:[{message:t}],code:400,message:t}})}function ds(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new Hi(i[n]):null)return n;for(var r in n=t.error&&t.error.message||"",ut(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,i)if(0===n.indexOf(r))return new Hi(i[r],e);return!e&&t&&(e=yi(t)),new Hi("internal-error",e)}function vs(t){this.b=t,this.a=null,this.gb=function(t){return(_s||(_s=new yt((function(t,e){function i(){wi(),ci("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){wi(),e(Error("Network Error"))},timeout:gs.get()})}if(ci("gapi.iframes.Iframe"))t();else if(ci("gapi.load"))i();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();n[r]=function(){ci("gapi.load")?i():e(Error("Network Error"))},Ct(ua(r=wn(ys,{onload:r}))).s((function(){e(Error("Network Error"))}))}})).s((function(t){throw _s=null,t})))).then((function(){return new yt((function(e,n){ci("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:ci("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(i){function r(){clearTimeout(o),e()}t.a=i,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),ms.get());i.ping(r).then(r,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var ys=new vn(mn,"https://apis.google.com/js/api.js?onload=%{onload}"),gs=new Ei(3e4,6e4),ms=new Ei(5e3,15e3),_s=null;function bs(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Je(this.i,"/__/auth/iframe"),Ye(this.a,"apiKey",this.g),Ye(this.a,"appName",this.h),this.b=null,this.c=[]}function ws(t,e,n,i,r){this.m=t,this.l=e,this.c=n,this.o=i,this.h=this.g=this.i=null,this.a=r,this.f=null}function Es(t){try{return i.a.app(t).auth().ya()}catch(t){return[]}}function Cs(t,e,n,i,r){this.l=t,this.f=e,this.b=n,this.c=i||null,this.h=r||null,this.m=this.u=this.v=null,this.g=[],this.o=this.a=null}function Ts(t){var e=Qn();return function(t){return ps(t,Ja,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Xe(e),i=n.c;n=n.b;for(var r=0;r<t.length;r++){var o=t[r],a=n,s=i;if(0==o.indexOf("chrome-extension://")?a=Xe(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Xn.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new co(Qn())}))}function Is(t){return t.o||(t.o=$n().then((function(){if(!t.u){var e=t.c,n=t.h,i=Es(t.b),r=new bs(t.l,t.f,t.b);r.f=e,r.b=n,r.c=V(i||[]),t.u=r.toString()}t.i=new vs(t.u),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.gb.then((function(){t.a.register("authEvent",e,ci("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.i,(function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=ao(e.authEvent),n=0;n<t.g.length;n++)i=t.g[n](e)||i;return(n={}).status=i?"ACK":"ERROR",Ct(n)}return n.status="ERROR",Ct(n)}))}(t)}))),t.o}function Ss(t){return t.m||(t.v=t.c?ui(t.c,Es(t.b)):null,t.m=new va(t.f,pr(t.h),t.v)),t.m}function Ns(t,e,n,i,r,o,a,s,u,h){return(t=new ws(t,e,n,i,r)).i=o,t.g=a,t.h=s,t.b=rt(u||null),t.f=h,t.toString()}function As(t){if(this.a=t||i.a.INTERNAL.reactNative&&i.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Hi("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ks(t){this.b=t,this.a={},this.c=_(this.f,this)}bs.prototype.toString=function(){return this.f?Ye(this.a,"v",this.f):cn(this.a.a,"v"),this.b?Ye(this.a,"eid",this.b):cn(this.a.a,"eid"),this.c.length?Ye(this.a,"fw",this.c.join(",")):cn(this.a.a,"fw"),this.a.toString()},ws.prototype.toString=function(){var t=Je(this.m,"/__/auth/handler");if(Ye(t,"apiKey",this.l),Ye(t,"appName",this.c),Ye(t,"authType",this.o),this.a.isOAuthProvider){var e=this.a;try{var n=i.a.app(this.c).auth().ea()}catch(t){n=null}for(var r in e.ab=n,Ye(t,"providerId",this.a.providerId),n=gi((e=this.a).zb))n[r]=n[r].toString();r=e.Fc,n=rt(n);for(var o=0;o<r.length;o++){var a=r[o];a in n&&delete n[a]}e.eb&&e.ab&&!n[e.eb]&&(n[e.eb]=e.ab),it(n)||Ye(t,"customParameters",yi(n))}if("function"==typeof this.a.Fb&&((e=this.a.Fb()).length&&Ye(t,"scopes",e.join(","))),this.i?Ye(t,"redirectUrl",this.i):cn(t.a,"redirectUrl"),this.g?Ye(t,"eventId",this.g):cn(t.a,"eventId"),this.h?Ye(t,"v",this.h):cn(t.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!ze(t,s)&&Ye(t,s,this.b[s]);return this.f?Ye(t,"eid",this.f):cn(t.a,"eid"),(s=Es(this.c)).length&&Ye(t,"fw",s.join(",")),t.toString()},(t=Cs.prototype).Ea=function(t,e,n){var i=new Hi("popup-closed-by-user"),r=new Hi("web-storage-unsupported"),o=this,a=!1;return this.ga().then((function(){(function(t){var e={type:"webStorageSupport"};return Is(t).then((function(){return function(t,e){return t.gb.then((function(){return new yt((function(n){t.a.send(e.type,e,n,ci("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.i,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&Yn(t),e(r),a=!0)}))})).s((function(){})).then((function(){if(!a)return function(t){return new yt((function(e){return function n(){Me(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return Me(n).then((function(){e(i)}))}))},t.Mb=function(){var t=hi();return!vi(t)&&!bi(t)},t.Hb=function(){return!1},t.Db=function(t,e,n,i,r,o,a){if(!t)return Tt(new Hi("popup-blocked"));if(a&&!vi())return this.ga().s((function(e){Yn(t),r(e)})),i(),Ct();this.a||(this.a=Ts(Ss(this)));var s=this;return this.a.then((function(){var e=s.ga().s((function(e){throw Yn(t),r(e),e}));return i(),e})).then((function(){(ro(n),a)||Kn(Ns(s.l,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)})).s((function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t}))},t.Ca=function(t,e,n){this.a||(this.a=Ts(Ss(this)));var i=this;return this.a.then((function(){ro(e),Kn(Ns(i.l,i.f,i.b,t,e,Qn(),n,i.c,void 0,i.h))})).s((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ga=function(){var t=this;return Is(this).then((function(){return t.i.gb})).s((function(){throw t.a=null,new Hi("network-request-failed")}))},t.Qb=function(){return!0},t.wa=function(t){this.g.push(t)},t.Ka=function(t){j(this.g,(function(e){return e==t}))},(t=As.prototype).get=function(t){return Ct(this.a.getItem(t)).then((function(t){return t&&mi(t)}))},t.set=function(t,e){return Ct(this.a.setItem(t,yi(e)))},t.P=function(t){return Ct(this.a.removeItem(t))},t.Y=function(){},t.ca=function(){};var Ps,Rs=[];function Os(t){this.a=t}function Ds(t){this.c=t,this.b=!1,this.a=[]}function xs(t,e,n,i){var r,o,a,s,u=n||{},h=null;if(t.b)return Tt(Error("connection_unavailable"));var c=i?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new yt((function(n,i){l?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout((function(){i(Error("unsupported_event"))}),c),h={messageChannel:l,onMessage:o=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){i(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):i(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),i(Error("invalid_response"))))}},t.a.push(h),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:r,data:u},[l.port2])):i(Error("connection_unavailable"))})).then((function(e){return Ls(t,h),e})).s((function(e){throw Ls(t,h),e}))}function Ls(t,e){if(e){var n=e.messageChannel,i=e.onMessage;n&&(n.port1.removeEventListener("message",i),n.port1.close()),j(t.a,(function(t){return t==e}))}}function Fs(){if(!js())throw new Hi("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.l=n.indexedDB,this.type="indexedDB",this.g=this.o=this.f=this.i=null,this.u=!1,this.h=null;var t=this;ei()&&self?(this.o=function(){var t=ei()?self:null;if(x(Rs,(function(n){n.b==t&&(e=n)})),!e){var e=new ks(t);Rs.push(e)}return e}(),this.o.subscribe("keyChanged",(function(e,n){return Bs(t).then((function(e){return 0<e.length&&x(t.a,(function(t){t(e)})),{keyProcessed:M(e,n.key)}}))})),this.o.subscribe("ping",(function(){return Ct(["keyChanged"])}))):function(){var t=n.navigator;return t&&t.serviceWorker?Ct().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).s((function(){return null})):Ct(null)}().then((function(e){(t.h=e)&&(t.g=new Ds(new Os(e)),xs(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&M(e[0].value,"keyChanged")&&(t.u=!0)})).s((function(){})))}))}function Ms(t){return new yt((function(e,n){var i=t.l.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(i):function(t){return new yt((function(e,n){var i=t.l.deleteDatabase("firebaseLocalStorageDb");i.onsuccess=function(){e()},i.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Ms(t)})).then((function(t){e(t)})).s((function(t){n(t)}))}}))}function Us(t){return t.m||(t.m=Ms(t)),t.m}function js(){try{return!!n.indexedDB}catch(t){return!1}}function Ws(t){return t.objectStore("firebaseLocalStorage")}function Vs(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function qs(t){return new yt((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Hs(t,e){return t.g&&t.h&&function(){var t=n.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?xs(t.g,"keyChanged",{key:e},t.u).then((function(){})).s((function(){})):Ct()}function Bs(t){return Us(t).then((function(t){var e=Ws(Vs(t,!1));return e.getAll?qs(e.getAll()):new yt((function(t,n){var i=[],r=e.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},i=[];if(0==t.b){for(i=0;i<e.length;i++)n[e[i].fbase_key]=e[i].value;i=function t(e,n){var i,r=[];for(i in e)i in n?typeof e[i]!=typeof n[i]?r.push(i):"object"==typeof e[i]&&null!=e[i]&&null!=n[i]?0<t(e[i],n[i]).length&&r.push(i):e[i]!==n[i]&&r.push(i):r.push(i);for(i in n)i in e||r.push(i);return r}(t.c,n),t.c=n}return i}))}function Qs(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Ks(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ct().then((function(){if(js()){var t=_i(),i="__sak"+t;return Ps||(Ps=new Fs),(n=Ps).set(i,t).then((function(){return n.get(i)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.P(i)})).then((function(){return n})).s((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.Y((function(t){x(e.a,(function(e){e(t)}))})),t}))}function Gs(){this.a={},this.type="inMemory"}function Ys(){if(!function(){var t="Node"==ni();if(!(t=zs()||t&&i.a.INTERNAL.node&&i.a.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==ni())throw new Hi("internal-error","The LocalStorage compatibility library was not found.");throw new Hi("web-storage-unsupported")}this.a=zs()||i.a.INTERNAL.node.localStorage,this.type="localStorage"}function zs(){try{var t=n.localStorage,e=_i();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Xs(){this.type="nullStorage"}function Js(){if(!function(){var t="Node"==ni();if(!(t=$s()||t&&i.a.INTERNAL.node&&i.a.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==ni())throw new Hi("internal-error","The SessionStorage compatibility library was not found.");throw new Hi("web-storage-unsupported")}this.a=$s()||i.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function $s(){try{var t=n.sessionStorage,e=_i();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Zs(){var t={};t.Browser=nu,t.Node=iu,t.ReactNative=ru,t.Worker=ou,this.a=t[ni()]}ks.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,i=this.a[e];if(i&&0<i.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var r=[];x(i,(function(e){r.push(Ct().then((function(){return e(t.origin,t.data.data)})))})),St(r).then((function(i){var r=[];x(i,(function(t){r.push({fulfilled:t.Eb,value:t.value,reason:t.reason?t.reason.message:void 0})})),x(r,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:r})}))}},ks.prototype.subscribe=function(t,e){it(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},ks.prototype.unsubscribe=function(t,e){void 0!==this.a[t]&&e?(j(this.a[t],(function(t){return t==e})),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],it(this.a)&&this.b.removeEventListener("message",this.c)},Os.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Ds.prototype.close=function(){for(;0<this.a.length;)Ls(this,this.a[0]);this.b=!0},(t=Fs.prototype).set=function(t,e){var n,i=!1,r=this;return Us(this).then((function(e){return qs((e=Ws(Vs(n=e,!0))).get(t))})).then((function(o){var a=Ws(Vs(n,!0));return o?(o.value=e,qs(a.put(o))):(r.b++,i=!0,(o={}).fbase_key=t,o.value=e,qs(a.add(o)))})).then((function(){return r.c[t]=e,Hs(r,t)})).ia((function(){i&&r.b--}))},t.get=function(t){return Us(this).then((function(e){return qs(Ws(Vs(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.P=function(t){var e=!1,n=this;return Us(this).then((function(i){return e=!0,n.b++,qs(Ws(Vs(i,!0)).delete(t))})).then((function(){return delete n.c[t],Hs(n,t)})).ia((function(){e&&n.b--}))},t.Y=function(t){0==this.a.length&&function(t){Qs(t),function e(){t.f=setTimeout((function(){t.i=Bs(t).then((function(e){0<e.length&&x(t.a,(function(t){t(e)}))})).then((function(){e()})).s((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ca=function(t){j(this.a,(function(e){return e==t})),0==this.a.length&&Qs(this)},(t=Ks.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.P=function(t){return this.b.then((function(e){return e.P(t)}))},t.Y=function(t){this.a.push(t)},t.ca=function(t){j(this.a,(function(e){return e==t}))},(t=Gs.prototype).get=function(t){return Ct(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ct()},t.P=function(t){return delete this.a[t],Ct()},t.Y=function(){},t.ca=function(){},(t=Ys.prototype).get=function(t){var e=this;return Ct().then((function(){return mi(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ct().then((function(){var i=yi(e);null===i?n.P(t):n.a.setItem(t,i)}))},t.P=function(t){var e=this;return Ct().then((function(){e.a.removeItem(t)}))},t.Y=function(t){n.window&&be(n.window,"storage",t)},t.ca=function(t){n.window&&Ce(n.window,"storage",t)},(t=Xs.prototype).get=function(){return Ct(null)},t.set=function(){return Ct()},t.P=function(){return Ct()},t.Y=function(){},t.ca=function(){},(t=Js.prototype).get=function(t){var e=this;return Ct().then((function(){return mi(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ct().then((function(){var i=yi(e);null===i?n.P(t):n.a.setItem(t,i)}))},t.P=function(t){var e=this;return Ct().then((function(){e.a.removeItem(t)}))},t.Y=function(){},t.ca=function(){};var tu,eu,nu={B:Ys,Sa:Js},iu={B:Ys,Sa:Js},ru={B:As,Sa:Xs},ou={B:Ys,Sa:Xs},au={ad:"local",NONE:"none",cd:"session"};function su(){var t=!(bi(hi())||!ti()),e=vi(),i=li();this.m=t,this.h=e,this.o=i,this.a={},tu||(tu=new Zs),t=tu;try{this.g=!Bn()&&Ii()||!n.indexedDB?new t.a.B:new Ks(ei()?new Gs:new t.a.B)}catch(t){this.g=new Gs,this.h=!0}try{this.i=new t.a.Sa}catch(t){this.i=new Gs}this.l=new Gs,this.f=_(this.Pb,this),this.b={}}function uu(){return eu||(eu=new su),eu}function hu(t,e){switch(e){case"session":return t.i;case"none":return t.l;default:return t.g}}function cu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function lu(t,e,n){return n=cu(e,n),"local"==e.B&&(t.b[n]=null),hu(t,e.B).P(n)}function pu(t){t.c&&(clearInterval(t.c),t.c=null)}function fu(t){this.a=t,this.b=uu()}(t=su.prototype).get=function(t,e){return hu(this,t.B).get(cu(t,e))},t.set=function(t,e,n){var i=cu(t,n),r=this,o=hu(this,t.B);return o.set(i,e).then((function(){return o.get(i)})).then((function(e){"local"==t.B&&(r.b[i]=e)}))},t.addListener=function(t,e,i){t=cu(t,e),this.o&&(this.b[t]=n.localStorage.getItem(t)),it(this.a)&&(hu(this,"local").Y(this.f),this.h||(Bn()||!Ii())&&n.indexedDB||!this.o||function(t){pu(t),t.c=setInterval((function(){for(var e in t.a){var i=n.localStorage.getItem(e),r=t.b[e];i!=r&&(t.b[e]=i,i=new he({type:"storage",key:e,target:window,oldValue:r,newValue:i,a:!0}),t.Pb(i))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(i)},t.removeListener=function(t,e,n){t=cu(t,e),this.a[t]&&(j(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),it(this.a)&&(hu(this,"local").ca(this.f),pu(this))},t.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var i in this.a){var r=this.b[i];void 0===r&&(r=null);var o=n.localStorage.getItem(i);o!==r&&(this.b[i]=o,this.Ya(i))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?hu(this,"local").ca(this.f):pu(this),this.m)if(i=n.localStorage.getItem(e),(r=t.a.newValue)!==i)null!==r?n.localStorage.setItem(e,r):n.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var a=this;i=function(){void 0===t.a.a&&a.b[e]===n.localStorage.getItem(e)||(a.b[e]=n.localStorage.getItem(e),a.Ya(e))},Qt&&te&&10==te&&n.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(i,10):i()}}else x(t,_(this.Ya,this))},t.Ya=function(t){this.a[t]&&x(this.a[t],(function(t){t()}))};var du,vu={name:"authEvent",B:"local"};function yu(){this.a=uu()}function gu(t,e){this.b=mu,this.f=n.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.o=n.Int32Array?new Int32Array(64):Array(64),void 0!==du||(du=n.Int32Array?new Int32Array(Iu):Iu),this.reset()}E(gu,(function(){this.b=-1}));for(var mu=64,_u=mu-1,bu=[],wu=0;wu<_u;wu++)bu[wu]=0;var Eu=W(128,bu);function Cu(t){for(var e=t.f,n=t.o,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.a[0],r=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],h=0|t.a[4],c=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var p=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=(o=o+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))|0)+((a=(a=h&c^~h&l)+(0|du[e])|0)+(0|n[e])|0)|0,o=l,l=c,c=h,h=u+a|0,u=s,s=r,r=i,i=a+p|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+h|0,t.a[5]=t.a[5]+c|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function Tu(t,e,n){void 0===n&&(n=e.length);var i=0,o=t.c;if(r(e))for(;i<n;)t.f[o++]=e.charCodeAt(i++),o==t.b&&(Cu(t),o=0);else{if(!p(e))throw Error("message must be string or array");for(;i<n;){var a=e[i++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");t.f[o++]=a,o==t.b&&(Cu(t),o=0)}}t.c=o,t.g+=n}gu.prototype.reset=function(){this.g=this.c=0,this.a=n.Int32Array?new Int32Array(this.h):V(this.h)};var Iu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Su(){gu.call(this,8,Nu)}E(Su,gu);var Nu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Au(t,e,n,i,r){this.l=t,this.i=e,this.o=n,this.m=i||null,this.u=r||null,this.h=e+":"+n,this.v=new yu,this.g=new fu(this.h),this.f=null,this.b=[],this.a=this.c=null}function ku(t){return new Hi("invalid-cordova-configuration",t)}function Pu(t){var e=new Su;Tu(e,t),t=[];var n=8*e.g;56>e.c?Tu(e,Eu,56-e.c):Tu(e,Eu,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(Cu(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return function(t){return L(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function Ru(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Ou(t){return t.f||(t.f=t.ga().then((function(){return new yt((function(e){t.wa((function n(i){return e(i),t.Ka(n),!1})),function(t){function e(e){r=!0,o&&o.cancel(),Du(t).then((function(n){var r=i;if(n&&e&&e.url){var o=null;-1!=(r=Nr(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=mi(ze(o=Xe(r),"firebaseError")||null))?Bi(o):null)?new oo(n.c,n.b,null,null,o):new oo(n.c,n.b,r,n.f)),r=o||i}Ru(t,r)}))}var i=new oo("unknown",null,null,null,new Hi("no-auth-event")),r=!1,o=Me(500).then((function(){return Du(t).then((function(){r||Ru(t,i)}))})),a=n.handleOpenURL;n.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(ci("BuildInfo.packageName",n).toLowerCase()+"://")&&e({url:t}),"function"==typeof a)try{a(t)}catch(t){console.error(t)}},ho||(ho=new so),ho.subscribe(e)}(t)}))}))),t.f}function Du(t){var e=null;return function(t){return t.b.get(vu,t.a).then((function(t){return ao(t)}))}(t.g).then((function(n){return e=n,lu((n=t.g).b,vu,n.a)})).then((function(){return e}))}function xu(t){this.a=t,this.b=uu()}(t=Au.prototype).ga=function(){return this.za?this.za:this.za=(Zn(void 0)?$n().then((function(){return new yt((function(t,e){var i=n.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);i.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Tt(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof ci("universalLinks.subscribe",n))throw ku("cordova-universal-links-plugin-fix is not installed");if(void 0===ci("BuildInfo.packageName",n))throw ku("cordova-plugin-buildinfo is not installed");if("function"!=typeof ci("cordova.plugins.browsertab.openUrl",n))throw ku("cordova-plugin-browsertab is not installed");if("function"!=typeof ci("cordova.InAppBrowser.open",n))throw ku("cordova-plugin-inappbrowser is not installed")}),(function(){throw new Hi("cordova-not-ready")}))},t.Ea=function(t,e){return e(new Hi("operation-not-supported-in-this-environment")),Ct()},t.Db=function(){return Tt(new Hi("operation-not-supported-in-this-environment"))},t.Qb=function(){return!1},t.Mb=function(){return!0},t.Hb=function(){return!0},t.Ca=function(t,e,i){if(this.c)return Tt(new Hi("redirect-operation-pending"));var r=this,o=n.document,a=null,s=null,u=null,h=null;return this.c=Ct().then((function(){return ro(e),Ou(r)})).then((function(){return function(t,e,i,r){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new oo(e,r,null,o,new Hi("no-auth-event")),s=ci("BuildInfo.packageName",n);if("string"!=typeof s)throw new Hi("invalid-cordova-configuration");var u=ci("BuildInfo.displayName",n),h={};if(hi().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=s;else{if(!hi().toLowerCase().match(/android/))return Tt(new Hi("operation-not-supported-in-this-environment"));h.apn=s}u&&(h.appDisplayName=u),o=Pu(o),h.sessionId=o;var c=Ns(t.l,t.i,t.o,e,i,null,r,t.m,h,t.u);return t.ga().then((function(){var e=t.h;return t.v.a.set(vu,a.w(),e)})).then((function(){var e=ci("cordova.plugins.browsertab.isAvailable",n);if("function"!=typeof e)throw new Hi("invalid-cordova-configuration");var i=null;e((function(e){if(e){if("function"!=typeof(i=ci("cordova.plugins.browsertab.openUrl",n)))throw new Hi("invalid-cordova-configuration");i(c)}else{if("function"!=typeof(i=ci("cordova.InAppBrowser.open",n)))throw new Hi("invalid-cordova-configuration");e=hi(),t.a=i(c,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(r,t,e,i)})).then((function(){return new yt((function(t,e){s=function(){var e=ci("cordova.plugins.browsertab.close",n);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.wa(s),u=function(){a||(a=Me(2e3).then((function(){e(new Hi("redirect-cancelled-by-user"))})))},h=function(){Ci()&&u()},o.addEventListener("resume",u,!1),hi().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).s((function(t){return Du(r).then((function(){throw t}))}))})).ia((function(){u&&o.removeEventListener("resume",u,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),s&&r.Ka(s),r.c=null}))},t.wa=function(t){this.b.push(t),Ou(this).s((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new oo("unknown",null,null,null,new Hi("no-auth-event")),t(e))}))},t.Ka=function(t){j(this.b,(function(e){return e==t}))};var Lu={name:"pendingRedirect",B:"session"};function Fu(t){return lu(t.b,Lu,t.a)}function Mu(t,e,n){this.i={},this.u=0,this.A=t,this.l=e,this.m=n,this.h=[],this.f=!1,this.o=_(this.cb,this),this.b=new Gu,this.v=new Ju,this.g=new xu(this.l+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.v,this.c.linkViaPopup=this.v,this.c.reauthViaPopup=this.v,this.a=Uu(this.A,this.l,this.m,cr)}function Uu(t,e,n,r){var o=i.a.SDK_VERSION||null;return Zn()?new Au(t,e,n,o,r):new Cs(t,e,n,o,r)}function ju(t){t.f||(t.f=!0,t.a.wa(t.o));var e=t.a;return t.a.ga().s((function(n){throw t.a==e&&t.reset(),n}))}function Wu(t){t.a.Mb()&&ju(t).s((function(e){var n=new oo("unknown",null,null,null,new Hi("operation-not-supported-in-this-environment"));Bu(e)&&t.cb(n)})),t.a.Hb()||Yu(t.b)}(t=Mu.prototype).reset=function(){this.f=!1,this.a.Ka(this.o),this.a=Uu(this.A,this.l,this.m),this.i={}},t.Za=function(){this.b.Za()},t.subscribe=function(t){if(M(this.h,t)||this.h.push(t),!this.f){var e=this;(function(t){return t.b.get(Lu,t.a).then((function(t){return"pending"==t}))})(this.g).then((function(t){t?Fu(e.g).then((function(){ju(e).s((function(t){var n=new oo("unknown",null,null,null,new Hi("operation-not-supported-in-this-environment"));Bu(t)&&e.cb(n)}))})):Wu(e)})).s((function(){Wu(e)}))}},t.unsubscribe=function(t){j(this.h,(function(e){return e==t}))},t.cb=function(t){if(!t)throw new Hi("invalid-auth-event");if(6e5<=w()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.wb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,i),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=w())),e=!0;break}}return Yu(this.b),e};var Vu=new Ei(2e3,1e4),qu=new Ei(3e4,6e4);function Hu(t,e,n,i,r,o){return t.a.Db(e,n,i,(function(){t.f||(t.f=!0,t.a.wa(t.o))}),(function(){t.reset()}),r,o)}function Bu(t){return!(!t||"auth/cordova-not-ready"!=t.code)}Mu.prototype.fa=function(){return this.b.fa()},Mu.prototype.Ca=function(t,e,n){var i,r=this;return function(t){return t.b.set(Lu,"pending",t.a)}(this.g).then((function(){return r.a.Ca(t,e,n).s((function(t){if(Bu(t))throw new Hi("operation-not-supported-in-this-environment");return i=t,Fu(r.g).then((function(){throw i}))})).then((function(){return r.a.Qb()?new yt((function(){})):Fu(r.g).then((function(){return r.fa()})).then((function(){})).s((function(){}))}))}))},Mu.prototype.Ea=function(t,e,n,i){return this.a.Ea(n,(function(n){t.ha(e,null,n,i)}),Vu.get())};var Qu={};function Ku(t,e,n){var i=e+":"+n;return Qu[i]||(Qu[i]=new Mu(t,e,n)),Qu[i]}function Gu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Yu(t){t.g||(t.g=!0,Xu(t,!1,null,null))}function zu(t,e){if(t.b=function(){return Ct(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Xu(t,e,n,i){e?i?function(t,e){if(t.b=function(){return Tt(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):zu(t,n):zu(t,{user:null}),t.f=[],t.c=[]}function Ju(){}function $u(){this.tb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.tb},set:function(t){this.tb=t},enumerable:!1})}function Zu(t,e){this.a=e,Pi(this,"verificationId",t)}function th(t,e,n,i){return new eo(t).Va(e,n).then((function(t){return new Zu(t,i)}))}function eh(t){var e=hr(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Hi("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ri(this,{token:t,expirationTime:Ti(1e3*e.exp),authTime:Ti(1e3*e.auth_time),issuedAtTime:Ti(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function nh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function ih(t){this.f=t,this.b=this.a=null,this.c=0}function rh(t,e){var n=e[ga],i=e.refreshToken;e=oh(e.expiresIn),t.b=n,t.c=e,t.a=i}function oh(t){return w()+1e3*parseInt(t,10)}function ah(t,e){return function(t,e){return new yt((function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?Ta(t,t.i+"?key="+encodeURIComponent(t.b),(function(t){t?t.error?i(ds(t)):t.access_token&&t.refresh_token?n(t):i(new Hi("internal-error")):i(new Hi("network-request-failed"))}),"POST",hn(e).toString(),t.f,t.o.get()):i(new Hi("internal-error"))}))}(t.f,e).then((function(e){return t.b=e.access_token,t.c=oh(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}})).s((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function sh(t,e){this.a=t||null,this.b=e||null,Ri(this,{lastSignInTime:Ti(e||null),creationTime:Ti(t||null)})}function uh(t,e,n,i,r,o){Ri(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})}function hh(t,e){for(var n in ue.call(this,t),e)this[n]=e[n]}function ch(t,e,n){this.G=[],this.l=t.apiKey,this.m=t.appName,this.u=t.authDomain||null,t=i.a.SDK_VERSION?ui(i.a.SDK_VERSION):null,this.b=new va(this.l,pr(cr),t),this.h=new ih(this.b),gh(this,e[ga]),rh(this.h,e),Pi(this,"refreshToken",this.h.a),bh(this,n||{}),Oe.call(this),this.I=!1,this.u&&pi()&&(this.a=Ku(this.u,this.l,this.m)),this.N=[],this.i=null,this.A=function(t){return new nh((function(){return t.F(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.h.c-w()-3e5;return 0<e?e:0}))}(this),this.V=_(this.Ha,this);var r=this;this.ka=null,this.ta=function(t){r.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){ph(r,t.c)},this.W=null}function lh(t,e){t.X&&Ce(t.X,"languageCodeChanged",t.ta),(t.X=e)&&be(e,"languageCodeChanged",t.ta)}function ph(t,e){t.O=e,Ca(t.b,i.a.SDK_VERSION?ui(i.a.SDK_VERSION,t.O):null)}function fh(t,e){t.W&&Ce(t.W,"frameworkChanged",t.sa),(t.W=e)&&be(e,"frameworkChanged",t.sa)}function dh(t){try{return i.a.app(t.m).auth()}catch(e){throw new Hi("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function vh(t){t.D||t.A.b||(t.A.start(),Ce(t,"tokenChanged",t.V),be(t,"tokenChanged",t.V))}function yh(t){Ce(t,"tokenChanged",t.V),t.A.stop()}function gh(t,e){t.ra=e,Pi(t,"_lat",e)}function mh(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return St(e).then((function(){return t}))}function _h(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function bh(t,e){Ri(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new sh(e.createdAt,e.lastLoginAt),providerData:[]})}function wh(){}function Eh(t){return Ct().then((function(){if(t.D)throw new Hi("app-deleted")}))}function Ch(t){return L(t.providerData,(function(t){return t.providerId}))}function Th(t,e){e&&(Ih(t,e.providerId),t.providerData.push(e))}function Ih(t,e){j(t.providerData,(function(t){return t.providerId==e}))}function Sh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Pi(t,e,n)}function Nh(t,e){t!=e&&(Ri(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Pi(t,"metadata",function(t){return new sh(t.a,t.b)}(e.metadata)):Pi(t,"metadata",new sh),x(e.providerData,(function(e){Th(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),Pi(t,"refreshToken",t.h.a))}function Ah(t){return t.F().then((function(e){var n=t.isAnonymous;return function(t,e){return ps(t.b,Ga,{idToken:e}).then(_(t.zc,t))}(t,e).then((function(){return n||Sh(t,"isAnonymous",!1),e}))}))}function kh(t,e){e[ga]&&t.ra!=e[ga]&&(rh(t.h,e),t.dispatchEvent(new hh("tokenChanged")),gh(t,e[ga]),Sh(t,"refreshToken",t.h.a))}function Ph(t,e){return Ah(t).then((function(){if(M(Ch(t),e))return mh(t).then((function(){throw new Hi("provider-already-linked")}))}))}function Rh(t,e,n){return Oi({user:t,credential:io(e),additionalUserInfo:e=gr(e),operationType:n})}function Oh(t,e){return kh(t,e),t.reload().then((function(){return t}))}function Dh(t,e,n,r,o){if(!pi())return Tt(new Hi("operation-not-supported-in-this-environment"));if(t.i&&!o)return Tt(t.i);var a=yr(n.providerId),s=_i(t.uid+":::"),u=null;(!vi()||ti())&&t.u&&n.isOAuthProvider&&(u=Ns(t.u,t.l,t.m,e,n,null,s,i.a.SDK_VERSION||null));var h=zn(u,a&&a.Ba,a&&a.Aa);return r=r().then((function(){if(Lh(t),!o)return t.F().then((function(){}))})).then((function(){return Hu(t.a,h,e,n,s,!!u)})).then((function(){return new yt((function(n,i){t.ha(e,null,new Hi("cancelled-popup-request"),t.g||null),t.f=n,t.v=i,t.g=s,t.c=t.a.Ea(t,e,h,s)}))})).then((function(t){return h&&Yn(h),t?Oi(t):null})).s((function(t){throw h&&Yn(h),t})),Fh(t,r,o)}function xh(t,e,n,i,r){if(!pi())return Tt(new Hi("operation-not-supported-in-this-environment"));if(t.i&&!r)return Tt(t.i);var o=null,a=_i(t.uid+":::");return i=i().then((function(){if(Lh(t),!r)return t.F().then((function(){}))})).then((function(){return t.aa=a,mh(t)})).then((function(e){return t.ba&&(e=(e=t.ba).b.set(jh,t.w(),e.a)),e})).then((function(){return t.a.Ca(e,n,a)})).s((function(e){if(o=e,t.ba)return Wh(t.ba);throw o})).then((function(){if(o)throw o})),Fh(t,i,r)}function Lh(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Hi("internal-error");throw new Hi("auth-domain-config-required")}}function Fh(t,e,n){var i=function(t,e,n){return t.i&&!n?(e.cancel(),Tt(t.i)):e.s((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new hh("userInvalidated")),t.i=e),e}))}(t,e,n);return t.G.push(i),i.ia((function(){U(t.G,i)})),i}function Mh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[ga]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-w())/1e3;var i=new ch(e,n,t);return t.providerData&&x(t.providerData,(function(t){t&&Th(i,Oi(t))})),t.redirectEventId&&(i.aa=t.redirectEventId),i}function Uh(t){this.a=t,this.b=uu()}Gu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Gu.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,i=t.b,r=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!r&&!o),"unknown"!=n||r||o?t.a?(Xu(this,!0,null,t.a),Ct()):e.xa(n,i)?function(t,e,n){n=n.xa(e.c,e.b);var i=e.g,r=e.f,o=e.h,a=!!e.c.match(/Redirect$/);n(i,r,o).then((function(e){Xu(t,a,e,null)})).s((function(e){Xu(t,a,null,e)}))}(this,t,e):Tt(new Hi("invalid-auth-event")):(Xu(this,!1,null,null),Ct())}else Tt(new Hi("invalid-auth-event"))},Gu.prototype.Za=function(){this.g&&!this.i&&Xu(this,!1,null,null)},Gu.prototype.fa=function(){var t=this;return new yt((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new Hi("timeout");t.a&&t.a.cancel(),t.a=Me(qu.get()).then((function(){t.b||(t.g=!0,Xu(t,!0,null,e))}))}(t))}))},Ju.prototype.h=function(t,e){if(t){var n=t.c,i=t.b;t.a?(e.ha(t.c,null,t.a,t.b),Ct()):e.xa(n,i)?function(t,e){var n=t.b,i=t.c;e.xa(i,n)(t.g,t.f,t.h).then((function(t){e.ha(i,t,null,n)})).s((function(t){e.ha(i,null,t,n)}))}(t,e):Tt(new Hi("invalid-auth-event"))}else Tt(new Hi("invalid-auth-event"))},Zu.prototype.confirm=function(t){return t=no(this.verificationId,t),this.a(t)},nh.prototype.start=function(){this.a=this.c,function t(e,i){e.stop(),e.b=Me(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,i)).then((function(){return function(){var t=n.document,e=null;return Ci()||!t?Ct():new yt((function(n){e=function(){Ci()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).s((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return e.h()})).then((function(){t(e,!0)})).s((function(n){e.i(n)&&t(e,!1)}))}(this,!0)},nh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ih.prototype.w=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},ih.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Tt(new Hi("user-token-expired")):t||!this.b||w()>this.c-3e4?this.a?ah(this,{grant_type:"refresh_token",refresh_token:this.a}):Ct(null):Ct({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},sh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},E(hh,ue),E(ch,Oe),ch.prototype.pa=function(t){this.ka=t,Ea(this.b,t)},ch.prototype.ea=function(){return this.ka},ch.prototype.ya=function(){return V(this.O)},ch.prototype.Ha=function(){this.A.b&&(this.A.stop(),this.A.start())},Pi(ch.prototype,"providerId","firebase"),(t=ch.prototype).reload=function(){var t=this;return Fh(this,Eh(this).then((function(){return Ah(t).then((function(){return mh(t)})).then(wh)})))},t.dc=function(t){return this.F(t).then((function(t){return new eh(t)}))},t.F=function(t){var e=this;return Fh(this,Eh(this).then((function(){return e.h.getToken(t)})).then((function(t){if(!t)throw new Hi("internal-error");return t.accessToken!=e.ra&&(gh(e,t.accessToken),e.dispatchEvent(new hh("tokenChanged"))),Sh(e,"refreshToken",t.refreshToken),t.accessToken})))},t.zc=function(t){if(!(t=t.users)||!t.length)throw new Hi("internal-error");bh(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?L(t,(function(t){return new uh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Th(this,e[n]);Sh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.hb=function(t){var e=this,n=null;return Fh(this,t.f(this.b,this.uid).then((function(t){return kh(e,t),n=Rh(e,t,"reauthenticate"),e.i=null,e.reload()})).then((function(){return n})),!0)},t.Ac=function(t){return Ai("firebase.User.prototype.reauthenticateWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential instead."),this.hb(t).then((function(){}))},t.fb=function(t){var e=this,n=null;return Fh(this,Ph(this,t.providerId).then((function(){return e.F()})).then((function(n){return t.b(e.b,n)})).then((function(t){return n=Rh(e,t,"link"),Oh(e,t)})).then((function(){return n})))},t.rc=function(t){return Ai("firebase.User.prototype.linkWithCredential is deprecated. Please use firebase.User.prototype.linkAndRetrieveDataWithCredential instead."),this.fb(t).then((function(t){return t.user}))},t.sc=function(t,e){var n=this;return Fh(this,Ph(this,"phone").then((function(){return th(dh(n),t,e,_(n.fb,n))})))},t.Bc=function(t,e){var n=this;return Fh(this,Ct().then((function(){return th(dh(n),t,e,_(n.hb,n))})),!0)},t.qb=function(t){var e=this;return Fh(this,this.F().then((function(n){return e.b.qb(n,t)})).then((function(t){return kh(e,t),e.reload()})))},t.Tc=function(t){var e=this;return Fh(this,this.F().then((function(n){return t.b(e.b,n)})).then((function(t){return kh(e,t),e.reload()})))},t.rb=function(t){var e=this;return Fh(this,this.F().then((function(n){return e.b.rb(n,t)})).then((function(t){return kh(e,t),e.reload()})))},t.sb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Eh(this);var e=this;return Fh(this,this.F().then((function(n){return e.b.sb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return kh(e,t),Sh(e,"displayName",t.displayName||null),Sh(e,"photoURL",t.photoUrl||null),x(e.providerData,(function(t){"password"===t.providerId&&(Pi(t,"displayName",e.displayName),Pi(t,"photoURL",e.photoURL))})),mh(e)})).then(wh))},t.Rc=function(t){var e=this;return Fh(this,Ah(this).then((function(n){return M(Ch(e),t)?function(t,e,n){return ps(t,Ba,{idToken:e,deleteProvider:n})}(e.b,n,[t]).then((function(t){var n={};return x(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),x(Ch(e),(function(t){n[t]||Ih(e,t)})),n[eo.PROVIDER_ID]||Pi(e,"phoneNumber",null),mh(e)})):mh(e).then((function(){throw new Hi("no-such-provider")}))})))},t.delete=function(){var t=this;return Fh(this,this.F().then((function(e){return ps(t.b,Ha,{idToken:e})})).then((function(){t.dispatchEvent(new hh("userDeleted"))}))).then((function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");lh(t,null),fh(t,null),t.G=[],t.D=!0,yh(t),Pi(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)}))},t.wb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},t.ha=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?_(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?_(this.Cb,this):"linkViaRedirect"==t&&(this.aa||null)==e?_(this.Bb,this):"reauthViaRedirect"==t&&(this.aa||null)==e?_(this.Cb,this):null},t.tc=function(t){var e=this;return Dh(this,"linkViaPopup",t,(function(){return Ph(e,t.providerId).then((function(){return mh(e)}))}),!1)},t.Cc=function(t){return Dh(this,"reauthViaPopup",t,(function(){return Ct()}),!0)},t.uc=function(t){var e=this;return xh(this,"linkViaRedirect",t,(function(){return Ph(e,t.providerId)}),!1)},t.Dc=function(t){return xh(this,"reauthViaRedirect",t,(function(){return Ct()}),!0)},t.Bb=function(t,e,n){var i=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return Fh(this,this.F().then((function(r){return Fa(i.b,{requestUri:t,postBody:n,sessionId:e,idToken:r})})).then((function(t){return r=Rh(i,t,"link"),Oh(i,t)})).then((function(){return r})))},t.Cb=function(t,e,n){var i=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return Fh(this,Ct().then((function(){return kr(Ma(i.b,{requestUri:t,sessionId:e,postBody:n}),i.uid)})).then((function(t){return r=Rh(i,t,"reauthenticate"),kh(i,t),i.i=null,i.reload()})).then((function(){return r})),!0)},t.kb=function(t){var e=this,n=null;return Fh(this,this.F().then((function(e){return n=e,void 0===t||it(t)?{}:ir(new Gi(t))})).then((function(t){return e.b.kb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.u,stsTokenManager:this.h.w(),redirectEventId:this.aa||null};return this.metadata&&ut(t,this.metadata.w()),x(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),t};var jh={name:"redirectUser",B:"session"};function Wh(t){return lu(t.b,jh,t.a)}function Vh(t){this.a=t,this.b=uu(),this.c=null,this.f=function(t){var e=Bh("local"),i=Bh("session"),r=Bh("none");return function(t,e,i){var r=cu(e,i),o=hu(t,e.B);return t.get(e,i).then((function(a){var s=null;try{s=mi(n.localStorage.getItem(r))}catch(t){}if(s&&!a)return n.localStorage.removeItem(r),t.set(e,s,i);s&&a&&"localStorage"!=o.type&&n.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(i,t.a)})).then((function(n){return n?i:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Hh,t.a).then((function(t){return t?Bh(t):e}))}))}))})).then((function(e){return t.c=e,qh(t,e.B)})).s((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Bh("local"),this.a,_(this.g,this))}function qh(t,e){var n,i=[];for(n in au)au[n]!==e&&i.push(lu(t.b,Bh(au[n]),t.a));return i.push(lu(t.b,Hh,t.a)),function(t){return new yt((function(e,n){var i=t.length,r=[];if(i)for(var o=function(t,n){i--,r[t]=n,0==i&&e(r)},a=function(t){n(t)},s=0;s<t.length;s++)It(t[s],b(o,s),a);else e(r)}))}(i)}Vh.prototype.g=function(){var t=this,e=Bh("local");Yh(this,(function(){return Ct().then((function(){return t.c&&"local"!=t.c.B?t.b.get(e,t.a):null})).then((function(n){if(n)return qh(t,"local").then((function(){t.c=e}))}))}))};var Hh={name:"persistence",B:"session"};function Bh(t){return{name:"authUser",B:t}}function Qh(t,e){return Yh(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function Kh(t){return Yh(t,(function(){return lu(t.b,t.c,t.a)}))}function Gh(t,e){return Yh(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),Mh(t||{})}))}))}function Yh(t,e){return t.f=t.f.then(e,e),t.f}function zh(t){if(this.l=!1,Pi(this,"settings",new $u),Pi(this,"app",t),!nc(this).options||!nc(this).options.apiKey)throw new Hi("invalid-api-key");t=i.a.SDK_VERSION?ui(i.a.SDK_VERSION):null,this.b=new va(nc(this).options&&nc(this).options.apiKey,pr(cr),t),this.N=[],this.m=[],this.I=[],this.Tb=i.a.INTERNAL.createSubscribe(_(this.oc,this)),this.O=void 0,this.Ub=i.a.INTERNAL.createSubscribe(_(this.pc,this)),tc(this,null),this.h=new Vh(nc(this).options.apiKey+":"+nc(this).name),this.A=new Uh(nc(this).options.apiKey+":"+nc(this).name),this.V=ac(this,function(t){var e=nc(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(jh,t.a).then((function(t){return t&&e&&(t.authDomain=e),Mh(t||{})}))}(t.A,nc(t).options.authDomain).then((function(e){return(t.D=e)&&(e.ba=t.A),Wh(t.A)}));return ac(t,e)}(t).then((function(){return Gh(t.h,e)})).then((function(e){return e?(e.ba=t.A,t.D&&(t.D.aa||null)==(e.aa||null)?e:e.reload().then((function(){return Qh(t.h,e).then((function(){return e}))})).s((function(n){return"auth/network-request-failed"==n.code?e:Kh(t.h)}))):null})).then((function(e){tc(t,e||null)}));return ac(t,n)}(this)),this.i=ac(this,function(t){return t.V.then((function(){return t.fa()})).s((function(){})).then((function(){if(!t.l)return t.ka()})).s((function(){})).then((function(){if(!t.l){t.X=!0;var e=t.h;e.b.addListener(Bh("local"),e.a,t.ka)}}))}(this)),this.X=!1,this.ka=_(this.Oc,this),this.Ha=_(this.Z,this),this.ra=_(this.bc,this),this.sa=_(this.mc,this),this.ta=_(this.nc,this),function(t){var e=nc(t).options.authDomain,n=nc(t).options.apiKey;e&&pi()&&(t.Sb=t.V.then((function(){if(!t.l){if(t.a=Ku(e,n,nc(t).name),t.a.subscribe(t),ic(t)&&_h(ic(t)),t.D){_h(t.D);var i=t.D;i.pa(t.ea()),lh(i,t),ph(i=t.D,t.G),fh(i,t),t.D=null}return t.a}})))}(this),this.INTERNAL={},this.INTERNAL.delete=_(this.delete,this),this.INTERNAL.logFramework=_(this.vc,this),this.u=0,Oe.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),t.W=null}(this),this.G=[]}function Xh(t){ue.call(this,"languageCodeChanged"),this.g=t}function Jh(t){ue.call(this,"frameworkChanged"),this.c=t}function $h(t){return t.Sb||Tt(new Hi("auth-domain-config-required"))}function Zh(t,e){var n={};return n.apiKey=nc(t).options.apiKey,n.authDomain=nc(t).options.authDomain,n.appName=nc(t).name,t.V.then((function(){return function(t,e,n,i){var r=new ch(t,e);return n&&(r.ba=n),i&&ph(r,i),r.reload().then((function(){return r}))}(n,e,t.A,t.ya())})).then((function(e){return ic(t)&&e.uid==ic(t).uid?(Nh(ic(t),e),t.Z(e)):(tc(t,e),_h(e),t.Z(e))})).then((function(){oc(t)}))}function tc(t,e){ic(t)&&(function(t,e){j(t.N,(function(t){return t==e}))}(ic(t),t.Ha),Ce(ic(t),"tokenChanged",t.ra),Ce(ic(t),"userDeleted",t.sa),Ce(ic(t),"userInvalidated",t.ta),yh(ic(t))),e&&(e.N.push(t.Ha),be(e,"tokenChanged",t.ra),be(e,"userDeleted",t.sa),be(e,"userInvalidated",t.ta),0<t.u&&vh(e)),Pi(t,"currentUser",e),e&&(e.pa(t.ea()),lh(e,t),ph(e,t.G),fh(e,t))}function ec(t,e){var n=null,i=null;return ac(t,e.then((function(e){return n=io(e),i=gr(e),Zh(t,e)})).then((function(){return Oi({user:ic(t),credential:n,additionalUserInfo:i,operationType:"signIn"})})))}function nc(t){return t.app}function ic(t){return t.currentUser}function rc(t){return ic(t)&&ic(t)._lat||null}function oc(t){if(t.X){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](rc(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](rc(t))}}function ac(t,e){return t.N.push(e),e.ia((function(){U(t.N,e)})),e}function sc(){}function uc(){this.a={},this.b=1e12}Vh.prototype.nb=function(t){var e=null,n=this;return function(t){var e=new Hi("invalid-persistence-type"),n=new Hi("unsupported-persistence-type");t:{for(i in au)if(au[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(ni()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!li()&&"none"!==t)throw n}}(t),Yh(this,(function(){return t!=n.c.B?n.b.get(n.c,n.a).then((function(i){return e=i,qh(n,t)})).then((function(){if(n.c=Bh(t),e)return n.b.set(n.c,e,n.a)})):Ct()}))},E(zh,Oe),E(Xh,ue),E(Jh,ue),(t=zh.prototype).nb=function(t){return ac(this,t=this.h.nb(t))},t.pa=function(t){this.W===t||this.l||(this.W=t,Ea(this.b,this.W),this.dispatchEvent(new Xh(this.ea())))},t.ea=function(){return this.W},t.Uc=function(){var t=n.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.vc=function(t){this.G.push(t),Ca(this.b,i.a.SDK_VERSION?ui(i.a.SDK_VERSION,this.G):null),this.dispatchEvent(new Jh(this.G))},t.ya=function(){return V(this.G)},t.toJSON=function(){return{apiKey:nc(this).options.apiKey,authDomain:nc(this).options.authDomain,appName:nc(this).name,currentUser:ic(this)&&ic(this).w()}},t.wb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ha=function(t,e,n,i){"signInViaPopup"==t&&this.g==i&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?_(this.ac,this):null},t.ac=function(t,e,n){var i=this;t={requestUri:t,postBody:n,sessionId:e},this.c&&(this.c.cancel(),this.c=null);var r=null,o=null,a=La(i.b,t).then((function(t){return r=io(t),o=gr(t),t}));return ac(this,t=i.V.then((function(){return a})).then((function(t){return Zh(i,t)})).then((function(){return Oi({user:ic(i),credential:r,additionalUserInfo:o,operationType:"signIn"})})))},t.Mc=function(t){if(!pi())return Tt(new Hi("operation-not-supported-in-this-environment"));var e=this,n=yr(t.providerId),r=_i(),o=null;(!vi()||ti())&&nc(this).options.authDomain&&t.isOAuthProvider&&(o=Ns(nc(this).options.authDomain,nc(this).options.apiKey,nc(this).name,"signInViaPopup",t,null,r,i.a.SDK_VERSION||null));var a=zn(o,n&&n.Ba,n&&n.Aa);return ac(this,n=$h(this).then((function(e){return Hu(e,a,"signInViaPopup",t,r,!!o)})).then((function(){return new yt((function(t,n){e.ha("signInViaPopup",null,new Hi("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.c=e.a.Ea(e,"signInViaPopup",a,r)}))})).then((function(t){return a&&Yn(a),t?Oi(t):null})).s((function(t){throw a&&Yn(a),t})))},t.Nc=function(t){if(!pi())return Tt(new Hi("operation-not-supported-in-this-environment"));var e=this;return ac(this,$h(this).then((function(){return function(t){return Yh(t,(function(){return t.b.set(Hh,t.c.B,t.a)}))}(e.h)})).then((function(){return e.a.Ca("signInViaRedirect",t)})))},t.fa=function(){if(!pi())return Tt(new Hi("operation-not-supported-in-this-environment"));var t=this;return ac(this,$h(this).then((function(){return t.a.fa()})).then((function(t){return t?Oi(t):null})))},t.Sc=function(t){if(!t)return Tt(new Hi("null-user"));var e=this,n={};n.apiKey=nc(this).options.apiKey,n.authDomain=nc(this).options.authDomain,n.appName=nc(this).name;var i=function(t,e,n,i){e=e||{apiKey:t.l,authDomain:t.u,appName:t.m};var r=t.h,o={};return o[ga]=r.b,o.refreshToken=r.a,o.expiresIn=(r.c-w())/1e3,e=new ch(e,o),n&&(e.ba=n),i&&ph(e,i),Nh(e,t),e}(t,n,e.A,e.ya());return ac(this,this.i.then((function(){if(nc(e).options.apiKey!=t.l)return i.reload()})).then((function(){return ic(e)&&t.uid==ic(e).uid?(Nh(ic(e),t),e.Z(t)):(tc(e,i),_h(i),e.Z(i))})).then((function(){oc(e)})))},t.ob=function(){var t=this;return ac(this,this.i.then((function(){return ic(t)?(tc(t,null),Kh(t.h).then((function(){oc(t)}))):Ct()})))},t.Oc=function(){var t=this;return Gh(this.h,nc(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=ic(t)&&e){n=ic(t).uid;var i=e.uid;n=null!=n&&""!==n&&null!=i&&""!==i&&n==i}if(n)return Nh(ic(t),e),ic(t).F();(ic(t)||e)&&(tc(t,e),e&&(_h(e),e.ba=t.A),t.a&&t.a.subscribe(t),oc(t))}}))},t.Z=function(t){return Qh(this.h,t)},t.bc=function(){oc(this),this.Z(ic(this))},t.mc=function(){this.ob()},t.nc=function(){this.ob()},t.oc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(ic(e))}))},t.pc=function(t){var e=this;!function(t,e){t.I.push(e),ac(t,t.i.then((function(){!t.l&&M(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(rc(t)))})))}(this,(function(){t.next(ic(e))}))},t.xc=function(t,e,n){var r=this;return this.X&&i.a.Promise.resolve().then((function(){f(t)?t(ic(r)):f(t.next)&&t.next(ic(r))})),this.Tb(t,e,n)},t.wc=function(t,e,n){var r=this;return this.X&&i.a.Promise.resolve().then((function(){r.O=r.getUid(),f(t)?t(ic(r)):f(t.next)&&t.next(ic(r))})),this.Ub(t,e,n)},t.cc=function(t){var e=this;return ac(this,this.i.then((function(){return ic(e)?ic(e).F(t).then((function(t){return{accessToken:t}})):null})))},t.Nb=function(t){var e=this;return this.i.then((function(){return ec(e,ps(e.b,ss,{token:t}))})).then((function(t){var n=t.user;return Sh(n,"isAnonymous",!1),e.Z(n),t}))},t.Gc=function(t){return Ai("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCustomToken is deprecated. Please use firebase.auth.Auth.prototype.signInWithCustomToken instead."),this.Nb(t)},t.Hc=function(t,e){return Ai("firebase.auth.Auth.prototype.signInAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.signInWithEmailAndPassword instead."),this.Ob(t,e)},t.Ob=function(t,e){var n=this;return this.i.then((function(){return ec(n,ps(n.b,us,{email:t,password:e}))}))},t.yb=function(t,e){var n=this;return this.i.then((function(){return ec(n,ps(n.b,Va,{email:t,password:e}))}))},t.Wb=function(t,e){return Ai("firebase.auth.Auth.prototype.createUserAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.createUserWithEmailAndPassword instead."),this.yb(t,e)},t.Jc=function(t){return Ai("firebase.auth.Auth.prototype.signInWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential instead."),this.Qa(t).then((function(t){return t.user}))},t.Qa=function(t){var e=this;return this.i.then((function(){return ec(e,t.la(e.b))}))},t.Ra=function(){var t=this;return this.i.then((function(){var e=ic(t);if(e&&e.isAnonymous){var n=Oi({providerId:null,isNewUser:!1});return Oi({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ec(t,t.b.Ra()).then((function(e){var n=e.user;return Sh(n,"isAnonymous",!0),t.Z(n),e}))}))},t.Ic=function(){return Ai("firebase.auth.Auth.prototype.signInAnonymouslyAndRetrieveData is deprecated. Please use firebase.auth.Auth.prototype.signInAnonymously instead."),this.Ra()},t.getUid=function(){return ic(this)&&ic(this).uid||null},t.Vb=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&ic(this)&&vh(ic(this))},t.Ec=function(t){var e=this;x(this.m,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&ic(this)&&yh(ic(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.m.push(t),ac(this,this.i.then((function(){e.l||M(e.m,t)&&t(rc(e))})))},t.removeAuthTokenListener=function(t){j(this.m,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h).b.removeListener(Bh("local"),t.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Za()),i.a.Promise.resolve()},t.Zb=function(t){return Ai("firebase.auth.Auth.prototype.fetchProvidersForEmail is deprecated. Please use firebase.auth.Auth.prototype.fetchSignInMethodsForEmail instead."),ac(this,function(t,e){return ps(t,qa,{identifier:e,continueUri:fi()?Qn():"http://localhost"}).then((function(t){return t.allProviders||[]}))}(this.b,t))},t.$b=function(t){return ac(this,function(t,e){return ps(t,qa,{identifier:e,continueUri:fi()?Qn():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.b,t))},t.qc=function(t){return!!Jr(t)},t.mb=function(t,e){var n=this;return ac(this,Ct().then((function(){var t=new Gi(e);if(!t.c)throw new Hi("argument-error",Xi+" must be true when sending sign in link to email");return ir(t)})).then((function(e){return n.b.mb(t,e)})).then((function(){})))},t.Vc=function(t){return this.Ja(t).then((function(t){return t.data.email}))},t.$a=function(t,e){return ac(this,this.b.$a(t,e).then((function(){})))},t.Ja=function(t){return ac(this,this.b.Ja(t).then((function(t){return new xi(t)})))},t.Xa=function(t){return ac(this,this.b.Xa(t).then((function(){})))},t.lb=function(t,e){var n=this;return ac(this,Ct().then((function(){return void 0===e||it(e)?{}:ir(new Gi(e))})).then((function(e){return n.b.lb(t,e)})).then((function(){})))},t.Lc=function(t,e){return ac(this,th(this,t,e,_(this.Qa,this)))},t.Kc=function(t,e){var n=this;return ac(this,Ct().then((function(){var i=Xr(t,e||Qn());return n.Qa(i)})))},sc.prototype.render=function(){},sc.prototype.reset=function(){},sc.prototype.getResponse=function(){},sc.prototype.execute=function(){};var hc=null;function cc(t,e){return(e=lc(e))&&t.a[e]||null}function lc(t){return(t=void 0===t?1e12:t)?t.toString():null}function pc(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=xn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():be(this.f,"click",this.i)}function fc(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function dc(){}uc.prototype.render=function(t,e){return this.a[this.b.toString()]=new pc(t,e),this.b++},uc.prototype.reset=function(t){var e=cc(this,t);t=lc(t),e&&t&&(e.delete(),delete this.a[t])},uc.prototype.getResponse=function(t){return(t=cc(this,t))?t.getResponse():null},uc.prototype.execute=function(t){(t=cc(this,t))&&t.execute()},pc.prototype.getResponse=function(){return fc(this),this.b},pc.prototype.execute=function(){fc(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},pc.prototype.delete=function(){fc(this),this.g=!0,clearTimeout(this.a),this.a=null,Ce(this.f,"click",this.i)},dc.prototype.g=function(){return hc||(hc=new uc),Ct(hc)},dc.prototype.c=function(){};var vc=null;function yc(){this.b=n.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var gc=new vn(mn,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),mc=new Ei(3e4,6e4);yc.prototype.g=function(t){var e=this;return new yt((function(i,r){var o=setTimeout((function(){r(new Hi("network-request-failed"))}),mc.get());!n.grecaptcha||t!==e.f&&!e.b?(n[e.a]=function(){if(n.grecaptcha){e.f=t;var a=n.grecaptcha.render;n.grecaptcha.render=function(t,n){return t=a(t,n),e.b++,t},clearTimeout(o),i(n.grecaptcha)}else clearTimeout(o),r(new Hi("internal-error"));delete n[e.a]},Ct(ua(wn(gc,{onload:e.a,hl:t||""}))).s((function(){clearTimeout(o),r(new Hi("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(o),i(n.grecaptcha))}))},yc.prototype.c=function(){this.b--};var _c=null;function bc(t,e,i,r,o,a,s){if(Pi(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.l=e,this.g=null,s?(vc||(vc=new dc),s=vc):(_c||(_c=new yc),s=_c),this.m=s,this.a=i||{theme:"light",type:"image"},this.h=[],this.a[Cc])throw new Hi("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Tc],!n.document)throw new Hi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!xn(e)||!this.i&&xn(e).hasChildNodes())throw new Hi("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new va(t,a||null,o||null),this.v=r||function(){return null};var u=this;this.o=[];var h=this.a[wc];this.a[wc]=function(t){if(Ic(u,t),"function"==typeof h)h(t);else if("string"==typeof h){var e=ci(h,n);"function"==typeof e&&e(t)}};var c=this.a[Ec];this.a[Ec]=function(){if(Ic(u,null),"function"==typeof c)c();else if("string"==typeof c){var t=ci(c,n);"function"==typeof t&&t()}}}var wc="callback",Ec="expired-callback",Cc="sitekey",Tc="size";function Ic(t,e){for(var n=0;n<t.o.length;n++)try{t.o[n](e)}catch(t){}}function Sc(t,e){return t.h.push(e),e.ia((function(){U(t.h,e)})),e}function Nc(t){if(t.D)throw new Hi("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ac(t,e,n){var r=!1;try{this.b=n||i.a.app()}catch(t){throw new Hi("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Hi("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().ya()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}a=i.a.SDK_VERSION?ui(i.a.SDK_VERSION,a):null,bc.call(this,n,t,e,(function(){try{var t=o.b.auth().ea()}catch(e){t=null}return t}),a,pr(cr),r)}function kc(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Hi("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].M(n[r])&&!o){if(e=e[r],0>r||r>=Pc.length)throw new Hi("internal-error","Argument validator received an unsupported number of arguments.");n=Pc[r],i=(i?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}i=null}}if(i)throw new Hi("argument-error",t+" failed: "+i)}(t=bc.prototype).za=function(){var t=this;return this.f?this.f:this.f=Sc(this,Ct().then((function(){if(fi()&&!ei())return $n();throw new Hi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.v())})).then((function(e){return t.g=e,ps(t.u,$a,{})})).then((function(e){t.a[Cc]=e.recaptchaSiteKey})).s((function(e){throw t.f=null,e})))},t.render=function(){Nc(this);var t=this;return Sc(this,this.za().then((function(){if(null===t.c){var e=t.l;if(!t.i){var n=xn(e);e=function(t,e,n){var i=arguments,o=document,a=String(i[0]),s=i[1];if(!dn&&s&&(s.name||s.type)){if(a=["<",a],s.name&&a.push(' name="',ct(s.name),'"'),s.type){a.push(' type="',ct(s.type),'"');var u={};ut(u,s),delete u.type,s=u}a.push(">"),a=a.join("")}return a=o.createElement(a),s&&(r(s)?a.className=s:l(s)?a.className=s.join(" "):Ln(a,s)),2<i.length&&Mn(o,a,i),a}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Nc(this);var t=this;return Sc(this,this.render().then((function(e){return new yt((function(n){var i=t.g.getResponse(e);if(i)n(i);else{var r=function(e){e&&(function(t,e){j(t.o,(function(t){return t==e}))}(t,r),n(e))};t.o.push(r),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Nc(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Nc(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=xn(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}},E(Ac,bc);var Pc="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Rc(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:r}}function Oc(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:o}}function Dc(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:d}}function xc(t,e){return{name:t||"",K:"a function",optional:!!e,M:f}}function Lc(t,e){return{name:t||"",K:"null",optional:!!e,M:c}}function Fc(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function Mc(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&r(t.type)&&f(t.verify))}}}function Uc(t,e,n,i){return{name:n||"",K:t.K+" or "+e.K,optional:!!i,M:function(n){return t.M(n)||e.M(n)}}}function jc(t,e){for(var n in e){var i=e[n].name;t[i]=qc(i,t[n],e[n].j)}}function Wc(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:b((function(t){return this[t]}),n),set:b((function(t,e,n,i){kc(t,[n],[i],!0),this[e]=i}),i,n,e[n].ub),enumerable:!0})}}function Vc(t,e,n,i){t[e]=qc(e,n,i)}function qc(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return kc(o,n,t),e.apply(this,t)}if(!n)return e;var r,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}jc(zh.prototype,{Xa:{name:"applyActionCode",j:[Rc("code")]},Ja:{name:"checkActionCode",j:[Rc("code")]},$a:{name:"confirmPasswordReset",j:[Rc("code"),Rc("newPassword")]},yb:{name:"createUserWithEmailAndPassword",j:[Rc("email"),Rc("password")]},Wb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[Rc("email"),Rc("password")]},Zb:{name:"fetchProvidersForEmail",j:[Rc("email")]},$b:{name:"fetchSignInMethodsForEmail",j:[Rc("email")]},fa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[Rc("emailLink")]},wc:{name:"onAuthStateChanged",j:[Uc(Dc(),xc(),"nextOrObserver"),xc("opt_error",!0),xc("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[Uc(Dc(),xc(),"nextOrObserver"),xc("opt_error",!0),xc("opt_completed",!0)]},lb:{name:"sendPasswordResetEmail",j:[Rc("email"),Uc(Dc("opt_actionCodeSettings",!0),Lc(null,!0),"opt_actionCodeSettings",!0)]},mb:{name:"sendSignInLinkToEmail",j:[Rc("email"),Dc("actionCodeSettings")]},nb:{name:"setPersistence",j:[Rc("persistence")]},Qa:{name:"signInAndRetrieveDataWithCredential",j:[Fc()]},Ra:{name:"signInAnonymously",j:[]},Ic:{name:"signInAnonymouslyAndRetrieveData",j:[]},Jc:{name:"signInWithCredential",j:[Fc()]},Nb:{name:"signInWithCustomToken",j:[Rc("token")]},Gc:{name:"signInAndRetrieveDataWithCustomToken",j:[Rc("token")]},Ob:{name:"signInWithEmailAndPassword",j:[Rc("email"),Rc("password")]},Kc:{name:"signInWithEmailLink",j:[Rc("email"),Rc("emailLink",!0)]},Hc:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[Rc("email"),Rc("password")]},Lc:{name:"signInWithPhoneNumber",j:[Rc("phoneNumber"),Mc()]},Mc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Nc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Sc:{name:"updateCurrentUser",j:[Uc({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof ch)}},Lc(),"user")]},ob:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Rc(null,!0)]},Uc:{name:"useDeviceLanguage",j:[]},Vc:{name:"verifyPasswordResetCode",j:[Rc("code")]}}),Wc(zh.prototype,{lc:{name:"languageCode",ub:Uc(Rc(),Lc(),"languageCode")}}),zh.Persistence=au,zh.Persistence.LOCAL="local",zh.Persistence.SESSION="session",zh.Persistence.NONE="none",jc(ch.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[Oc("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[Oc("opt_forceRefresh",!0)]},fb:{name:"linkAndRetrieveDataWithCredential",j:[Fc()]},rc:{name:"linkWithCredential",j:[Fc()]},sc:{name:"linkWithPhoneNumber",j:[Rc("phoneNumber"),Mc()]},tc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},uc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},hb:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Fc()]},Ac:{name:"reauthenticateWithCredential",j:[Fc()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[Rc("phoneNumber"),Mc()]},Cc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},kb:{name:"sendEmailVerification",j:[Uc(Dc("opt_actionCodeSettings",!0),Lc(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Rc(null,!0)]},Rc:{name:"unlink",j:[Rc("provider")]},qb:{name:"updateEmail",j:[Rc("email")]},rb:{name:"updatePassword",j:[Rc("password")]},Tc:{name:"updatePhoneNumber",j:[Fc("phone")]},sb:{name:"updateProfile",j:[Dc("profile")]}}),jc(uc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),jc(sc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),jc(yt.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Wc($u.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",ub:Oc("appVerificationDisabledForTesting")}}),jc(Zu.prototype,{confirm:{name:"confirm",j:[Rc("verificationCode")]}}),Vc(Ar,"fromJSON",(function(t){t=r(t)?JSON.parse(t):t;for(var e,n=[Lr,Yr,Zr,Or],i=0;i<n.length;i++)if(e=n[i](t))return e;return null}),[Uc(Rc(),Dc(),"json")]),Vc(zr,"credential",(function(t,e){return new Gr(t,e)}),[Rc("email"),Rc("password")]),jc(Gr.prototype,{w:{name:"toJSON",j:[Rc(null,!0)]}}),jc(jr.prototype,{ua:{name:"addScope",j:[Rc("scope")]},Da:{name:"setCustomParameters",j:[Dc("customOAuthParameters")]}}),Vc(jr,"credential",Wr,[Uc(Rc(),Dc(),"token")]),Vc(zr,"credentialWithLink",Xr,[Rc("email"),Rc("emailLink")]),jc(Vr.prototype,{ua:{name:"addScope",j:[Rc("scope")]},Da:{name:"setCustomParameters",j:[Dc("customOAuthParameters")]}}),Vc(Vr,"credential",qr,[Uc(Rc(),Dc(),"token")]),jc(Hr.prototype,{ua:{name:"addScope",j:[Rc("scope")]},Da:{name:"setCustomParameters",j:[Dc("customOAuthParameters")]}}),Vc(Hr,"credential",Br,[Uc(Rc(),Uc(Dc(),Lc()),"idToken"),Uc(Rc(),Lc(),"accessToken",!0)]),jc(Qr.prototype,{Da:{name:"setCustomParameters",j:[Dc("customOAuthParameters")]}}),Vc(Qr,"credential",Kr,[Uc(Rc(),Dc(),"token"),Rc("secret",!0)]),jc(Ur.prototype,{ua:{name:"addScope",j:[Rc("scope")]},credential:{name:"credential",j:[Uc(Rc(),Uc(Dc(),Lc()),"optionsOrIdToken"),Uc(Rc(),Lc(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[Dc("customOAuthParameters")]}}),jc(Dr.prototype,{w:{name:"toJSON",j:[Rc(null,!0)]}}),jc(Pr.prototype,{w:{name:"toJSON",j:[Rc(null,!0)]}}),Vc(eo,"credential",no,[Rc("verificationId"),Rc("verificationCode")]),jc(eo.prototype,{Va:{name:"verifyPhoneNumber",j:[Rc("phoneNumber"),Mc()]}}),jc($r.prototype,{w:{name:"toJSON",j:[Rc(null,!0)]}}),jc(Hi.prototype,{toJSON:{name:"toJSON",j:[Rc(null,!0)]}}),jc(lo.prototype,{toJSON:{name:"toJSON",j:[Rc(null,!0)]}}),jc(co.prototype,{toJSON:{name:"toJSON",j:[Rc(null,!0)]}}),jc(Ac.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===i.a||!i.a.INTERNAL||!i.a.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:zh,AuthCredential:Ar,Error:Hi};Vc(t,"EmailAuthProvider",zr,[]),Vc(t,"FacebookAuthProvider",jr,[]),Vc(t,"GithubAuthProvider",Vr,[]),Vc(t,"GoogleAuthProvider",Hr,[]),Vc(t,"TwitterAuthProvider",Qr,[]),Vc(t,"OAuthProvider",Ur,[Rc("providerId")]),Vc(t,"SAMLAuthProvider",Mr,[Rc("providerId")]),Vc(t,"PhoneAuthProvider",eo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof zh)}}]),Vc(t,"RecaptchaVerifier",Ac,[Uc(Rc(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Dc("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof i.a.app.App)}}]),i.a.INTERNAL.registerService("auth",(function(t,e){return e({INTERNAL:{getUid:_((t=new zh(t)).getUid,t),getToken:_(t.cc,t),addAuthTokenListener:_(t.Vb,t),removeAuthTokenListener:_(t.Ec,t)}}),t}),t,(function(t,e){if("create"===t)try{e.auth()}catch(t){}})),i.a.INTERNAL.extendNamespace({User:ch})}()}).apply(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(this,n(64))},1937:function(t,e,n){"use strict";(function(i){Object.defineProperty(e,"__esModule",{value:!0});var r,o,a=(r=n(1899))&&"object"==typeof r&&"default"in r?r.default:r,s=n(1),u=n(1904),h=n(1938),c=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),u.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:u.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),l=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return u.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),p=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c(e)}}catch(t){}return new l},f=p("localStorage"),d=p("sessionStorage"),v=new h.Logger("@firebase/database"),y=(o=1,function(){return o++}),g=function(t){var e=u.stringToByteArray(t),n=new u.Sha1;n.update(e);var i=n.digest();return u.base64.encodeByteArray(i)},m=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",i=0;i<t.length;i++)Array.isArray(t[i])||t[i]&&"object"==typeof t[i]&&"number"==typeof t[i].length?n+=m.apply(null,t[i]):"object"==typeof t[i]?n+=u.stringify(t[i]):n+=t[i],n+=" ";return n},_=null,b=!0,w=function(t,e){u.assert(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(v.logLevel=h.LogLevel.VERBOSE,_=v.log.bind(v),e&&d.set("logging_enabled",!0)):"function"==typeof t?_=t:(_=null,d.remove("logging_enabled"))},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===_&&!0===d.get("logging_enabled")&&w(!0)),_){var n=m.apply(null,t);_(n)}},C=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];E.apply(void 0,[t].concat(e))}},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,t);v.error(n)},I=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,t);throw v.error(n),new Error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+m.apply(void 0,t);v.warn(n)},N=function(t){return"number"==typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},A="[MIN_NAME]",k="[MAX_NAME]",P=function(t,e){if(t===e)return 0;if(t===A||e===k)return-1;if(e===A||t===k)return 1;var n=U(t),i=U(e);return null!==n?null!==i?n-i==0?t.length-e.length:n-i:-1:null!==i?1:t<e?-1:1},R=function(t,e){return t===e?0:t<e?-1:1},O=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+u.stringify(e))},D=function(t){if("object"!=typeof t||null===t)return u.stringify(t);var e=[];for(var n in t)e.push(n);e.sort();for(var i="{",r=0;r<e.length;r++)0!==r&&(i+=","),i+=u.stringify(e[r]),i+=":",i+=D(t[e[r]]);return i+="}"},x=function(t,e){var n=t.length;if(n<=e)return[t];for(var i=[],r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i},L=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;++n)e(n,t[n]);else u.forEach(t,(function(t,n){return e(n,t)}))},F=function(t){u.assert(!N(t),"Invalid JSON number");var e,n,i,r,o,a,s;for(0===t?(n=0,i=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(r=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,i=Math.round(t*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,i=Math.round(t/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse(),s=a.join("");var h="";for(o=0;o<64;o+=8){var c=parseInt(s.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),h+=c}return h.toLowerCase()},M=new RegExp("^-?\\d{1,10}$"),U=function(t){if(M.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},j=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw S("Exception was thrown by user callback.",e),t}),Math.floor(0))}},W=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},V=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],i=this.pieceNum_;i<this.pieces_.length;i++)n.push(this.pieces_[i]);if(e instanceof t)for(i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{var r=e.split("/");for(i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var i=e.getFront(),r=n.getFront();if(null===i)return n;if(i===r)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),i=e.slice(),r=0;r<n.length&&r<i.length;r++){var o=P(n[r],i[r]);if(0!==o)return o}return n.length===i.length?0:n.length<i.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),q=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=u.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=u.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=u.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),H=function(){function t(t,e,n,i,r){void 0===r&&(r=""),this.secure=e,this.namespace=n,this.webSocketOnly=i,this.persistenceKey=r,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if(u.assert("string"==typeof t,"typeof type must == string"),u.assert("object"==typeof e,"typeof params must == object"),"websocket"===t)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if("long_polling"!==t)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var i=[];return u.forEach(e,(function(t,e){i.push(t+"="+e)})),n+i.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();var B,Q,K,G,Y,z=function(t){var e=X(t),n=e.subdomain;"firebase"===e.domain&&I(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||I("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new H(e.host,e.secure,n,i),path:new V(e.pathString)}},X=function(t){var e="",n="",i="",r="",o=!0,a="https",s=443;if("string"==typeof t){var u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));var h=t.indexOf("/");-1===h&&(h=t.length);var c=t.indexOf("?");-1===c&&(c=t.length),e=t.substring(0,Math.min(h,c)),h<c&&(r=function(t){for(var e="",n=t.split("/"),i=0;i<n.length;i++)if(n[i].length>0){var r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(t){}e+="/"+r}return e}(t.substring(h,c)));var l=function(t){var e={};"?"===t.charAt(0)&&(t=t.substring(1));for(var n=0,i=t.split("&");n<i.length;n++){var r=i[n];if(0!==r.length){var o=r.split("=");2===o.length?e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):S("Invalid query segment '"+r+"' in query '"+t+"'")}}return e}(t.substring(Math.min(t.length,c)));(u=e.indexOf(":"))>=0?(o="https"===a||"wss"===a,s=parseInt(e.substring(u+1),10)):u=t.length;var p=e.split(".");3===p.length?(n=p[1],i=p[0].toLowerCase()):2===p.length?n=p[0]:"localhost"===p[0].slice(0,u).toLowerCase()&&(n="localhost"),""===i&&"ns"in l&&(i=l.ns)}return{host:e,port:s,domain:n,subdomain:i,secure:o,scheme:a,pathString:r}},J=/[\[\].#$\/\u0000-\u001F\u007F]/,$=/[\[\].#$\u0000-\u001F\u007F]/,Z=function(t){return"string"==typeof t&&0!==t.length&&!J.test(t)},tt=function(t){return"string"==typeof t&&0!==t.length&&!$.test(t)},et=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!N(t)||t&&"object"==typeof t&&u.contains(t,".sv")},nt=function(t,e,n,i,r){r&&void 0===n||it(u.errorPrefix(t,e,r),n,i)},it=function(t,e,n){var i=n instanceof V?new q(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+i.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+i.toErrorString()+" with contents = "+e.toString());if(N(e))throw new Error(t+"contains "+e.toString()+" "+i.toErrorString());if("string"==typeof e&&e.length>10485760/3&&u.stringLength(e)>10485760)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+i.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var r=!1,o=!1;if(u.forEach(e,(function(e,n){if(".value"===e)r=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!Z(e)))throw new Error(t+" contains an invalid key ("+e+") "+i.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');i.push(e),it(t,n,i),i.pop()})),r&&o)throw new Error(t+' contains ".value" child '+i.toErrorString()+" in addition to actual children.")}},rt=function(t,e,n,i,r){if(!r||void 0!==n){var o=u.errorPrefix(t,e,r);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];u.forEach(n,(function(t,e){var n=new V(t);if(it(o,e,i.child(n)),".priority"===n.getBack()&&!et(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)})),function(t,e){var n,i;for(n=0;n<e.length;n++)for(var r=(i=e[n]).slice(),o=0;o<r.length;o++)if(".priority"===r[o]&&o===r.length-1);else if(!Z(r[o]))throw new Error(t+"contains an invalid key ("+r[o]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(V.comparePaths);var a=null;for(n=0;n<e.length;n++){if(i=e[n],null!==a&&a.contains(i))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+i.toString());a=i}}(o,a)}},ot=function(t,e,n,i){if(!i||void 0!==n){if(N(n))throw new Error(u.errorPrefix(t,e,i)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!et(n))throw new Error(u.errorPrefix(t,e,i)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},at=function(t,e,n,i){if(!i||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(u.errorPrefix(t,e,i)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},st=function(t,e,n,i){if(!(i&&void 0===n||Z(n)))throw new Error(u.errorPrefix(t,e,i)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},ut=function(t,e,n,i){if(!(i&&void 0===n||tt(n)))throw new Error(u.errorPrefix(t,e,i)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ht=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ut(t,e,n,i)},ct=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},lt=function(t,e,n){var i=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!Z(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==i.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),tt(t)}(i))throw new Error(u.errorPrefix(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},pt=function(t,e,n,i){if((!i||void 0!==n)&&"boolean"!=typeof n)throw new Error(u.errorPrefix(t,e,i)+"must be a boolean.")},ft=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){u.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),u.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new u.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){u.validateArgCount("OnDisconnect.remove",0,1,arguments.length),ct("OnDisconnect.remove",this.path_),u.validateCallback("OnDisconnect.remove",1,t,!0);var e=new u.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){u.validateArgCount("OnDisconnect.set",1,2,arguments.length),ct("OnDisconnect.set",this.path_),nt("OnDisconnect.set",1,t,this.path_,!1),u.validateCallback("OnDisconnect.set",2,e,!0);var n=new u.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){u.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),ct("OnDisconnect.setWithPriority",this.path_),nt("OnDisconnect.setWithPriority",1,t,this.path_,!1),ot("OnDisconnect.setWithPriority",2,e,!1),u.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var i=new u.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,i.wrapCallback(n)),i.promise},t.prototype.update=function(t,e){if(u.validateArgCount("OnDisconnect.update",1,2,arguments.length),ct("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},i=0;i<t.length;++i)n[""+i]=t[i];t=n,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}rt("OnDisconnect.update",1,t,this.path_,!1),u.validateCallback("OnDisconnect.update",2,e,!0);var r=new u.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,r.wrapCallback(e)),r.promise},t}(),dt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return u.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),vt=(B="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Q=0,K=[],function(t){var e,n=t===Q;Q=t;var i=new Array(8);for(e=7;e>=0;e--)i[e]=B.charAt(t%64),t=Math.floor(t/64);u.assert(0===t,"Cannot push at time == 0");var r=i.join("");if(n){for(e=11;e>=0&&63===K[e];e--)K[e]=0;K[e]++}else for(e=0;e<12;e++)K[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)r+=B.charAt(K[e]);return u.assert(20===r.length,"nextPushId: Length should be 20."),r}),yt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),gt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new yt(A,t),i=new yt(A,e);return 0!==this.compare(n,i)},t.prototype.minPost=function(){return yt.MIN},t}(),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return G},set:function(t){G=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return P(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw u.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return yt.MIN},e.prototype.maxPost=function(){return new yt(k,G)},e.prototype.makePost=function(t,e){return u.assert("string"==typeof t,"KeyIndex indexValue must always be a string."),new yt(t,G)},e.prototype.toString=function(){return".key"},e}(gt),_t=new mt;var bt,wt,Et,Ct=function(t){return"number"==typeof t?"number:"+F(t):"string:"+t},Tt=function(t){if(t.isLeafNode()){var e=t.val();u.assert("string"==typeof e||"number"==typeof e||"object"==typeof e&&u.contains(e,".sv"),"Priority must be a string or number.")}else u.assert(t===Y||t.isEmpty(),"priority of unexpected type.");u.assert(t===Y||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},It=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,u.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Tt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return bt},set:function(t){bt=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var i=e.getFront();return null===i?n:n.isEmpty()&&".priority"!==i?this:(u.assert(".priority"!==i||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Ct(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?F(this.value_):this.value_,this.lazyHash_=g(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(u.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,i=typeof this.value_,r=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(i);return u.assert(r>=0,"Unknown leaf type: "+n),u.assert(o>=0,"Unknown leaf type: "+i),r===o?"object"===i?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();var St,Nt,At=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),i=e.node.getPriority(),r=n.compareTo(i);return 0===r?P(t.name,e.name):r},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return yt.MIN},e.prototype.maxPost=function(){return new yt(k,new It("[PRIORITY-POST]",Et))},e.prototype.makePost=function(t,e){var n=wt(t);return new yt(e,new It("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(gt)),kt=function(){function t(t,e,n,i,r){void 0===r&&(r=null),this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Pt=function(){function t(e,n,i,r,o){this.key=e,this.value=n,this.color=null!=i?i:t.RED,this.left=null!=r?r:Ot.EMPTY_NODE,this.right=null!=o?o:Ot.EMPTY_NODE}return t.prototype.copy=function(e,n,i,r,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=i?i:this.color,null!=r?r:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var i,r;return(r=(i=n(t,(r=this).key))<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Ot.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,i;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Ot.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Rt=function(){function t(){}return t.prototype.copy=function(t,e,n,i,r){return this},t.prototype.insert=function(t,e,n){return new Pt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Ot=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Pt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Pt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,i=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new kt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new kt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new kt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new kt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Rt,t}(),Dt=Math.log(2),xt=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Dt,10)),this.current_=this.count-1;var n,i=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&i}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Lt=function(t,e,n,i){t.sort(e);var r=function(e,i){var o,a,s=i-e;if(0==s)return null;if(1==s)return o=t[e],a=n?n(o):o,new Pt(a,o.node,Pt.BLACK,null,null);var u=parseInt(s/2,10)+e,h=r(e,u),c=r(u+1,i);return o=t[u],a=n?n(o):o,new Pt(a,o.node,Pt.BLACK,h,c)},o=function(e){for(var i=null,o=null,a=t.length,s=function(e,i){var o=a-e,s=a;a-=e;var h=r(o+1,s),c=t[o],l=n?n(c):c;u(new Pt(l,c.node,i,null,h))},u=function(t){i?(i.left=t,i=t):(o=t,i=t)},h=0;h<e.count;++h){var c=e.nextBitIsOne(),l=Math.pow(2,e.count-(h+1));c?s(l,Pt.BLACK):(s(l,Pt.BLACK),s(l,Pt.RED))}return o}(new xt(t.length));return new Ot(i||e,o)},Ft={},Mt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return u.assert(Ft&&At,"ChildrenNode.ts has not been loaded"),St=St||new t({".priority":Ft},{".priority":At})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=u.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===Ft?null:e},t.prototype.hasIndex=function(t){return u.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){u.assert(e!==_t,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var i,r=[],o=!1,a=n.getIterator(yt.Wrap),s=a.getNext();s;)o=o||e.isDefinedOn(s.node),r.push(s),s=a.getNext();i=o?Lt(r,e.getCompare()):Ft;var h=e.toString(),c=u.clone(this.indexSet_);c[h]=e;var l=u.clone(this.indexes_);return l[h]=i,new t(l,c)},t.prototype.addToIndexes=function(e,n){var i=this;return new t(u.map(this.indexes_,(function(t,r){var o=u.safeGet(i.indexSet_,r);if(u.assert(o,"Missing index implementation for "+r),t===Ft){if(o.isDefinedOn(e.node)){for(var a=[],s=n.getIterator(yt.Wrap),h=s.getNext();h;)h.name!=e.name&&a.push(h),h=s.getNext();return a.push(e),Lt(a,o.getCompare())}return Ft}var c=n.get(e.name),l=t;return c&&(l=l.remove(new yt(e.name,c))),l.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(u.map(this.indexes_,(function(t){if(t===Ft)return t;var i=n.get(e.name);return i?t.remove(new yt(e.name,i)):t})),this.indexSet_)},t}();function Ut(t,e){return P(t.name,e.name)}function jt(t,e){return P(t,e)}var Wt=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Tt(this.priorityNode_),this.children_.isEmpty()&&u.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Nt||(Nt=new t(new Ot(jt),null,Mt.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Nt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Nt:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(u.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var i,r=new yt(e,n),o=void 0,a=void 0;return n.isEmpty()?(o=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(o=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_)),i=o.isEmpty()?Nt:this.priorityNode_,new t(o,i,a)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;u.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var i=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,i)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},i=0,r=0,o=!0;if(this.forEachChild(At,(function(a,s){n[a]=s.val(e),i++,o&&t.INTEGER_REGEXP_.test(a)?r=Math.max(r,Number(a)):o=!1})),!e&&o&&r<2*i){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Ct(this.getPriority().val())+":"),this.forEachChild(At,(function(e,n){var i=n.hash();""!==i&&(t+=":"+e+":"+i)})),this.lazyHash_=""===t?"":g(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var i=this.resolveIndex_(n);if(i){var r=i.getPredecessorKey(new yt(t,e));return r?r.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new yt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new yt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var i=this.children_.getIteratorFrom(t.name,yt.Wrap),r=i.peek();null!=r&&e.compare(r,t)<0;)i.getNext(),r=i.peek();return i},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var i=this.children_.getReverseIteratorFrom(t.name,yt.Wrap),r=i.peek();null!=r&&e.compare(r,t)>0;)i.getNext(),r=i.peek();return i},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Vt?-1:0},t.prototype.withIndex=function(e){if(e===_t||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===_t||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(At),i=e.getIterator(At),r=n.getNext(),o=i.getNext();r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=n.getNext(),o=i.getNext()}return null===r&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===_t?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Vt=new(function(t){function e(){return t.call(this,new Ot(jt),Wt.EMPTY_NODE,Mt.Default)||this}return s.__extends(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Wt.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Wt));Object.defineProperties(yt,{MIN:{value:new yt(A,Wt.EMPTY_NODE)},MAX:{value:new yt(k,Vt)}}),mt.__EMPTY_NODE=Wt.EMPTY_NODE,It.__childrenNodeConstructor=Wt,Y=Vt,function(t){Et=t}(Vt);function qt(t,e){if(void 0===e&&(e=null),null===t)return Wt.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),u.assert(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new It(t,qt(e));if(t instanceof Array){var n=Wt.EMPTY_NODE,i=t;return u.forEach(i,(function(t,e){if(u.contains(i,t)&&"."!==t.substring(0,1)){var r=qt(e);!r.isLeafNode()&&r.isEmpty()||(n=n.updateImmediateChild(t,r))}})),n.updatePriority(qt(e))}var r=[],o=!1,a=t;if(u.forEach(a,(function(t,e){if("string"!=typeof t||"."!==t.substring(0,1)){var n=qt(a[t]);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),r.push(new yt(t,n)))}})),0==r.length)return Wt.EMPTY_NODE;var s=Lt(r,Ut,(function(t){return t.name}),jt);if(o){var h=Lt(r,At.getCompare());return new Wt(s,qt(e),new Mt({".priority":h},{".priority":At}))}return new Wt(s,qt(e),Mt.Default)}!function(t){wt=t}(qt);var Ht,Bt,Qt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?P(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return yt.MIN},e.prototype.maxPost=function(){return yt.MAX},e.prototype.makePost=function(t,e){var n=qt(t);return new yt(e,n)},e.prototype.toString=function(){return".value"},e}(gt)),Kt=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,u.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return s.__extends(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),i=this.extractChild(e.node),r=n.compareTo(i);return 0===r?P(t.name,e.name):r},e.prototype.makePost=function(t,e){var n=qt(t),i=Wt.EMPTY_NODE.updateChild(this.indexPath_,n);return new yt(e,i)},e.prototype.maxPost=function(){var t=Wt.EMPTY_NODE.updateChild(this.indexPath_,Vt);return new yt(k,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(gt),Gt=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return u.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return u.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return u.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return u.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){u.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),ut("DataSnapshot.child",1,e,!1);var n=new V(e),i=this.ref_.child(n);return new t(this.node_.getChild(n),i,At)},t.prototype.hasChild=function(t){u.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),ut("DataSnapshot.hasChild",1,t,!1);var e=new V(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return u.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if(u.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),u.validateCallback("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var i=this.node_;return!!i.forEachChild(this.index_,(function(i,r){return e(new t(r,n.ref_.child(i),At))}))},t.prototype.hasChildren=function(){return u.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return u.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return u.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),Yt=function(){function t(t,e,n,i){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=i}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+u.stringify(this.snapshot.exportVal())},t}(),zt=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Xt=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Yt("value",this,new Gt(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){u.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var i=this.callback_;return function(){i.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new zt(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),Jt=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,u.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new zt(this,t,e):null},t.prototype.createEvent=function(t,e){u.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),i=e.getQueryParams().getIndex();return new Yt(t.type,this,new Gt(t.snapshotNode,n,i),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){u.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var i=this.callbacks_[t.eventType];return function(){i.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=u.getCount(e.callbacks_);if(n===u.getCount(this.callbacks_)){if(1===n){var i=u.getAnyKey(e.callbacks_),r=u.getAnyKey(this.callbacks_);return!(r!==i||e.callbacks_[i]&&this.callbacks_[r]&&e.callbacks_[i]!==this.callbacks_[r])}return u.every(this.callbacks_,(function(t,n){return e.callbacks_[t]===n}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),$t=function(){function t(t,e,n,i){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=i}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return u.assert(Ht,"Reference.ts has not been loaded"),Ht},set:function(t){Ht=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===_t){var i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=A)throw new Error(i);if("string"!=typeof e)throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!=k)throw new Error(i);if("string"!=typeof n)throw new Error(r)}}else if(t.getIndex()===At){if(null!=e&&!et(e)||null!=n&&!et(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(u.assert(t.getIndex()instanceof Kt||t.getIndex()===Qt,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return u.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,i,r){u.validateArgCount("Query.on",2,4,arguments.length),at("Query.on",1,e,!1),u.validateCallback("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",i,r);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var i=new Xt(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,i)},t.prototype.onChildEvent=function(t,e,n){var i=new Jt(t,e,n);this.repo.addEventCallbackForQuery(this,i)},t.prototype.off=function(t,e,n){u.validateArgCount("Query.off",0,3,arguments.length),at("Query.off",1,t,!0),u.validateCallback("Query.off",2,e,!0),u.validateContextObject("Query.off",3,n,!0);var i=null,r=null;if("value"===t){var o=e||null;i=new Xt(o,null,n||null)}else t&&(e&&((r={})[t]=e),i=new Jt(r,null,n||null));this.repo.removeEventCallbackForQuery(this,i)},t.prototype.once=function(e,n,i,r){var o=this;u.validateArgCount("Query.once",1,4,arguments.length),at("Query.once",1,e,!1),u.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",i,r),s=!0,h=new u.Deferred;h.promise.catch((function(){}));var c=function(t){s&&(s=!1,o.off(e,c),n&&n.bind(a.context)(t),h.resolve(t))};return this.on(e,c,(function(t){o.off(e,c),a.cancel&&a.cancel.bind(a.context)(t),h.reject(t)})),h.promise},t.prototype.limitToFirst=function(e){if(u.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(u.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(u.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');ut("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new V(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var i=new Kt(n),r=this.queryParams_.orderBy(i);return t.validateQueryEndpoints_(r),new t(this.repo,this.path,r,!0)},t.prototype.orderByKey=function(){u.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(_t);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){u.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(At);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){u.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Qt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),u.validateArgCount("Query.startAt",0,2,arguments.length),nt("Query.startAt",1,e,this.path,!0),st("Query.startAt",2,n,!0);var i=this.queryParams_.startAt(e,n);if(t.validateLimit_(i),t.validateQueryEndpoints_(i),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,i,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),u.validateArgCount("Query.endAt",0,2,arguments.length),nt("Query.endAt",1,e,this.path,!0),st("Query.endAt",2,n,!0);var i=this.queryParams_.endAt(e,n);if(t.validateLimit_(i),t.validateQueryEndpoints_(i),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,i,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(u.validateArgCount("Query.equalTo",1,2,arguments.length),nt("Query.equalTo",1,t,this.path,!1),st("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return u.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return u.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=D(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(u.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var i=this.repo===e.repo,r=this.path.equals(e.path),o=this.queryIdentifier()===e.queryIdentifier();return i&&r&&o},t.getCancelAndContextArgs_=function(t,e,n){var i={cancel:null,context:null};if(e&&n)i.cancel=e,u.validateCallback(t,3,i.cancel,!0),i.context=n,u.validateContextObject(t,4,i.context,!0);else if(e)if("object"==typeof e&&null!==e)i.context=e;else{if("function"!=typeof e)throw new Error(u.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");i.cancel=e}return i},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),Zt=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return u.contains(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return u.isEmpty(this.set)},t.prototype.count=function(){return u.getCount(this.set)},t.prototype.each=function(t){u.forEach(this.set,(function(e,n){return t(e,n)}))},t.prototype.keys=function(){var t=[];return u.forEach(this.set,(function(e){t.push(e)})),t},t}(),te=function(){function t(){this.value_=null,this.children_=null}return t.prototype.find=function(t){if(null!=this.value_)return this.value_.getChild(t);if(t.isEmpty()||null==this.children_)return null;var e=t.getFront();return t=t.popFront(),this.children_.contains(e)?this.children_.get(e).find(t):null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,n);else{null==this.children_&&(this.children_=new Zt);var i=e.getFront();this.children_.contains(i)||this.children_.add(i,new t);var r=this.children_.get(i);e=e.popFront(),r.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(At,(function(t,e){n.remember(new V(t),e)})),this.forget(t)}if(null!==this.children_){var i=t.getFront();if(t=t.popFront(),this.children_.contains(i))this.children_.get(i).forget(t)&&this.children_.remove(i);return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},t.prototype.forEachTree=function(t,e){null!==this.value_?e(t,this.value_):this.forEachChild((function(n,i){var r=new V(t.toString()+"/"+n);i.forEachTree(r,e)}))},t.prototype.forEachChild=function(t){null!==this.children_&&this.children_.each((function(e,n){t(e,n)}))},t}(),ee=function(t,e){return t&&"object"==typeof t?(u.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},ne=function(t,e){var n,i=t.getPriority().val(),r=ee(i,e);if(t.isLeafNode()){var o=t,a=ee(o.getValue(),e);return a!==o.getValue()||r!==o.getPriority().val()?new It(a,qt(r)):t}var s=t;return n=s,r!==s.getPriority().val()&&(n=n.updatePriority(new It(r))),s.forEachChild(At,(function(t,i){var r=ne(i,e);r!==i&&(n=n.updateImmediateChild(t,r))})),n};!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Bt||(Bt={}));var ie,re,oe=function(){function t(t,e,n,i){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=i,u.assert(!i||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),ae=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Bt.ACK_USER_WRITE,this.source=oe.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return u.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new V(e));return new t(V.Empty,n,this.revert)}return u.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),se=function(){function t(t,e){void 0===e&&(ie||(ie=new Ot(R)),e=ie),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return u.forEach(e,(function(t,e){n=n.set(new V(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:V.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),i=this.children.get(n);if(null!==i){var r=i.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=r?{path:new V(n).child(r.path),value:r.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),i=this.children.get(n);return null!==i?i.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var i=e.getFront(),r=(this.children.get(i)||t.Empty).set(e.popFront(),n),o=this.children.insert(i,r);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),i=this.children.get(n);if(i){var r=i.remove(e.popFront()),o=void 0;return o=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var i=e.getFront(),r=(this.children.get(i)||t.Empty).setTree(e.popFront(),n),o=void 0;return o=r.isEmpty()?this.children.remove(i):this.children.insert(i,r),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(V.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(i,r){n[i]=r.fold_(t.child(i),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,V.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var i=!!this.value&&n(e,this.value);if(i)return i;if(t.isEmpty())return null;var r=t.getFront(),o=this.children.get(r);return o?o.findOnPath_(t.popFront(),e.child(r),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,V.Empty,e)},t.prototype.foreachOnPath_=function(e,n,i){if(e.isEmpty())return this;this.value&&i(n,this.value);var r=e.getFront(),o=this.children.get(r);return o?o.foreachOnPath_(e.popFront(),n.child(r),i):t.Empty},t.prototype.foreach=function(t){this.foreach_(V.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,i){i.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t.Empty=new t(null),t}(),ue=function(){function t(t,e){this.source=t,this.path=e,this.type=Bt.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,V.Empty):new t(this.source,this.path.popFront())},t}(),he=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Bt.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,V.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),ce=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Bt.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new V(e));return n.isEmpty()?null:n.value?new he(this.source,V.Empty,n.value):new t(this.source,V.Empty,n)}return u.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),le=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),pe=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,i){return new t(new le(e,n,i),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,i){return new t(this.eventCache_,new le(e,n,i))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new le(Wt.EMPTY_NODE,!1,!1),new le(Wt.EMPTY_NODE,!1,!1)),t}(),fe=function(){function t(t,e,n,i,r){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=i,this.prevName=r}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,i){return new t(t.CHILD_CHANGED,n,e,i)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),de=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,i,r,o){u.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(i).equals(n.getChild(i))&&a.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(fe.childRemovedChange(e,a)):u.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(fe.childAddedChange(e,n)):o.trackChildChange(fe.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(At,(function(t,i){e.hasChild(t)||n.trackChildChange(fe.childRemovedChange(t,i))})),e.isLeafNode()||e.forEachChild(At,(function(e,i){if(t.hasChild(e)){var r=t.getImmediateChild(e);r.equals(i)||n.trackChildChange(fe.childChangedChange(e,i,r))}else n.trackChildChange(fe.childAddedChange(e,i))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Wt.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),ve=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;u.assert(e==fe.CHILD_ADDED||e==fe.CHILD_CHANGED||e==fe.CHILD_REMOVED,"Only child changes supported for tracking"),u.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var i=u.safeGet(this.changeMap_,n);if(i){var r=i.type;if(e==fe.CHILD_ADDED&&r==fe.CHILD_REMOVED)this.changeMap_[n]=fe.childChangedChange(n,t.snapshotNode,i.snapshotNode);else if(e==fe.CHILD_REMOVED&&r==fe.CHILD_ADDED)delete this.changeMap_[n];else if(e==fe.CHILD_REMOVED&&r==fe.CHILD_CHANGED)this.changeMap_[n]=fe.childRemovedChange(n,i.oldSnap);else if(e==fe.CHILD_CHANGED&&r==fe.CHILD_ADDED)this.changeMap_[n]=fe.childAddedChange(n,t.snapshotNode);else{if(e!=fe.CHILD_CHANGED||r!=fe.CHILD_CHANGED)throw u.assertionError("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap_[n]=fe.childChangedChange(n,t.snapshotNode,i.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return u.getValues(this.changeMap_)},t}(),ye=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),ge=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new le(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),r=this.writes_.calcIndexedSlice(i,e,1,n,t);return 0===r.length?null:r[0]},t}(),me=function(t,e){this.viewCache=t,this.changes=e},_e=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){u.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),u.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,i,r){var o,a,s=new ve;if(n.type===Bt.OVERWRITE){var h=n;h.source.fromUser?o=this.applyUserOverwrite_(e,h.path,h.snap,i,r,s):(u.assert(h.source.fromServer,"Unknown source."),a=h.source.tagged||e.getServerCache().isFiltered()&&!h.path.isEmpty(),o=this.applyServerOverwrite_(e,h.path,h.snap,i,r,a,s))}else if(n.type===Bt.MERGE){var c=n;c.source.fromUser?o=this.applyUserMerge_(e,c.path,c.children,i,r,s):(u.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered(),o=this.applyServerMerge_(e,c.path,c.children,i,r,a,s))}else if(n.type===Bt.ACK_USER_WRITE){var l=n;o=l.revert?this.revertUserWrite_(e,l.path,i,r,s):this.ackUserWrite_(e,l.path,l.affectedTree,i,r,s)}else{if(n.type!==Bt.LISTEN_COMPLETE)throw u.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,i,s)}var p=s.getChanges();return t.maybeAddValueEvent_(e,o,p),new me(o,p)},t.maybeAddValueEvent_=function(t,e,n){var i=e.getEventCache();if(i.isFullyInitialized()){var r=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||r&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&n.push(fe.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,i,r){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,s=void 0;if(e.isEmpty())if(u.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var h=t.getCompleteServerSnap(),c=h instanceof Wt?h:Wt.EMPTY_NODE,l=n.calcCompleteEventChildren(c);a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,r)}else{var p=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),p,r)}else{var f=e.getFront();if(".priority"==f){u.assert(1==e.getLength(),"Can't have a priority with additional path components");var d=o.getNode();s=t.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(e,d,s);a=null!=v?this.filter_.updatePriority(d,v):o.getNode()}else{var y=e.popFront(),g=void 0;if(o.isCompleteForChild(f)){s=t.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),s);g=null!=m?o.getNode().getImmediateChild(f).updateChild(y,m):o.getNode().getImmediateChild(f)}else g=n.calcCompleteChild(f,t.getServerCache());a=null!=g?this.filter_.updateChild(o.getNode(),f,g,y,i,r):o.getNode()}}return t.updateEventSnap(a,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,i,r,o,a){var s,u=t.getServerCache(),h=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=h.updateFullNode(u.getNode(),n,null);else if(h.filtersNodes()&&!u.isFiltered()){var c=u.getNode().updateChild(e,n);s=h.updateFullNode(u.getNode(),c,null)}else{var l=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var p=e.popFront(),f=u.getNode().getImmediateChild(l).updateChild(p,n);s=".priority"==l?h.updatePriority(u.getNode(),f):h.updateChild(u.getNode(),l,f,p,ye,null)}var d=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),h.filtersNodes()),v=new ge(i,d,r);return this.generateEventCacheAfterServerEvent_(d,e,i,v,a)},t.prototype.applyUserOverwrite_=function(t,e,n,i,r,o){var a,s,u=t.getEventCache(),h=new ge(i,t,r);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var c=e.getFront();if(".priority"===c)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var l=e.popFront(),p=u.getNode().getImmediateChild(c),f=void 0;if(l.isEmpty())f=n;else{var d=h.getCompleteChild(c);f=null!=d?".priority"===l.getBack()&&d.getChild(l.parent()).isEmpty()?d:d.updateChild(l,n):Wt.EMPTY_NODE}if(p.equals(f))a=t;else{var v=this.filter_.updateChild(u.getNode(),c,f,l,h,o);a=t.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,i,r,o,a){var s=this,u=e;return i.foreach((function(i,h){var c=n.child(i);t.cacheHasChild_(e,c.getFront())&&(u=s.applyUserOverwrite_(u,c,h,r,o,a))})),i.foreach((function(i,h){var c=n.child(i);t.cacheHasChild_(e,c.getFront())||(u=s.applyUserOverwrite_(u,c,h,r,o,a))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,i,r,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,h=t;u=e.isEmpty()?n:se.Empty.setTree(e,n);var c=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(c.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),l=s.applyMerge_(u,n);h=s.applyServerOverwrite_(h,new V(e),l,i,r,o,a)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!c.hasChild(e)&&!u){var l=t.getServerCache().getNode().getImmediateChild(e),p=s.applyMerge_(l,n);h=s.applyServerOverwrite_(h,new V(e),p,i,r,o,a)}})),h},t.prototype.ackUserWrite_=function(t,e,n,i,r,o){if(null!=i.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),i,r,a,o);if(e.isEmpty()){var u=se.Empty;return s.getNode().forEachChild(_t,(function(t,e){u=u.set(new V(t),e)})),this.applyServerMerge_(t,e,u,i,r,a,o)}return t}var h=se.Empty;return n.foreach((function(t,n){var i=e.child(t);s.isCompleteForPath(i)&&(h=h.set(t,s.getNode().getChild(i)))})),this.applyServerMerge_(t,e,h,i,r,a,o)},t.prototype.listenComplete_=function(t,e,n,i){var r=t.getServerCache(),o=t.updateServerSnap(r.getNode(),r.isFullyInitialized()||e.isEmpty(),r.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,ye,i)},t.prototype.revertUserWrite_=function(t,e,n,i,r){var o;if(null!=n.shadowingWrite(e))return t;var a=new ge(n,t,i),s=t.getEventCache().getNode(),h=void 0;if(e.isEmpty()||".priority"===e.getFront()){var c=void 0;if(t.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var l=t.getServerCache().getNode();u.assert(l instanceof Wt,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(l)}c=c,h=this.filter_.updateFullNode(s,c,r)}else{var p=e.getFront(),f=n.calcCompleteChild(p,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(p)&&(f=s.getImmediateChild(p)),(h=null!=f?this.filter_.updateChild(s,p,f,e.popFront(),a,r):t.getEventCache().getNode().hasChild(p)?this.filter_.updateChild(s,p,Wt.EMPTY_NODE,e.popFront(),a,r):s).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(h=this.filter_.updateFullNode(h,o,r))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(V.Empty),t.updateEventSnap(h,o,this.filter_.filtersNodes())},t}(),be=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var i=this,r=[],o=[];return t.forEach((function(t){t.type===fe.CHILD_CHANGED&&i.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(fe.childMovedChange(t.childName,t.snapshotNode))})),this.generateEventsForType_(r,fe.CHILD_REMOVED,t,n,e),this.generateEventsForType_(r,fe.CHILD_ADDED,t,n,e),this.generateEventsForType_(r,fe.CHILD_MOVED,o,n,e),this.generateEventsForType_(r,fe.CHILD_CHANGED,t,n,e),this.generateEventsForType_(r,fe.VALUE,t,n,e),r},t.prototype.generateEventsForType_=function(t,e,n,i,r){var o=this,a=n.filter((function(t){return t.type===e}));a.sort(this.compareChanges_.bind(this)),a.forEach((function(e){var n=o.materializeSingleChange_(e,r);i.forEach((function(i){i.respondsTo(e.type)&&t.push(i.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_)),t},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw u.assertionError("Should only compare child_ events.");var n=new yt(t.childName,t.snapshotNode),i=new yt(e.childName,e.snapshotNode);return this.index_.compare(n,i)},t}(),we=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),i=new de(n.getIndex()),r=n.getNodeFilter();this.processor_=new _e(r);var o=e.getServerCache(),a=e.getEventCache(),s=i.updateFullNode(Wt.EMPTY_NODE,o.getNode(),null),u=r.updateFullNode(Wt.EMPTY_NODE,a.getNode(),null),h=new le(s,o.isFullyInitialized(),i.filtersNodes()),c=new le(u,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=new pe(c,h),this.eventGenerator_=new be(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){u.assert(null==t,"A cancel should cancel all event registrations.");var i=this.query_.path;this.eventRegistrations_.forEach((function(t){e=e;var r=t.createCancelEvent(e,i);r&&n.push(r)}))}if(t){for(var r=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){r=r.concat(this.eventRegistrations_.slice(o+1));break}}else r.push(a)}this.eventRegistrations_=r}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===Bt.MERGE&&null!==t.source.queryId&&(u.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),u.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var i=this.viewCache_,r=this.processor_.applyOperation(i,t,e,n);return this.processor_.assertIndexed(r.viewCache),u.assert(r.viewCache.getServerCache().isFullyInitialized()||!i.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=r.viewCache,this.generateEventsForChanges_(r.changes,r.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];e.getNode().isLeafNode()||e.getNode().forEachChild(At,(function(t,e){n.push(fe.childAddedChange(t,e))}));return e.isFullyInitialized()&&n.push(fe.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var i=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,i)},t}(),Ee=function(){function t(){this.views_={}}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return u.assert(re,"Reference.ts has not been loaded"),re},set:function(t){u.assert(!re,"__referenceConstructor has already been defined"),re=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return u.isEmpty(this.views_)},t.prototype.applyOperation=function(t,e,n){var i=t.source.queryId;if(null!==i){var r=u.safeGet(this.views_,i);return u.assert(null!=r,"SyncTree gave us an op for an invalid query."),r.applyOperation(t,e,n)}var o=[];return u.forEach(this.views_,(function(i,r){o=o.concat(r.applyOperation(t,e,n))})),o},t.prototype.addEventRegistration=function(t,e,n,i,r){var o=t.queryIdentifier(),a=u.safeGet(this.views_,o);if(!a){var s=n.calcCompleteEventCache(r?i:null),h=!1;s?h=!0:i instanceof Wt?(s=n.calcCompleteEventChildren(i),h=!1):(s=Wt.EMPTY_NODE,h=!1);var c=new pe(new le(s,h,!1),new le(i,r,!1));a=new we(t,c),this.views_[o]=a}return a.addEventRegistration(e),a.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,i){var r=e.queryIdentifier(),o=[],a=[],s=this.hasCompleteView();if("default"===r){var h=this;u.forEach(this.views_,(function(t,e){a=a.concat(e.removeEventRegistration(n,i)),e.isEmpty()&&(delete h.views_[t],e.getQuery().getQueryParams().loadsAllData()||o.push(e.getQuery()))}))}else{var c=u.safeGet(this.views_,r);c&&(a=a.concat(c.removeEventRegistration(n,i)),c.isEmpty()&&(delete this.views_[r],c.getQuery().getQueryParams().loadsAllData()||o.push(c.getQuery())))}return s&&!this.hasCompleteView()&&o.push(new t.__referenceConstructor(e.repo,e.path)),{removed:o,events:a}},t.prototype.getQueryViews=function(){var t=this;return Object.keys(this.views_).map((function(e){return t.views_[e]})).filter((function(t){return!t.getQuery().getQueryParams().loadsAllData()}))},t.prototype.getCompleteServerCache=function(t){var e=null;return u.forEach(this.views_,(function(n,i){e=e||i.getCompleteServerCache(t)})),e},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return u.safeGet(this.views_,e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){return u.findValue(this.views_,(function(t){return t.getQuery().getQueryParams().loadsAllData()}))||null},t}(),Ce=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new se(n));var i=this.writeTree_.findRootMostValueAndPath(e);if(null!=i){var r=i.path,o=i.value,a=V.relativePath(r,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(r,o))}var s=new se(n);return new t(this.writeTree_.setTree(e,s))},t.prototype.addWrites=function(t,e){var n=this;return u.forEach(e,(function(e,i){n=n.addWrite(t.child(e),i)})),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,se.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(V.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(At,(function(e,n){t.push(new yt(e,n))})):this.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new yt(e,n.value))})),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new se(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(e){return t.applySubtreeWrite_(V.Empty,this.writeTree_,e)},t.Empty=new t(new se(null)),t.applySubtreeWrite_=function(e,n,i){if(null!=n.value)return i.updateChild(e,n.value);var r=null;return n.children.inorderTraversal((function(n,o){".priority"===n?(u.assert(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):i=t.applySubtreeWrite_(e.child(n),o,i)})),i.getChild(e).isEmpty()||null===r||(i=i.updateChild(e.child(".priority"),r)),i},t}(),Te=function(){function t(){this.visibleWrites_=Ce.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new Ie(t,this)},t.prototype.addOverwrite=function(t,e,n,i){u.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:i}),i&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){u.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));u.assert(n>=0,"removeWrite called with nonexistent writeId.");var i=this.allWrites_[n];this.allWrites_.splice(n,1);for(var r=i.visible,o=!1,a=this.allWrites_.length-1;r&&a>=0;){var s=this.allWrites_[a];s.visible&&(a>=n&&this.recordContainsPath_(s,i.path)?r=!1:i.path.contains(s.path)&&(o=!0)),a--}if(r){if(o)return this.resetTree_(),!0;if(i.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(i.path);else{var h=i.children;u.forEach(h,(function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(i.path.child(t))}))}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,i,r){if(i||r){var o=this.visibleWrites_.childCompoundWrite(e);if(!r&&o.isEmpty())return n;if(r||null!=n||o.hasCompleteWrite(V.Empty)){var a=t.layerTree_(this.allWrites_,(function(t){return(t.visible||r)&&(!i||!~i.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))}),e);h=n||Wt.EMPTY_NODE;return a.apply(h)}return null}var s=this.visibleWrites_.getCompleteNode(e);if(null!=s)return s;var u=this.visibleWrites_.childCompoundWrite(e);if(u.isEmpty())return n;if(null!=n||u.hasCompleteWrite(V.Empty)){var h=n||Wt.EMPTY_NODE;return u.apply(h)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=Wt.EMPTY_NODE,i=this.visibleWrites_.getCompleteNode(t);if(i)return i.isLeafNode()||i.forEachChild(At,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var r=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(At,(function(t,e){var i=r.childCompoundWrite(new V(t)).apply(e);n=n.updateImmediateChild(t,i)})),r.getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,i){u.assert(n||i,"Either existingEventSnap or existingServerSnap must exist");var r=t.child(e);if(this.visibleWrites_.hasCompleteWrite(r))return null;var o=this.visibleWrites_.childCompoundWrite(r);return o.isEmpty()?i.getChild(e):o.apply(i.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var i=t.child(e),r=this.visibleWrites_.getCompleteNode(i);return null!=r?r:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(i).apply(n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,i,r,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode(V.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var h=[],c=o.getCompare(),l=r?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),p=l.getNext();p&&h.length<i;)0!==c(p,n)&&h.push(p),p=l.getNext();return h},t.prototype.recordContainsPath_=function(t,e){return t.snap?t.path.contains(e):!!u.findKey(t.children,(function(n,i){return t.path.child(i).contains(e)}))},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,V.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var i=Ce.Empty,r=0;r<t.length;++r){var o=t[r];if(e(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=V.relativePath(n,a),i=i.addWrite(s,o.snap)):a.contains(n)&&(s=V.relativePath(a,n),i=i.addWrite(V.Empty,o.snap.getChild(s)));else{if(!o.children)throw u.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))s=V.relativePath(n,a),i=i.addWrites(s,o.children);else if(a.contains(n))if((s=V.relativePath(a,n)).isEmpty())i=i.addWrites(V.Empty,o.children);else{var h=u.safeGet(o.children,s.getFront());if(h){var c=h.getChild(s.popFront());i=i.addWrite(V.Empty,c)}}}}}return i},t}(),Ie=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,i,r){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,i,r)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Se=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=se.Empty,this.pendingWriteTree_=new Te,this.tagToQueryMap_={},this.queryToTagMap_={}}return t.prototype.applyUserOverwrite=function(t,e,n,i){return this.pendingWriteTree_.addOverwrite(t,e,n,i),i?this.applyOperationToSyncPoints_(new he(oe.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var i=se.fromObject(e);return this.applyOperationToSyncPoints_(new ce(oe.User,t,i))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var i=se.Empty;return null!=n.snap?i=i.set(V.Empty,!0):u.forEach(n.children,(function(t,e){i=i.set(new V(t),e)})),this.applyOperationToSyncPoints_(new ae(n.path,i,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new he(oe.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=se.fromObject(e);return this.applyOperationToSyncPoints_(new ce(oe.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new ue(oe.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,i){var r=this.queryKeyForTag_(i);if(null!=r){var o=t.parseQueryKey_(r),a=o.path,s=o.queryId,u=V.relativePath(a,e),h=new he(oe.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,h)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,i){var r=this.queryKeyForTag_(i);if(r){var o=t.parseQueryKey_(r),a=o.path,s=o.queryId,u=V.relativePath(a,e),h=se.fromObject(n),c=new ce(oe.forServerTaggedQuery(s),u,h);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var i=this.queryKeyForTag_(n);if(i){var r=t.parseQueryKey_(i),o=r.path,a=r.queryId,s=V.relativePath(o,e),u=new ue(oe.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var i=e.path,r=null,o=!1;this.syncPointTree_.foreachOnPath(i,(function(t,e){var n=V.relativePath(t,i);r=r||e.getCompleteServerCache(n),o=o||e.hasCompleteView()}));var a,s=this.syncPointTree_.get(i);(s?(o=o||s.hasCompleteView(),r=r||s.getCompleteServerCache(V.Empty)):(s=new Ee,this.syncPointTree_=this.syncPointTree_.set(i,s)),null!=r)?a=!0:(a=!1,r=Wt.EMPTY_NODE,this.syncPointTree_.subtree(i).foreachChild((function(t,e){var n=e.getCompleteServerCache(V.Empty);n&&(r=r.updateImmediateChild(t,n))})));var h=s.viewExistsForQuery(e);if(!h&&!e.getQueryParams().loadsAllData()){var c=t.makeQueryKey_(e);u.assert(!(c in this.queryToTagMap_),"View does not exist, but we have a tag");var l=t.getNextQueryTag_();this.queryToTagMap_[c]=l,this.tagToQueryMap_["_"+l]=c}var p=this.pendingWriteTree_.childWrites(i),f=s.addEventRegistration(e,n,p,r,a);if(!h&&!o){var d=s.viewForQuery(e);f=f.concat(this.setupListener_(e,d))}return f},t.prototype.removeEventRegistration=function(e,n,i){var r=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,i);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var h=u.removed;s=u.events;var c=-1!==h.findIndex((function(t){return t.getQueryParams().loadsAllData()})),l=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(c&&!l){var p=this.syncPointTree_.subtree(o);if(!p.isEmpty())for(var f=this.collectDistinctViewsForSubTree_(p),d=0;d<f.length;++d){var v=f[d],y=v.getQuery(),g=this.createListenerForView_(v);this.listenProvider_.startListening(t.queryForListening_(y),this.tagForQuery_(y),g.hashFn,g.onComplete)}}if(!l&&h.length>0&&!i)if(c){this.listenProvider_.stopListening(t.queryForListening_(e),null)}else h.forEach((function(e){var n=r.queryToTagMap_[t.makeQueryKey_(e)];r.listenProvider_.stopListening(t.queryForListening_(e),n)}));this.removeTags_(h)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,i=this.syncPointTree_.findOnPath(t,(function(e,n){var i=V.relativePath(e,t),r=n.getCompleteServerCache(i);if(r)return r}));return n.calcCompleteEventCache(t,i,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var i=[];return e&&(i=e.getQueryViews()),u.forEach(n,(function(t,e){i=i.concat(e)})),i}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var i=e[n];if(!i.getQueryParams().loadsAllData()){var r=t.makeQueryKey_(i),o=this.queryToTagMap_[r];delete this.queryToTagMap_[r],delete this.tagToQueryMap_["_"+o]}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var i=e.path,r=this.tagForQuery_(e),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),r,o.hashFn,o.onComplete),s=this.syncPointTree_.subtree(i);if(r)u.assert(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var h=s.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var i=[];return e&&(i=i.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),u.forEach(n,(function(t,e){i=i.concat(e)})),i})),c=0;c<h.length;++c){var l=h[c];this.listenProvider_.stopListening(t.queryForListening_(l),this.tagForQuery_(l))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),i=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||Wt.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return i?e.applyTaggedListenComplete(n.path,i):e.applyListenComplete(n.path);var r=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var i=new Error(t+" at "+e.path.toString()+": "+n);return i.code=t.toUpperCase(),i}(t,n);return e.removeEventRegistration(n,null,r)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return u.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new V(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap_["_"+t]},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return u.safeGet(this.queryToTagMap_,n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);u.assert(n,"Missing sync point for query tag that we're tracking");var i=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,i,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(V.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,i){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,i);var r=e.get(V.Empty);null==n&&null!=r&&(n=r.getCompleteServerCache(V.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var h=n?n.getImmediateChild(a):null,c=i.child(a);o=o.concat(this.applyOperationHelper_(s,u,h,c))}return r&&(o=o.concat(r.applyOperation(t,i,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,i){var r=this,o=e.get(V.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(V.Empty));var a=[];return e.children.inorderTraversal((function(e,o){var s=n?n.getImmediateChild(e):null,u=i.child(e),h=t.operationForChild(e);h&&(a=a.concat(r.applyOperationDescendantsHelper_(h,o,s,u)))})),o&&(a=a.concat(o.applyOperation(t,i,n))),a},t.nextQueryTag_=1,t}(),Ne=function(){function t(){this.rootNode_=Wt.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Ae=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_.INTERNAL.getToken(t).then(null,(function(t){return t&&"auth/token-not-initialized"===t.code?(E("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)}))},t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.app_.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',S(t)},t}(),ke=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),u.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return u.deepCopy(this.counters_)},t}(),Pe=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new ke),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),Re=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=u.clone(t);return this.last_&&u.forEach(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Oe=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Re(t);var n=1e4+2e4*Math.random();W(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},i=!1;u.forEach(e,(function(e,r){r>0&&u.contains(t.statsToReport_,e)&&(n[e]=r,i=!0)})),i&&this.server_.reportStats(n),W(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),De=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var i=t[n],r=i.getPath();null===e||r.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new xe(r)),e.add(i)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var i=this.eventLists_[n];if(i)t(i.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),xe=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();_&&E("event: "+e.toString()),j(n)}}},t.prototype.getPath=function(){return this.path_},t}(),Le=function(){function t(t){this.allowedEvents_=t,this.listeners_={},u.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var i=this.listeners_[t].slice(),r=0;r<i.length;r++)i[r].callback.apply(i[r].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var i=this.getInitialEvent(t);i&&e.apply(n,i)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var i=this.listeners_[t]||[],r=0;r<i.length;r++)if(i[r].callback===e&&(!n||n===i[r].context))return void i.splice(r,1)},t.prototype.validateEventType_=function(t){u.assert(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),Fe=function(t){function e(){var e,n,i=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),i.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==i.visible_&&(i.visible_=t,i.trigger("visible",t))}),!1),i}return s.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return u.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(Le),Me=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||u.isMobileCordova()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return s.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return u.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(Le),Ue=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var i=function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=function(e){t[e]&&j((function(){n.onMessage_(t[e])}))},i=0;i<t.length;++i)e(i);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++},r=this;this.pendingResponses[this.currentResponseNum];){if("break"===i())break}},t}(),je=function(){function t(t,e,n,i){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=C(t),this.stats_=Pe.getCollection(e),this.urlFn=function(t){return e.connectionURL("long_polling",t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new Ue(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if(u.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new We((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],r=t[1],o=t[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"==i)n.id=r,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);r?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(r,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],r=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,r)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),!u.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI)&&!u.isNodeSdk()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=u.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=u.base64Encode(e),i=x(n,1840),r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!u.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=u.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),We=function(){function t(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Zt,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,u.isNodeSdk())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=y(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))o='<script>document.domain="'+document.domain+'";<\/script>';var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(t){E("frame writing exception"),t.stack&&E(t.stack),E(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||E("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var e=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0))),u.isNodeSdk()&&this.myID){var n={disconn:"t"};n.id=this.myID,n.pw=this.myPW;var i=this.urlFn(n);t.nodeRestRequest(i)}var r=this.onDisconnect;r&&(this.onDisconnect=null,r())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",i=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var r=this.pendingSegs.shift();n=n+"&seg"+i+"="+r.seg+"&ts"+i+"="+r.ts+"&d"+i+"="+r.d,i++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var i=function(){n.outstandingRequests.remove(e),n.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(r),i()}))},t.prototype.addTag=function(t,e){var n=this;u.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){var t=i.readyState;t&&"loaded"!==t&&"complete"!==t||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=function(){E("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(i)}catch(t){}}),Math.floor(1))},t}(),Ve=null;"undefined"!=typeof MozWebSocket?Ve=MozWebSocket:"undefined"!=typeof WebSocket&&(Ve=WebSocket);var qe=function(){function t(e,n,i,r){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=C(this.connId),this.stats_=Pe.getCollection(n),this.connURL=t.connectionURL_(n,i,r)}return t.connectionURL_=function(t,e,n){var i={v:"5"};return!u.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),t.connectionURL("websocket",i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if(u.isNodeSdk()){var r=u.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/5/"+a.SDK_VERSION+"/"+i.platform+"/"+r}},s=Object({IS_PROD:!0,NODE_ENV:"production"}),h=0==this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;h&&(o.proxy={origin:h}),this.mySock=new Ve(this.connURL,[],o)}else this.mySock=new Ve(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var c=t.message||t.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Ve&&!t.forceDisallow_},t.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=u.jsonEval(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(u.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=u.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=x(e,16384);n.length>1&&this.sendString_(String(n.length));for(var i=0;i<n.length;i++)this.sendString_(n[i])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),He=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[je,qe]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n=qe&&qe.isAvailable(),i=n&&!qe.previouslyFailed();if(e.webSocketOnly&&(n||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[qe];else{var r=this.transports_=[];L(t.ALL_TRANSPORTS,(function(t,e){e&&e.isAvailable()&&r.push(e)}))}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),Be=function(){function t(t,e,n,i,r,o,a){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=i,this.onDisconnect_=r,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=C("c:"+this.id+":"),this.transportManager_=new He(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,i)}),Math.floor(0));var r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=W((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(r)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=O("t",t),n=O("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=O("t",t),n=O("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=O("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?T("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):T("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(i),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),W((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):W((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),Qe=function(){function t(){}return t.prototype.put=function(t,e,n,i){},t.prototype.merge=function(t,e,n,i){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),Ke=function(t){function e(n,i,r,o,a,s){var h=t.call(this)||this;if(h.repoInfo_=n,h.onDataUpdate_=i,h.onConnectStatus_=r,h.onServerInfoUpdate_=o,h.authTokenProvider_=a,h.authOverride_=s,h.id=e.nextPersistentConnectionId_++,h.log_=C("p:"+h.id+":"),h.interruptReasons_={},h.listens_={},h.outstandingPuts_=[],h.outstandingPutCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=1e3,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,s&&!u.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return h.scheduleConnect_(0),Fe.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&Me.getInstance().on("online",h.onOnline_,h),h}return s.__extends(e,t),e.prototype.sendRequest=function(t,e,n){var i=++this.requestNumber_,r={r:i,a:t,b:e};this.log_(u.stringify(r)),u.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)},e.prototype.listen=function(t,e,n,i){var r=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+r),this.listens_[o]=this.listens_[o]||{},u.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),u.assert(!this.listens_[o][r],"listen() called twice for same path/queryId.");var a={onComplete:i,hashFn:e,query:t,tag:n};this.listens_[o][r]=a,this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,i=t.query,r=i.path.toString(),o=i.queryIdentifier();this.log_("Listen on "+r+" for "+o);var a={p:r};t.tag&&(a.q=i.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,i),(n.listens_[r]&&n.listens_[r][o])===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(r,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&u.contains(t,"w")){var n=u.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var i='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',r=e.path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+i+" at "+r+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||u.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=u.isValidFormat(e)?"auth":"gauth",i={cred:e};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(n,i,(function(n){var i=n.s,r=n.d||"error";t.authToken_===e&&("ok"===i?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(i,r))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),i=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+i),u.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,i){this.log_("Unlisten on "+t+" for "+e);var r={p:t};i&&(r.q=n,r.t=i),this.sendRequest("n",r)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,i){var r={p:e,d:n};this.log_("onDisconnect "+t,r),this.sendRequest(t,r,(function(t){i&&setTimeout((function(){i(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,i){this.putInternal("p",t,e,n,i)},e.prototype.merge=function(t,e,n,i){this.putInternal("m",t,e,n,i)},e.prototype.putInternal=function(t,e,n,i,r){var o={p:e,d:n};void 0!==r&&(o.h=r),this.outstandingPuts_.push({action:t,request:o,onComplete:i}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,i,(function(i){e.log_(n+" response",i),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),r&&r(i.s,i.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+u.stringify(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):T("Unrecognized action received from server: "+u.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;u.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,s=!1,h=null,c=function(){h?h.close():(s=!0,i())};this.realtime_={close:c,sendRequest:function(t){u.assert(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(t)}};var l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(l).then((function(e){s?E("getToken() completed but was canceled"):(E("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,h=new Be(r,o.repoInfo_,t,n,i,(function(t){S(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")}),a))})).then(null,(function(t){o.log_("Failed to get token: "+t),s||(u.CONSTANTS.NODE_ADMIN&&S(t),c())}))}},e.prototype.interrupt=function(t){E("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){E("Resuming connection for reason: "+t),delete this.interruptReasons_[t],u.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return D(t)})).join("$"):"default";var i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,i=new V(t).toString();return void 0!==this.listens_[i]?(n=this.listens_[i][e],delete this.listens_[i][e],0===u.getCount(this.listens_[i])&&delete this.listens_[i]):n=void 0,n},e.prototype.onAuthRevoked_=function(t,e){E("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t=this;this.tryAuth(),u.forEach(this.listens_,(function(e,n){u.forEach(n,(function(e,n){t.sendListen_(n)}))}));for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";u.CONSTANTS.NODE_ADMIN?e="admin_node":u.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+a.SDK_VERSION.replace(/\./g,"-")]=1,u.isMobileCordova()?t["framework.cordova"]=1:u.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=Me.getInstance().currentlyOnline();return u.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(Qe),Ge=function(t){function e(e,n,i){var r=t.call(this)||this;return r.repoInfo_=e,r.onDataUpdate_=n,r.authTokenProvider_=i,r.log_=C("p:rest:"),r.listens_={},r}return s.__extends(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(u.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,i,r){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var s=e.getListenId_(t,i),h={};this.listens_[s]=h;var c=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",c,(function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,i),u.safeGet(o.listens_,s)===h)&&r(t?401==t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var i=e.getListenId_(t,n);delete this.listens_[i]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var i=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(r){var o=r&&r.accessToken;o&&(e.auth=o);var a=(i.repoInfo_.secure?"https://":"http://")+i.repoInfo_.host+t+"?ns="+i.repoInfo_.namespace+u.querystring(e);i.log_("Sending REST request for "+a);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(n&&4===s.readyState){i.log_("REST Response for "+a+" received. status:",s.status,"response:",s.responseText);var t=null;if(s.status>=200&&s.status<300){try{t=u.jsonEval(s.responseText)}catch(t){S("Failed to parse JSON response for "+a+": "+s.responseText)}n(null,t)}else 401!==s.status&&404!==s.status&&S("Got unsuccessful REST response for "+a+" Status: "+s.status),n(s.status);n=null}},s.open("GET",a,!0),s.send()}))},e}(Qe),Ye=function(){function t(t,e,n){var i=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new De,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new te,this.persistentConnection_=null;var r=new Ae(n);if(this.stats_=Pe.getCollection(t),e||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new Ge(this.repoInfo_,this.onDataUpdate_.bind(this),r),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(null!=o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{u.stringify(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new Ke(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),r,o),this.server_=this.persistentConnection_}r.addTokenChangeListener((function(t){i.server_.refreshAuthToken(t)})),this.statsReporter_=Pe.getOrCreateReporter(t,(function(){return new Oe(i.stats_,i.server_)})),this.transactions_init_(),this.infoData_=new Ne,this.infoSyncTree_=new Se({startListening:function(t,e,n,r){var o=[],a=i.infoData_.getNode(t.path);return a.isEmpty()||(o=i.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout((function(){r("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Se({startListening:function(t,e,n,r){return i.server_.listen(t,n,e,(function(e,n){var o=r(e,n);i.eventQueue_.raiseEventsForChangedPath(t.path,o)})),[]},stopListening:function(t,e){i.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new V(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,i){this.dataUpdateCount++;var r=new V(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(i)if(n){var a=u.map(e,(function(t){return qt(t)}));o=this.serverSyncTree_.applyTaggedQueryMerge(r,a,i)}else{var s=qt(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(r,s,i)}else if(n){var h=u.map(e,(function(t){return qt(t)}));o=this.serverSyncTree_.applyServerMerge(r,h)}else{var c=qt(e);o=this.serverSyncTree_.applyServerOverwrite(r,c)}var l=r;o.length>0&&(l=this.rerunTransactions_(r)),this.eventQueue_.raiseEventsForChangedPath(l,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;L(t,(function(t,n){e.updateInfo_(n,t)}))},t.prototype.updateInfo_=function(t,e){var n=new V("/.info/"+t),i=qt(e);this.infoData_.updateSnapshot(n,i);var r=this.infoSyncTree_.applyServerOverwrite(n,i);this.eventQueue_.raiseEventsForChangedPath(n,r)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,i){var r=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=qt(e,n),s=ne(a,o),u=this.getNextWriteId_(),h=this.serverSyncTree_.applyUserOverwrite(t,s,u,!0);this.eventQueue_.queueEvents(h),this.server_.put(t.toString(),a.val(!0),(function(e,n){var o="ok"===e;o||S("set at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(u,!o);r.eventQueue_.raiseEventsForChangedPath(t,a),r.callOnCompleteCallback(i,e,n)}));var c=this.abortTransactions_(t);this.rerunTransactions_(c),this.eventQueue_.raiseEventsForChangedPath(c,[])},t.prototype.update=function(t,e,n){var i=this;this.log_("update",{path:t.toString(),value:e});var r=!0,o=this.generateServerValues(),a={};if(u.forEach(e,(function(t,e){r=!1;var n=qt(e);a[t]=ne(n,o)})),r)E("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),h=this.serverSyncTree_.applyUserMerge(t,a,s);this.eventQueue_.queueEvents(h),this.server_.merge(t.toString(),e,(function(e,r){var o="ok"===e;o||S("update at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?i.rerunTransactions_(t):t;i.eventQueue_.raiseEventsForChangedPath(u,a),i.callOnCompleteCallback(n,e,r)})),u.forEach(e,(function(e){var n=i.abortTransactions_(t.child(e));i.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=function(t,e){var n=new te;return t.forEachTree(new V(""),(function(t,i){n.remember(t,ne(i,e))})),n}(this.onDisconnect_,e),i=[];n.forEachTree(V.Empty,(function(e,n){i=i.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var r=t.abortTransactions_(e);t.rerunTransactions_(r)})),this.onDisconnect_=new te,this.eventQueue_.raiseEventsForChangedPath(V.Empty,i)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(i,r){"ok"===i&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,i,r)}))},t.prototype.onDisconnectSet=function(t,e,n){var i=this,r=qt(e);this.server_.onDisconnectPut(t.toString(),r.val(!0),(function(e,o){"ok"===e&&i.onDisconnect_.remember(t,r),i.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,i){var r=this,o=qt(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&r.onDisconnect_.remember(t,o),r.callOnCompleteCallback(i,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var i=this;if(u.isEmpty(e))return E("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(r,o){"ok"===r&&u.forEach(e,(function(e,n){var r=qt(n);i.onDisconnect_.remember(t.child(e),r)})),i.callOnCompleteCallback(n,r,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new Re(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);u.forEach(e,(function(t,e){for(var i=t.length;i<n+2;i++)t+=" ";console.log(t+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),E.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&j((function(){if("ok"==e)t(null);else{var i=(e||"error").toUpperCase(),r=i;n&&(r+=": "+n);var o=new Error(r);o.code=i,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new on(this))},enumerable:!0,configurable:!0}),t}(),ze=function(){function t(e){this.indexedFilter_=new de(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,i,r,o){return this.matches(new yt(e,n))||(n=Wt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,i,r,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Wt.EMPTY_NODE);var i=e.withIndex(this.index_);i=i.updatePriority(Wt.EMPTY_NODE);var r=this;return e.forEachChild(At,(function(t,e){r.matches(new yt(t,e))||(i=i.updateImmediateChild(t,Wt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,i,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),Xe=function(){function t(t){this.rangedFilter_=new ze(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,i,r,o){return this.rangedFilter_.matches(new yt(e,n))||(n=Wt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,i,r,o):this.fullLimitUpdateChild_(t,e,n,r,o)},t.prototype.updateFullNode=function(t,e,n){var i;if(e.isLeafNode()||e.isEmpty())i=Wt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){i=Wt.EMPTY_NODE.withIndex(this.index_);var r=void 0;r=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;r.hasNext()&&o<this.limit_;){var a=r.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;i=i.updateImmediateChild(a.name,a.node),o++}}else{i=(i=e.withIndex(this.index_)).updatePriority(Wt.EMPTY_NODE);var s=void 0,u=void 0,h=void 0;r=void 0;if(this.reverse_){r=i.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var c=this.index_.getCompare();h=function(t,e){return c(e,t)}}else r=i.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),h=this.index_.getCompare();o=0;for(var l=!1;r.hasNext();){a=r.getNext();!l&&h(s,a)<=0&&(l=!0),l&&o<this.limit_&&h(a,u)<=0?o++:i=i.updateImmediateChild(a.name,Wt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,i,r){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var s=t;u.assert(s.numChildren()==this.limit_,"");var h=new yt(e,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(h);if(s.hasChild(e)){for(var p=s.getImmediateChild(e),f=i.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name==e||s.hasChild(f.name));)f=i.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:o(f,h);if(l&&!n.isEmpty()&&d>=0)return null!=r&&r.trackChildChange(fe.childChangedChange(e,n,p)),s.updateImmediateChild(e,n);null!=r&&r.trackChildChange(fe.childRemovedChange(e,p));var v=s.updateImmediateChild(e,Wt.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=r&&r.trackChildChange(fe.childAddedChange(f.name,f.node)),v.updateImmediateChild(f.name,f.node)):v}return n.isEmpty()?t:l&&o(c,h)>=0?(null!=r&&(r.trackChildChange(fe.childRemovedChange(c.name,c.node)),r.trackChildChange(fe.childAddedChange(e,n))),s.updateImmediateChild(e,n).updateImmediateChild(c.name,Wt.EMPTY_NODE)):t},t}(),Je=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=At}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return u.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return u.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return u.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return u.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:k},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return u.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var i=this.viewFrom_;""===i&&(i=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=i}return this.index_!==At&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==At},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new de(this.getIndex()):this.hasLimit()?new Xe(this):new ze(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,i={};return this.isDefault()||(this.index_===At?e=n.PRIORITY_INDEX:this.index_===Qt?e=n.VALUE_INDEX:this.index_===_t?e=n.KEY_INDEX:(u.assert(this.index_ instanceof Kt,"Unrecognized index type!"),e=this.index_.toString()),i[n.ORDER_BY]=u.stringify(e),this.startSet_&&(i[n.START_AT]=u.stringify(this.indexStartValue_),this.startNameSet_&&(i[n.START_AT]+=","+u.stringify(this.indexStartName_))),this.endSet_&&(i[n.END_AT]=u.stringify(this.indexEndValue_),this.endNameSet_&&(i[n.END_AT]+=","+u.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?i[n.LIMIT_TO_FIRST]=this.limit_:i[n.LIMIT_TO_LAST]=this.limit_)),i},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),$e=function(t){function e(e,n){if(!(e instanceof Ye))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,Je.DEFAULT,!1)||this}return s.__extends(e,t),e.prototype.getKey=function(){return u.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return u.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof V||(null===this.path.getFront()?ht("Reference.child",1,t,!1):ut("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){u.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){u.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){u.validateArgCount("Reference.set",1,2,arguments.length),ct("Reference.set",this.path),nt("Reference.set",1,t,this.path,!1),u.validateCallback("Reference.set",2,e,!0);var n=new u.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(u.validateArgCount("Reference.update",1,2,arguments.length),ct("Reference.update",this.path),Array.isArray(t)){for(var n={},i=0;i<t.length;++i)n[""+i]=t[i];t=n,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}rt("Reference.update",1,t,this.path,!1),u.validateCallback("Reference.update",2,e,!0);var r=new u.Deferred;return this.repo.update(this.path,t,r.wrapCallback(e)),r.promise},e.prototype.setWithPriority=function(t,e,n){if(u.validateArgCount("Reference.setWithPriority",2,3,arguments.length),ct("Reference.setWithPriority",this.path),nt("Reference.setWithPriority",1,t,this.path,!1),ot("Reference.setWithPriority",2,e,!1),u.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var i=new u.Deferred;return this.repo.setWithPriority(this.path,t,e,i.wrapCallback(n)),i.promise},e.prototype.remove=function(t){return u.validateArgCount("Reference.remove",0,1,arguments.length),ct("Reference.remove",this.path),u.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(u.validateArgCount("Reference.transaction",1,3,arguments.length),ct("Reference.transaction",this.path),u.validateCallback("Reference.transaction",1,t,!1),u.validateCallback("Reference.transaction",2,e,!0),pt("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var i=new u.Deferred;"function"==typeof e&&i.promise.catch((function(){}));var r=function(t,n,r){t?i.reject(t):i.resolve(new dt(n,r)),"function"==typeof e&&e(t,n,r)};return this.repo.startTransaction(this.path,t,r,n),i.promise},e.prototype.setPriority=function(t,e){u.validateArgCount("Reference.setPriority",1,2,arguments.length),ct("Reference.setPriority",this.path),ot("Reference.setPriority",1,t,!1),u.validateCallback("Reference.setPriority",2,e,!0);var n=new u.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){u.validateArgCount("Reference.push",0,2,arguments.length),ct("Reference.push",this.path),nt("Reference.push",1,t,this.path,!0),u.validateCallback("Reference.push",2,e,!0);var n,i=this.repo.serverTime(),r=vt(i),o=this.child(r),a=this.child(r);return n=null!=t?o.set(t,e).then((function(){return a})):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch((function(){})),o},e.prototype.onDisconnect=function(){return ct("Reference.onDisconnect",this.path),new ft(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}($t);$t.__referenceConstructor=$e,Ee.__referenceConstructor=$e;var Ze,tn=function(){this.children={},this.childCount=0,this.value=null},en=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new tn),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,i=e instanceof V?e:new V(e),r=this;null!==(n=i.getFront());){r=new t(n,r,u.safeGet(r.node_.children,n)||new tn),i=i.popFront()}return r},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){u.assert(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;u.forEach(this.node_.children,(function(i,r){e(new t(i,n,r))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new V(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),i=u.contains(this.node_.children,t);n&&i?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||i||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(Ze||(Ze={})),Ye.MAX_TRANSACTION_RETRIES_=25,Ye.prototype.transactions_init_=function(){this.transactionQueueTree_=new en},Ye.prototype.startTransaction=function(t,e,n,i){this.log_("transaction on "+t);var r=function(){},o=new $e(this,t);o.on("value",r);var a={path:t,update:e,onComplete:n,status:null,order:y(),applyLocally:i,retryCount:0,unwatcher:function(){o.off("value",r)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(t);a.currentInputSnapshot=s;var h=a.update(s.val());if(void 0===h){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var c=new Gt(a.currentInputSnapshot,new $e(this,a.path),At);a.onComplete(null,!1,c)}}else{it("transaction failed: Data returned ",h,a.path),a.status=Ze.RUN;var l=this.transactionQueueTree_.subTree(t),p=l.getValue()||[];p.push(a),l.setValue(p);var f=void 0;if("object"==typeof h&&null!==h&&u.contains(h,".priority"))f=u.safeGet(h,".priority"),u.assert(et(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else f=(this.serverSyncTree_.calcCompleteEventCache(t)||Wt.EMPTY_NODE).getPriority().val();f=f;var d=this.generateServerValues(),v=qt(h,f),g=ne(v,d);a.currentOutputSnapshotRaw=v,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(t,g,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,m),this.sendReadyTransactions_()}},Ye.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Wt.EMPTY_NODE},Ye.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);u.assert(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return t.status===Ze.RUN}))&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},Ye.prototype.sendTransactionQueue_=function(t,e){for(var n=this,i=e.map((function(t){return t.currentWriteId})),r=this.getLatestState_(t,i),o=r,a=r.hash(),s=0;s<e.length;s++){var h=e[s];u.assert(h.status===Ze.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=Ze.SENT,h.retryCount++;var c=V.relativePath(t,h.path);o=o.updateChild(c,h.currentOutputSnapshotRaw)}var l=o.val(!0),p=t;this.server_.put(p.toString(),l,(function(i){n.log_("transaction put response",{path:p.toString(),status:i});var r=[];if("ok"===i){for(var o=[],a=0;a<e.length;a++){if(e[a].status=Ze.COMPLETED,r=r.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new $e(n,e[a].path),h=new Gt(s,u,At);o.push(e[a].onComplete.bind(null,null,!0,h))}e[a].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,r);for(a=0;a<o.length;a++)j(o[a])}else{if("datastale"===i)for(a=0;a<e.length;a++)e[a].status===Ze.SENT_NEEDS_ABORT?e[a].status=Ze.NEEDS_ABORT:e[a].status=Ze.RUN;else{S("transaction at "+p.toString()+" failed: "+i);for(a=0;a<e.length;a++)e[a].status=Ze.NEEDS_ABORT,e[a].abortReason=i}n.rerunTransactions_(t)}}),a)},Ye.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),i=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(i,n),n},Ye.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,i=[],r=[],o=t.filter((function(t){return t.status===Ze.RUN})).map((function(t){return t.currentWriteId})),a=0;a<t.length;a++){var s=t[a],h=V.relativePath(e,s.path),c=!1,l=void 0;if(u.assert(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===Ze.NEEDS_ABORT)c=!0,l=s.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===Ze.RUN)if(s.retryCount>=Ye.MAX_TRANSACTION_RETRIES_)c=!0,l="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var p=this.getLatestState_(s.path,o);s.currentInputSnapshot=p;var f=t[a].update(p.val());if(void 0!==f){it("transaction failed: Data returned ",f,s.path);var d=qt(f);"object"==typeof f&&null!=f&&u.contains(f,".priority")||(d=d.updatePriority(p.getPriority()));var v=s.currentWriteId,y=this.generateServerValues(),g=ne(d,y);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=g,s.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(v),1),r=(r=r.concat(this.serverSyncTree_.applyUserOverwrite(s.path,g,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(v,!0))}else c=!0,l="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,r),r=[],c&&(t[a].status=Ze.COMPLETED,n=t[a].unwatcher,setTimeout(n,Math.floor(0)),t[a].onComplete))if("nodata"===l){var m=new $e(this,t[a].path),_=t[a].currentInputSnapshot,b=new Gt(_,m,At);i.push(t[a].onComplete.bind(null,null,!1,b))}else i.push(t[a].onComplete.bind(null,new Error(l),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(a=0;a<i.length;a++)j(i[a]);this.sendReadyTransactions_()}},Ye.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},Ye.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},Ye.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,i=t.getValue();if(null!==i)for(var r=0;r<i.length;r++)e.push(i[r]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},Ye.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var i=0,r=0;r<n.length;r++)n[r].status!==Ze.COMPLETED&&(n[i]=n[r],i++);n.length=i,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},Ye.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),i=this.transactionQueueTree_.subTree(t);return i.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(i),i.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},Ye.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],i=[],r=-1,o=0;o<e.length;o++)if(e[o].status===Ze.SENT_NEEDS_ABORT);else if(e[o].status===Ze.SENT)u.assert(r===o-1,"All SENT items should be at beginning of queue."),r=o,e[o].status=Ze.SENT_NEEDS_ABORT,e[o].abortReason="set";else if(u.assert(e[o].status===Ze.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),i=i.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete){n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))}-1===r?t.setValue(null):e.length=r+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),i);for(o=0;o<n.length;o++)j(n[o])}};var nn,rn=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return nn||(nn=new t),nn},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options.databaseURL;void 0===n&&I("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var i=z(n),r=i.repoInfo;return lt("Invalid Firebase Database URL",1,i),i.path.isEmpty()||I("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(r,t).database},t.prototype.deleteRepo=function(t){var e=u.safeGet(this.repos_,t.app.name);e&&u.safeGet(e,t.repoInfo_.toURLString())===t||I("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=u.safeGet(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var i=u.safeGet(n,t.toURLString());return i&&I("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Ye(t,this.useRestClient_,e),n[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),on=function(){function t(t){this.repo_=t,t instanceof Ye||I("Don't call new Database() directly - please use firebase.database()."),this.root_=new $e(t,V.Empty),this.INTERNAL=new an(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),u.validateArgCount("database.ref",0,1,arguments.length),t instanceof $e?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),u.validateArgCount(e,1,1,arguments.length);var n=z(t);lt(e,1,n);var i=n.repoInfo;return i.host!==this.repo_.repoInfo_.host&&I(e+": Host name does not match the current database: (found "+i.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&I("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){u.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){u.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}(),an=function(){function t(t){this.database=t}return t.prototype.delete=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){return this.database.checkDeleted_("delete"),rn.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]}))}))},t}(),sn=Object.freeze({forceLongPolling:function(){qe.forceDisallow(),je.forceAllow()},forceWebSockets:function(){je.forceDisallow()},isWebSocketsAvailable:function(){return qe.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)}}),un=Ke;Ke.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Ke.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var hn=Be,cn=H,ln=Object.freeze({DataConnection:un,RealTimeConnection:hn,hijackHash:function(t){var e=Ke.prototype.put;return Ke.prototype.put=function(n,i,r,o){void 0!==o&&(o=t()),e.call(this,n,i,r,o)},function(){Ke.prototype.put=e}},ConnectionTarget:cn,queryIdentifier:function(t){return t.queryIdentifier()},listens:function(t){return t.repo.persistentConnection_.listens_},forceRestClient:function(t){rn.getInstance().forceRestClient(t)}}),pn=on.ServerValue;function fn(e){var n=e.INTERNAL.registerService("database",(function(t,e,n){return rn.getInstance().databaseFromApp(t,n)}),{Reference:$e,Query:$t,Database:on,DataSnapshot:Gt,enableLogging:w,INTERNAL:sn,ServerValue:pn,TEST_ACCESS:ln},null,!0);u.isNodeSdk()&&(t.exports=n)}fn(a),e.DataSnapshot=Gt,e.Database=on,e.OnDisconnect=ft,e.Query=$t,e.Reference=$e,e.ServerValue=pn,e.enableLogging=w,e.registerDatabase=fn}).call(this,n(371))},1938:function(t,e,n){"use strict";n.r(e),n.d(e,"LogLevel",(function(){return i})),n.d(e,"Logger",(function(){return s})),n.d(e,"setLogLevel",(function(){return u}));var i,r=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));var o=i.INFO,a=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case i.DEBUG:case i.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},s=function(){function t(t){this.name=t,this._logLevel=o,this._logHandler=a,r.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.ERROR].concat(t))},t}();function u(t){r.forEach((function(e){e.logLevel=t}))}},1959:function(t,e,n){"use strict";n(1916);var i,r=(i=n(1899))&&"object"==typeof i&&"default"in i?i.default:i;t.exports=r},1960:function(t,e,n){"use strict";n.r(e);n(1936)},1961:function(t,e,n){"use strict";n.r(e);n(1937)}}]);